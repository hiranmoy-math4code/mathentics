{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///E:/PROJECT%202025%20-%20October/math4code-website/app/%28public%29/auth/login/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useState, Suspense } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { useRouter, useSearchParams } from \"next/navigation\";\r\nimport { motion } from \"framer-motion\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\nimport { Loader2, Mail, Lock, ArrowRight, AlertCircle } from \"lucide-react\";\r\nimport { FaGoogle, FaGithub } from \"react-icons/fa\";\r\n\r\nfunction LoginForm() {\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const router = useRouter();\r\n  const searchParams = useSearchParams();\r\n  const next = searchParams.get(\"next\");\r\n\r\n  const handleLogin = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    const supabase = createClient();\r\n    setIsLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const { error } = await supabase.auth.signInWithPassword({\r\n        email,\r\n        password,\r\n      });\r\n\r\n      if (error) throw error;\r\n\r\n      // Check if user has a profile\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (user) {\r\n        // If \"next\" param exists (e.g. from Enroll button), redirect there\r\n        if (next) {\r\n          router.push(next);\r\n          router.refresh();\r\n          return;\r\n        }\r\n\r\n        const { data: profile } = await supabase\r\n          .from('profiles')\r\n          .select('id, role')\r\n          .eq('id', user.id)\r\n          .single();\r\n\r\n        if (!profile) {\r\n          setError(\"Account exists but profile is missing. Please contact support.\");\r\n          return;\r\n        }\r\n\r\n        // Role-based routing\r\n        if (profile.role === 'admin') {\r\n          router.push(\"/admin/dashboard\");\r\n        } else {\r\n          router.push(\"/student/dashboard\");\r\n        }\r\n        router.refresh();\r\n      }\r\n    } catch (error: unknown) {\r\n      setError(error instanceof Error ? error.message : \"Invalid login credentials\");\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleGoogleLogin = async () => {\r\n    const supabase = createClient();\r\n    setIsLoading(true);\r\n    try {\r\n      const redirectTo = new URL(`${window.location.origin}/auth/callback`);\r\n      if (next) {\r\n        redirectTo.searchParams.set(\"next\", next);\r\n      }\r\n\r\n      const { error } = await supabase.auth.signInWithOAuth({\r\n        provider: \"google\",\r\n        options: {\r\n          redirectTo: redirectTo.toString(),\r\n          queryParams: {\r\n            access_type: 'offline',\r\n            prompt: 'consent',\r\n          },\r\n        },\r\n      });\r\n      if (error) throw error;\r\n    } catch (error: unknown) {\r\n      setError(error instanceof Error ? error.message : \"An error occurred with Google Sign In\");\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0, y: 20 }}\r\n      animate={{ opacity: 1, y: 0 }}\r\n      transition={{ duration: 0.5 }}\r\n      className=\"w-full\"\r\n    >\r\n      <div className=\"mb-8 text-center\">\r\n        <Link href=\"/\" className=\"inline-block hover:opacity-80 transition-opacity\">\r\n          <div className=\"flex items-center justify-center gap-3\">\r\n            <div className=\"w-auto px-2 h-10 rounded-xl bg-linear-to-br from-indigo-500 to-violet-500 flex items-center justify-center text-white font-bold shadow-lg shadow-indigo-500/20\">\r\n              <span className=\"text-xl\">Σ✨{'}'}</span>\r\n            </div>\r\n            <h1 className=\"text-3xl font-bold bg-clip-text text-transparent bg-linear-to-r from-indigo-600 to-violet-600\">\r\n              math4code\r\n            </h1>\r\n          </div>\r\n        </Link>\r\n        <p className=\"mt-3 text-slate-600\">Welcome back! Please sign in to continue.</p>\r\n      </div>\r\n\r\n      <div className=\"bg-white/80 backdrop-blur-xl border border-slate-200/60 rounded-2xl p-8 shadow-[0_8px_30px_rgb(0,0,0,0.04)] relative overflow-hidden group\">\r\n        <div className=\"absolute inset-0 bg-linear-to-br from-indigo-50/50 to-violet-50/50 opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none\" />\r\n\r\n        <form onSubmit={handleLogin} className=\"space-y-5 relative z-10\">\r\n          {/* Email */}\r\n          <div className=\"space-y-2\">\r\n            <label className=\"text-sm font-medium text-slate-700 ml-1\" htmlFor=\"email\">\r\n              Email Address\r\n            </label>\r\n            <div className=\"relative group/input\">\r\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                <Mail className=\"h-5 w-5 text-slate-400 group-focus-within/input:text-indigo-500 transition-colors\" />\r\n              </div>\r\n              <input\r\n                id=\"email\"\r\n                type=\"email\"\r\n                placeholder=\"you@example.com\"\r\n                className=\"w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-slate-900 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all hover:border-slate-300\"\r\n                required\r\n                value={email}\r\n                onChange={(e) => setEmail(e.target.value)}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Password */}\r\n          <div className=\"space-y-2\">\r\n            <div className=\"flex justify-between items-center\">\r\n              <label className=\"text-sm font-medium text-slate-700 ml-1\" htmlFor=\"password\">\r\n                Password\r\n              </label>\r\n              <Link\r\n                href=\"/auth/forgot-password\"\r\n                className=\"text-xs text-indigo-600 hover:text-indigo-500 transition-colors font-medium\"\r\n              >\r\n                Forgot password?\r\n              </Link>\r\n            </div>\r\n            <div className=\"relative group/input\">\r\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                <Lock className=\"h-5 w-5 text-slate-400 group-focus-within/input:text-indigo-500 transition-colors\" />\r\n              </div>\r\n              <input\r\n                id=\"password\"\r\n                type=\"password\"\r\n                placeholder=\"••••••••\"\r\n                className=\"w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-slate-900 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all hover:border-slate-300\"\r\n                required\r\n                value={password}\r\n                onChange={(e) => setPassword(e.target.value)}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {error && (\r\n            <motion.div\r\n              initial={{ opacity: 0, height: 0 }}\r\n              animate={{ opacity: 1, height: \"auto\" }}\r\n              className=\"flex items-center gap-2 p-3 rounded-lg bg-rose-50 border border-rose-200 text-rose-600 text-sm\"\r\n            >\r\n              <AlertCircle className=\"h-4 w-4 shrink-0\" />\r\n              <p>{error}</p>\r\n            </motion.div>\r\n          )}\r\n\r\n          <button\r\n            type=\"submit\"\r\n            disabled={isLoading}\r\n            className=\"w-full flex items-center justify-center gap-2 py-3.5 px-4 bg-linear-to-r from-indigo-600 to-violet-600 hover:from-indigo-500 hover:to-violet-500 text-white font-semibold rounded-xl shadow-lg shadow-indigo-500/20 transition-all disabled:opacity-70 disabled:cursor-not-allowed transform active:scale-[0.98]\"\r\n          >\r\n            {isLoading ? (\r\n              <Loader2 className=\"h-5 w-5 animate-spin\" />\r\n            ) : (\r\n              <>\r\n                Sign In <ArrowRight className=\"h-4 w-4\" />\r\n              </>\r\n            )}\r\n          </button>\r\n        </form>\r\n\r\n        <div className=\"mt-8 relative z-10\">\r\n          <div className=\"relative\">\r\n            <div className=\"absolute inset-0 flex items-center\">\r\n              <div className=\"w-full border-t border-slate-200\"></div>\r\n            </div>\r\n            <div className=\"relative flex justify-center text-sm\">\r\n              <span className=\"px-3 bg-white text-slate-500\">Or continue with</span>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"mt-6 grid grid-cols-2 gap-4\">\r\n            <button\r\n              onClick={handleGoogleLogin}\r\n              disabled={isLoading}\r\n              type=\"button\"\r\n              className=\"flex items-center justify-center gap-2 px-4 py-2.5 bg-white hover:bg-slate-50 border border-slate-200 hover:border-slate-300 rounded-xl text-slate-700 transition-all disabled:opacity-70 disabled:cursor-not-allowed shadow-sm\"\r\n            >\r\n              <FaGoogle className=\"h-4 w-4 text-slate-600\" />\r\n              <span className=\"text-sm font-medium\">Google</span>\r\n            </button>\r\n            <button\r\n              disabled={isLoading}\r\n              type=\"button\"\r\n              className=\"flex items-center justify-center gap-2 px-4 py-2.5 bg-white hover:bg-slate-50 border border-slate-200 hover:border-slate-300 rounded-xl text-slate-700 transition-all disabled:opacity-70 disabled:cursor-not-allowed shadow-sm hidden\"\r\n            >\r\n              <FaGithub className=\"h-4 w-4 text-slate-600\" />\r\n              <span className=\"text-sm font-medium\">GitHub</span>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <p className=\"mt-8 text-center text-sm text-slate-600\">\r\n        Don't have an account?{\" \"}\r\n        <Link\r\n          href={next ? `/auth/sign-up?next=${encodeURIComponent(next)}` : \"/auth/sign-up\"}\r\n          className=\"font-medium text-indigo-600 hover:text-indigo-500 transition-colors hover:underline\"\r\n        >\r\n          Sign up\r\n        </Link>\r\n      </p>\r\n    </motion.div>\r\n  );\r\n}\r\n\r\nexport default function LoginPage() {\r\n  return (\r\n    <div className=\"flex items-center justify-center min-h-[calc(100vh-200px)]\">\r\n      <Suspense fallback={<Loader2 className=\"h-8 w-8 animate-spin text-indigo-600\" />}>\r\n        <LoginForm />\r\n      </Suspense>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}