{
  "version": 3,
  "sources": [],
  "sections": [
    {
      "offset": {
        "line": 4,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/lib/supabase/client.ts"
        ],
        "sourcesContent": [
          "import { createBrowserClient } from \"@supabase/ssr\"\r\n\r\nexport function createClient() {\r\n  return createBrowserClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\r\n  )\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;AAII;AAJJ;AAAA;;AAEO,SAAS;IACd,OAAO,IAAA,oMAAmB;AAI5B"
      }
    },
    {
      "offset": {
        "line": 22,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/SmartLink.tsx"
        ],
        "sourcesContent": [
          "'use client';\r\n\r\nimport { useRouter } from 'next/navigation';\r\nimport { useQueryClient } from '@tanstack/react-query';\r\nimport { useRef, ReactNode, useTransition } from 'react';\r\nimport Link from 'next/link';\r\n\r\ninterface SmartLinkProps {\r\n    href: string;\r\n    prefetchQuery?: () => Promise<any>;\r\n    queryKey?: any[];\r\n    children: ReactNode;\r\n    className?: string;\r\n    onClick?: () => void;\r\n}\r\n\r\n/**\r\n * SmartLink - Intelligent prefetching link component\r\n * \r\n * Features:\r\n * - Desktop: Prefetches on hover (onMouseEnter)\r\n * - Mobile: Prefetches on touch start (onPointerDown) - saves milliseconds before click\r\n * - Prevents duplicate prefetches with useRef\r\n * - Integrates with React Query cache for data prefetching\r\n * - Uses router.push for instant client-side navigation\r\n * \r\n * @example\r\n * // With data prefetching\r\n * <SmartLink\r\n *   href=\"/learn/course-123\"\r\n *   queryKey={['course', 'course-123']}\r\n *   prefetchQuery={() => fetchCourseData('course-123')}\r\n * >\r\n *   View Course\r\n * </SmartLink>\r\n * \r\n * @example\r\n * // Route-only prefetching (no data)\r\n * <SmartLink href=\"/dashboard\">\r\n *   Dashboard\r\n * </SmartLink>\r\n */\r\nexport function SmartLink({\r\n    href,\r\n    prefetchQuery,\r\n    queryKey,\r\n    children,\r\n    className,\r\n    onClick\r\n}: SmartLinkProps) {\r\n    const router = useRouter();\r\n    const queryClient = useQueryClient();\r\n    const prefetchedRef = useRef(false);\r\n    const [isPending, startTransition] = useTransition();\r\n\r\n    const handlePrefetch = () => {\r\n        // Prevent duplicate prefetches\r\n        if (prefetchedRef.current) return;\r\n\r\n        prefetchedRef.current = true;\r\n\r\n        // If we have a query function, prefetch the data\r\n        if (prefetchQuery && queryKey) {\r\n            queryClient.prefetchQuery({\r\n                queryKey,\r\n                queryFn: prefetchQuery,\r\n                staleTime: 1000 * 60 * 5, // 5 minutes\r\n            });\r\n        }\r\n\r\n        // Always prefetch the route for instant navigation\r\n        router.prefetch(href);\r\n    };\r\n\r\n    const handleClick = (e: React.MouseEvent) => {\r\n        e.preventDefault();\r\n\r\n        // Call custom onClick if provided (for things like closing mobile menu)\r\n        if (onClick) {\r\n            onClick();\r\n        }\r\n\r\n        // List of routes that are handled by the SPA containers\r\n        const spaRoutes = [\r\n            '/admin/dashboard', '/admin/courses', '/admin/test-series', '/admin/question-bank',\r\n            '/admin/exams', '/admin/payments',\r\n            '/admin/students', '/admin/settings',\r\n            '/student/dashboard', '/student/results', '/student/rewards',\r\n            '/student/settings', '/student/my-series', '/student/my-courses',\r\n            '/student/all-courses', '/student/all-test-series'\r\n        ];\r\n\r\n        const isExactSpaRoute = spaRoutes.includes(href);\r\n\r\n        // ‚ö° INSTANT STUDENT NAVIGATION: Use StudentAppContainer for exact SPA routes\r\n        if (href.startsWith('/student/') && (window as any).__studentNavigate && isExactSpaRoute) {\r\n            (window as any).__studentNavigate(href);\r\n            return;\r\n        }\r\n\r\n        // ‚ö° INSTANT ADMIN NAVIGATION: Use AdminAppContainer for exact SPA routes\r\n        if (href.startsWith('/admin/') && (window as any).__adminNavigate && isExactSpaRoute) {\r\n            (window as any).__adminNavigate(href);\r\n            return;\r\n        }\r\n\r\n        // For all other routes (including dynamic routes), use router.push\r\n        // Prefetching makes this fast\r\n        startTransition(() => {\r\n            router.push(href);\r\n        });\r\n    };\r\n\r\n    return (\r\n        <a\r\n            href={href}\r\n            onClick={handleClick}\r\n            onMouseEnter={handlePrefetch} // Desktop: Hover prefetch\r\n            onPointerDown={handlePrefetch} // Mobile: Touch prefetch (before click)\r\n            className={className}\r\n            style={{ cursor: 'pointer' }}\r\n        >\r\n            {children}\r\n        </a>\r\n    );\r\n}"
        ],
        "names": [],
        "mappings": ";;;;;AAEA;AACA;AACA;;;AAJA;;;;AA0CO,SAAS,UAAU,EACtB,IAAI,EACJ,aAAa,EACb,QAAQ,EACR,QAAQ,EACR,SAAS,EACT,OAAO,EACM;;IACb,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,cAAc,IAAA,2MAAc;IAClC,MAAM,gBAAgB,IAAA,uKAAM,EAAC;IAC7B,MAAM,CAAC,WAAW,gBAAgB,GAAG,IAAA,8KAAa;IAElD,MAAM,iBAAiB;QACnB,+BAA+B;QAC/B,IAAI,cAAc,OAAO,EAAE;QAE3B,cAAc,OAAO,GAAG;QAExB,iDAAiD;QACjD,IAAI,iBAAiB,UAAU;YAC3B,YAAY,aAAa,CAAC;gBACtB;gBACA,SAAS;gBACT,WAAW,OAAO,KAAK;YAC3B;QACJ;QAEA,mDAAmD;QACnD,OAAO,QAAQ,CAAC;IACpB;IAEA,MAAM,cAAc,CAAC;QACjB,EAAE,cAAc;QAEhB,wEAAwE;QACxE,IAAI,SAAS;YACT;QACJ;QAEA,wDAAwD;QACxD,MAAM,YAAY;YACd;YAAoB;YAAkB;YAAsB;YAC5D;YAAgB;YAChB;YAAmB;YACnB;YAAsB;YAAoB;YAC1C;YAAqB;YAAsB;YAC3C;YAAwB;SAC3B;QAED,MAAM,kBAAkB,UAAU,QAAQ,CAAC;QAE3C,6EAA6E;QAC7E,IAAI,KAAK,UAAU,CAAC,gBAAgB,AAAC,OAAe,iBAAiB,IAAI,iBAAiB;YACrF,OAAe,iBAAiB,CAAC;YAClC;QACJ;QAEA,yEAAyE;QACzE,IAAI,KAAK,UAAU,CAAC,cAAc,AAAC,OAAe,eAAe,IAAI,iBAAiB;YACjF,OAAe,eAAe,CAAC;YAChC;QACJ;QAEA,mEAAmE;QACnE,8BAA8B;QAC9B,gBAAgB;YACZ,OAAO,IAAI,CAAC;QAChB;IACJ;IAEA,qBACI,6LAAC;QACG,MAAM;QACN,SAAS;QACT,cAAc;QACd,eAAe;QACf,WAAW;QACX,OAAO;YAAE,QAAQ;QAAU;kBAE1B;;;;;;AAGb;GAnFgB;;QAQG,kJAAS;QACJ,2MAAc;QAEG,8KAAa;;;KAXtC"
      }
    },
    {
      "offset": {
        "line": 132,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/context/CommunityModalContext.tsx"
        ],
        "sourcesContent": [
          "\"use client\";\r\n\r\nimport { createContext, useContext, useState, ReactNode } from 'react';\r\n\r\ntype CommunityModalOptions = {\r\n    courseId?: string;\r\n    isAdmin?: boolean;\r\n};\r\n\r\ntype CommunityModalContextType = {\r\n    isOpen: boolean;\r\n    openCommunity: (options?: CommunityModalOptions) => void;\r\n    closeCommunity: () => void;\r\n    options: CommunityModalOptions;\r\n};\r\n\r\nconst CommunityModalContext = createContext<CommunityModalContextType | undefined>(undefined);\r\n\r\nexport function CommunityModalProvider({ children }: { children: ReactNode }) {\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const [options, setOptions] = useState<CommunityModalOptions>({});\r\n\r\n    const openCommunity = (opts: CommunityModalOptions = {}) => {\r\n        setOptions(opts);\r\n        setIsOpen(true);\r\n    };\r\n\r\n    const closeCommunity = () => {\r\n        setIsOpen(false);\r\n        // Reset options after a delay to avoid UI storage clearing while closing animation runs\r\n        setTimeout(() => setOptions({}), 300);\r\n    };\r\n\r\n    return (\r\n        <CommunityModalContext.Provider value={{ isOpen, openCommunity, closeCommunity, options }}>\r\n            {children}\r\n        </CommunityModalContext.Provider>\r\n    );\r\n}\r\n\r\nexport function useCommunityModal() {\r\n    const context = useContext(CommunityModalContext);\r\n    if (!context) {\r\n        throw new Error('useCommunityModal must be used within CommunityModalProvider');\r\n    }\r\n    return context;\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;;;;AAEA;;;AAFA;;AAgBA,MAAM,sCAAwB,IAAA,8KAAa,EAAwC;AAE5E,SAAS,uBAAuB,EAAE,QAAQ,EAA2B;;IACxE,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IACrC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAwB,CAAC;IAE/D,MAAM,gBAAgB,CAAC,OAA8B,CAAC,CAAC;QACnD,WAAW;QACX,UAAU;IACd;IAEA,MAAM,iBAAiB;QACnB,UAAU;QACV,wFAAwF;QACxF,WAAW,IAAM,WAAW,CAAC,IAAI;IACrC;IAEA,qBACI,6LAAC,sBAAsB,QAAQ;QAAC,OAAO;YAAE;YAAQ;YAAe;YAAgB;QAAQ;kBACnF;;;;;;AAGb;GApBgB;KAAA;AAsBT,SAAS;;IACZ,MAAM,UAAU,IAAA,2KAAU,EAAC;IAC3B,IAAI,CAAC,SAAS;QACV,MAAM,IAAI,MAAM;IACpB;IACA,OAAO;AACX;IANgB"
      }
    },
    {
      "offset": {
        "line": 192,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/app/admin/components/layout/Sidebar.tsx"
        ],
        "sourcesContent": [
          "\"use client\";\r\n\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport {\r\n  BookOpen,\r\n  Grid,\r\n  LayoutDashboard,\r\n  Menu,\r\n  Settings,\r\n  Users,\r\n  Home,\r\n  BookCheck,\r\n  ChevronDown,\r\n  LogOut,\r\n  X,\r\n  GraduationCap,\r\n  Layers,\r\n  Award,\r\n  TrendingUp,\r\n  CreditCard,\r\n  Gift,\r\n  MessageSquare\r\n} from \"lucide-react\";\r\nimport { SmartLink } from \"@/components/SmartLink\";\r\nimport { usePathname } from \"next/navigation\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { useCommunityModal } from \"@/context/CommunityModalContext\";\r\n\r\n\r\ninterface SidebarProps {\r\n  menuItems: {\r\n    icon: keyof typeof iconMap;\r\n    label: string;\r\n    href: string;\r\n    onClick?: string;\r\n    prefetch?: () => Promise<any>; // For data prefetching\r\n  }[];\r\n  sidebarCollapsed: boolean;\r\n  setSidebarCollapsed: (v: boolean) => void;\r\n  profile?: any;\r\n}\r\n\r\nconst iconMap = {\r\n  dashboard: LayoutDashboard,\r\n  user: Users,\r\n  home: Home,\r\n  book: BookOpen,\r\n  grid: Grid,\r\n  settings: Settings,\r\n  question: BookCheck,\r\n  layers: Layers,\r\n  graduation: GraduationCap,\r\n  bookopen: BookOpen,\r\n  trendingup: TrendingUp,\r\n  award: Award,\r\n  payment: CreditCard,\r\n  gift: Gift,\r\n  messagesquare: MessageSquare,\r\n};\r\n\r\n\r\n\r\nexport default function Sidebar({\r\n  menuItems,\r\n  sidebarCollapsed,\r\n  setSidebarCollapsed,\r\n  profile,\r\n}: SidebarProps) {\r\n  const pathname = usePathname();\r\n  const [isMobileOpen, setIsMobileOpen] = useState(false);\r\n  const [showControlMenu, setShowControlMenu] = useState(false);\r\n  const [expandMode, setExpandMode] = useState<\"expanded\" | \"collapsed\" | \"hover\">(\"expanded\");\r\n  const { openCommunity } = useCommunityModal();\r\n\r\n  // Lock scroll when mobile drawer is open\r\n  useEffect(() => {\r\n    document.body.style.overflow = isMobileOpen ? \"hidden\" : \"auto\";\r\n  }, [isMobileOpen]);\r\n\r\n  // Handle hover expansion mode\r\n  const handleMouseEnter = () => {\r\n    if (expandMode === \"hover\") setSidebarCollapsed(false);\r\n  };\r\n  const handleMouseLeave = () => {\r\n    if (expandMode === \"hover\") setSidebarCollapsed(true);\r\n  };\r\n\r\n  const handleMenuItemClick = (item: typeof menuItems[0]) => {\r\n    if (item.onClick === \"openCommunity\") {\r\n      const isAdmin = profile?.role === 'admin' || profile?.role === 'creator';\r\n      openCommunity({ isAdmin });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/* üñ•Ô∏è Desktop Sidebar */}\r\n      <aside\r\n        onMouseEnter={handleMouseEnter}\r\n        onMouseLeave={handleMouseLeave}\r\n        className={`hidden md:flex flex-col fixed left-0 top-0 h-screen p-4 \r\n        bg-white/90 dark:bg-slate-900/90 backdrop-blur-xl border-r border-slate-200 dark:border-slate-800\r\n        transition-all duration-500 z-40 \r\n        ${sidebarCollapsed ? \"w-20\" : \"w-64\"}`}\r\n      >\r\n        {/* Logo */}\r\n        <div className={`flex items-center gap-3 mb-8 transition-all duration-500 ${sidebarCollapsed ? \"justify-center\" : \"px-2\"}`}>\r\n          {sidebarCollapsed ? (\r\n            <SmartLink href=\"/\" queryKey={['route', '/']}>\r\n              <div className=\"w-10 h-10 rounded-lg overflow-hidden\">\r\n                <img src=\"/mathlogo.png\" alt=\"math4code\" className=\"w-full h-full object-contain\" />\r\n              </div>\r\n            </SmartLink>\r\n          ) : (\r\n            <SmartLink href=\"/\" queryKey={['route', '/']} className=\"flex items-center gap-3\">\r\n              <img src=\"/mathlogo.png\" alt=\"math4code Academy\" className=\"h-10 w-auto object-contain\" />\r\n            </SmartLink>\r\n          )}\r\n          {!sidebarCollapsed && (\r\n            <motion.div\r\n              initial={{ opacity: 0, x: -10 }}\r\n              animate={{ opacity: 1, x: 0 }}\r\n              transition={{ delay: 0.1 }}\r\n            >\r\n              <p className=\"text-xs text-slate-500 dark:text-slate-400 font-medium\">\r\n                Admin Workspace\r\n              </p>\r\n            </motion.div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Menu */}\r\n        <nav className=\"flex-1 flex flex-col gap-1.5 overflow-y-auto custom-scrollbar py-2\">\r\n          {menuItems.map((it) => {\r\n            const Icon = iconMap[it.icon as keyof typeof iconMap] || Grid;\r\n            const isActive = pathname === it.href || pathname.startsWith(`${it.href}/`);\r\n            const hasOnClick = it.onClick === \"openCommunity\";\r\n\r\n            if (hasOnClick) {\r\n              return (\r\n                <button\r\n                  key={it.label}\r\n                  onClick={() => handleMenuItemClick(it)}\r\n                  className={`group flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-200 relative overflow-hidden\r\n                  ${isActive\r\n                      ? \"bg-indigo-50 dark:bg-indigo-500/10 text-indigo-600 dark:text-indigo-400 shadow-sm\"\r\n                      : \"text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800/50 hover:text-slate-900 dark:hover:text-slate-200\"\r\n                    }`}\r\n                >\r\n                  {isActive && (\r\n                    <motion.div\r\n                      layoutId=\"activeTab\"\r\n                      className=\"absolute left-0 top-0 bottom-0 w-1 bg-indigo-600 rounded-r-full\"\r\n                    />\r\n                  )}\r\n                  <Icon className={`w-5 h-5 min-w-[1.25rem] transition-colors ${isActive ? \"text-indigo-600 dark:text-indigo-400\" : \"text-slate-400 group-hover:text-slate-600 dark:text-slate-500 dark:group-hover:text-slate-300\"}`} />\r\n\r\n                  {!sidebarCollapsed && (\r\n                    <motion.span\r\n                      initial={{ opacity: 0 }}\r\n                      animate={{ opacity: 1 }}\r\n                      className=\"text-sm font-medium truncate\"\r\n                    >\r\n                      {it.label}\r\n                    </motion.span>\r\n                  )}\r\n\r\n                  {/* Tooltip for collapsed state */}\r\n                  {sidebarCollapsed && (\r\n                    <div className=\"absolute left-full ml-4 px-2 py-1 bg-slate-900 text-white text-xs rounded opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity whitespace-nowrap z-50\">\r\n                      {it.label}\r\n                    </div>\r\n                  )}\r\n                </button>\r\n              );\r\n            }\r\n\r\n            return (\r\n              <SmartLink\r\n                key={it.label}\r\n                href={it.href}\r\n                queryKey={it.prefetch ? ['route-data', it.href] : undefined}\r\n                prefetchQuery={it.prefetch}\r\n                className={`group flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-200 relative overflow-hidden\r\n                ${isActive\r\n                    ? \"bg-indigo-50 dark:bg-indigo-500/10 text-indigo-600 dark:text-indigo-400 shadow-sm\"\r\n                    : \"text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800/50 hover:text-slate-900 dark:hover:text-slate-200\"\r\n                  }`}\r\n              >\r\n                {isActive && (\r\n                  <motion.div\r\n                    layoutId=\"activeTab\"\r\n                    className=\"absolute left-0 top-0 bottom-0 w-1 bg-indigo-600 rounded-r-full\"\r\n                  />\r\n                )}\r\n                <Icon className={`w-5 h-5 min-w-[1.25rem] transition-colors ${isActive ? \"text-indigo-600 dark:text-indigo-400\" : \"text-slate-400 group-hover:text-slate-600 dark:text-slate-500 dark:group-hover:text-slate-300\"}`} />\r\n\r\n                {!sidebarCollapsed && (\r\n                  <motion.span\r\n                    initial={{ opacity: 0 }}\r\n                    animate={{ opacity: 1 }}\r\n                    className=\"text-sm font-medium truncate\"\r\n                  >\r\n                    {it.label}\r\n                  </motion.span>\r\n                )}\r\n\r\n                {/* Tooltip for collapsed state */}\r\n                {sidebarCollapsed && (\r\n                  <div className=\"absolute left-full ml-4 px-2 py-1 bg-slate-900 text-white text-xs rounded opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity whitespace-nowrap z-50\">\r\n                    {it.label}\r\n                  </div>\r\n                )}\r\n              </SmartLink>\r\n            );\r\n          })}\r\n        </nav>\r\n\r\n\r\n        {/* Collapse / Control Button */}\r\n        <div className=\"mt-auto pt-4 border-t border-slate-100 dark:border-slate-800\">\r\n          <button\r\n            onClick={() => setShowControlMenu((p) => !p)}\r\n            className={`w-full flex items-center gap-3 py-2.5 px-3 rounded-xl \r\n            hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors\r\n            ${sidebarCollapsed ? \"justify-center\" : \"\"}`}\r\n          >\r\n            <div className=\"w-8 h-8 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center\">\r\n              <Settings className=\"w-4 h-4 text-slate-600 dark:text-slate-400\" />\r\n            </div>\r\n            {!sidebarCollapsed && (\r\n              <>\r\n                <div className=\"flex-1 text-left\">\r\n                  <span className=\"block text-sm font-medium text-slate-700 dark:text-slate-200\">\r\n                    Settings\r\n                  </span>\r\n                </div>\r\n                <ChevronDown className={`w-4 h-4 text-slate-400 transition-transform ${showControlMenu ? \"rotate-180\" : \"\"}`} />\r\n              </>\r\n            )}\r\n          </button>\r\n\r\n          {/* ‚öôÔ∏è Sidebar Control Popup */}\r\n          <AnimatePresence>\r\n            {showControlMenu && (\r\n              <motion.div\r\n                initial={{ opacity: 0, y: 10, scale: 0.95 }}\r\n                animate={{ opacity: 1, y: 0, scale: 1 }}\r\n                exit={{ opacity: 0, y: 10, scale: 0.95 }}\r\n                transition={{ duration: 0.2 }}\r\n                className={`absolute bottom-20 ${sidebarCollapsed ? 'left-0 w-56' : 'left-4 right-4'} rounded-2xl bg-white dark:bg-slate-800 shadow-2xl border border-slate-200 dark:border-slate-700 p-2 z-50 overflow-hidden`}\r\n              >\r\n                <div className=\"px-2 py-1.5 mb-1\">\r\n                  <h4 className=\"text-xs font-semibold text-slate-500 uppercase tracking-wider\">\r\n                    Sidebar Mode\r\n                  </h4>\r\n                </div>\r\n\r\n                {[\r\n                  { key: \"expanded\", label: \"Always Expanded\" },\r\n                  { key: \"collapsed\", label: \"Always Collapsed\" },\r\n                  { key: \"hover\", label: \"Expand on Hover\" },\r\n                ].map((mode) => (\r\n                  <button\r\n                    key={mode.key}\r\n                    onClick={() => {\r\n                      setExpandMode(mode.key as any);\r\n                      setShowControlMenu(false);\r\n                      setSidebarCollapsed(mode.key === \"collapsed\");\r\n                    }}\r\n                    className={`w-full text-left px-3 py-2 rounded-lg text-sm flex items-center justify-between transition-colors ${expandMode === mode.key\r\n                      ? \"bg-indigo-50 text-indigo-600 dark:bg-indigo-500/20 dark:text-indigo-300\"\r\n                      : \"hover:bg-slate-50 dark:hover:bg-slate-700/50 text-slate-700 dark:text-slate-300\"\r\n                      }`}\r\n                  >\r\n                    {mode.label}\r\n                    {expandMode === mode.key && (\r\n                      <div className=\"w-1.5 h-1.5 rounded-full bg-indigo-600 dark:bg-indigo-400\" />\r\n                    )}\r\n                  </button>\r\n                ))}\r\n              </motion.div>\r\n            )}\r\n          </AnimatePresence>\r\n        </div>\r\n      </aside>\r\n\r\n      {/* üì± Mobile Menu Button */}\r\n      <button\r\n        onClick={() => setIsMobileOpen(true)}\r\n        className=\"fixed top-4 left-4 z-50 md:hidden bg-white/80 dark:bg-slate-900/80 backdrop-blur-md p-2.5 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 text-slate-700 dark:text-slate-200\"\r\n      >\r\n        <Menu className=\"w-5 h-5\" />\r\n      </button>\r\n\r\n      {/* üì± Mobile Sidebar */}\r\n      <AnimatePresence>\r\n        {isMobileOpen && (\r\n          <>\r\n            {/* Overlay */}\r\n            <motion.div\r\n              initial={{ opacity: 0 }}\r\n              animate={{ opacity: 1 }}\r\n              exit={{ opacity: 0 }}\r\n              transition={{ duration: 0.2 }}\r\n              className=\"fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-50 md:hidden\"\r\n              onClick={() => setIsMobileOpen(false)}\r\n            />\r\n\r\n            {/* Slide-in Sidebar */}\r\n            <motion.aside\r\n              initial={{ x: \"-100%\" }}\r\n              animate={{ x: 0 }}\r\n              exit={{ x: \"-100%\" }}\r\n              transition={{ type: \"spring\", damping: 25, stiffness: 200 }}\r\n              className=\"fixed left-0 top-0 h-full w-80 z-50 bg-white dark:bg-slate-900 shadow-2xl flex flex-col md:hidden\"\r\n            >\r\n              {/* Header */}\r\n              <div className=\"flex items-center justify-between p-6 border-b border-slate-100 dark:border-slate-800\">\r\n                <div className=\"flex items-center gap-3\">\r\n                  <img src=\"/mathlogo.png\" alt=\"math4code Academy\" className=\"h-10 w-auto object-contain\" />\r\n                  <div>\r\n                    <p className=\"text-xs text-slate-500 dark:text-slate-400 font-medium\">\r\n                      Admin Panel\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n\r\n                <button\r\n                  onClick={() => setIsMobileOpen(false)}\r\n                  className=\"p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-500 transition-colors\"\r\n                >\r\n                  <X className=\"w-5 h-5\" />\r\n                </button>\r\n              </div>\r\n\r\n              {/* Menu Items */}\r\n              <nav className=\"flex-1 flex flex-col gap-1 p-4 overflow-y-auto\">\r\n                {menuItems.map((it) => {\r\n                  const Icon = iconMap[it.icon as keyof typeof iconMap] || Grid;\r\n                  const isActive = pathname === it.href || pathname.startsWith(`${it.href}/`);\r\n                  const hasOnClick = it.onClick === \"openCommunity\";\r\n\r\n                  if (hasOnClick) {\r\n                    return (\r\n                      <button\r\n                        key={it.label}\r\n                        onClick={() => {\r\n                          handleMenuItemClick(it);\r\n                          setIsMobileOpen(false);\r\n                        }}\r\n                        className={`flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200\r\n                        ${isActive\r\n                            ? \"bg-indigo-50 dark:bg-indigo-500/10 text-indigo-600 dark:text-indigo-400 font-medium\"\r\n                            : \"text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800/50\"\r\n                          }`}\r\n                      >\r\n                        <Icon className={`w-5 h-5 ${isActive ? \"text-indigo-600 dark:text-indigo-400\" : \"text-slate-400\"}`} />\r\n                        <span className=\"text-sm\">\r\n                          {it.label}\r\n                        </span>\r\n                        {isActive && (\r\n                          <div className=\"ml-auto w-1.5 h-1.5 rounded-full bg-indigo-600 dark:bg-indigo-400\" />\r\n                        )}\r\n                      </button>\r\n                    );\r\n                  }\r\n\r\n                  return (\r\n                    <SmartLink\r\n                      key={it.label}\r\n                      href={it.href}\r\n                      queryKey={it.prefetch ? ['route-data', it.href] : undefined}\r\n                      prefetchQuery={it.prefetch}\r\n                      onClick={() => setIsMobileOpen(false)}\r\n                      className={`flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200\r\n                      ${isActive\r\n                          ? \"bg-indigo-50 dark:bg-indigo-500/10 text-indigo-600 dark:text-indigo-400 font-medium\"\r\n                          : \"text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800/50\"\r\n                        }`}\r\n                    >\r\n                      <Icon className={`w-5 h-5 ${isActive ? \"text-indigo-600 dark:text-indigo-400\" : \"text-slate-400\"}`} />\r\n                      <span className=\"text-sm\">\r\n                        {it.label}\r\n                      </span>\r\n                      {isActive && (\r\n                        <div className=\"ml-auto w-1.5 h-1.5 rounded-full bg-indigo-600 dark:bg-indigo-400\" />\r\n                      )}\r\n                    </SmartLink>\r\n                  );\r\n                })}\r\n              </nav>\r\n\r\n              <div className=\"p-4 border-t border-slate-100 dark:border-slate-800\">\r\n                <p className=\"text-xs text-center text-slate-400 dark:text-slate-500\">\r\n                  ¬© 2025 math4code Academy. All rights reserved.\r\n                </p>\r\n              </div>\r\n            </motion.aside>\r\n          </>\r\n        )}\r\n      </AnimatePresence>\r\n    </>\r\n  );\r\n}\r\n"
        ],
        "names": [],
        "mappings": "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"
      }
    },
    {
      "offset": {
        "line": 879,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/app/actions/rewardActions.ts"
        ],
        "sourcesContent": [
          "\"use server\";\r\n\r\nimport { createClient } from \"@/lib/supabase/server\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\ntype ActionType = 'login' | 'video_watch' | 'lesson_completion' | 'quiz_completion' | 'module_completion' | 'referral' | 'bonus' | 'mission_complete';\r\n\r\nconst REWARD_RULES = {\r\n    login: { coins: 5, limit: 1 },\r\n    video_watch: { coins: 10, limit: 10 },\r\n    lesson_completion: { coins: 10, limit: 20 }, // Generic lesson completion\r\n    quiz_completion: { coins: 15, limit: 10 },\r\n    quiz_bonus: { coins: 10, limit: 10 },\r\n    module_completion: { coins: 50, limit: 5 },\r\n    referral: { coins: 100, limit: 10 },\r\n    streak_3: { coins: 10, limit: 1 },\r\n    streak_7: { coins: 30, limit: 1 },\r\n    streak_30: { coins: 100, limit: 1 },\r\n    mission_complete: { coins: 20, limit: 3 }\r\n};\r\n\r\nconst DAILY_COIN_CAP = 100;\r\n\r\nexport async function getRewardStatus(userId: string) {\r\n    const supabase = await createClient();\r\n    let { data } = await supabase\r\n        .from(\"user_rewards\")\r\n        .select(\"*\")\r\n        .eq(\"user_id\", userId)\r\n        .single();\r\n\r\n    if (!data) {\r\n        // Initialize if not exists\r\n        const { data: newData, error } = await supabase\r\n            .from(\"user_rewards\")\r\n            .insert({ user_id: userId })\r\n            .select()\r\n            .single();\r\n\r\n        if (error) {\r\n            if (error.code === '23505') {\r\n                const { data: retryData } = await supabase\r\n                    .from(\"user_rewards\")\r\n                    .select(\"*\")\r\n                    .eq(\"user_id\", userId)\r\n                    .single();\r\n                data = retryData;\r\n            } else {\r\n                console.error(\"Error creating user_rewards in getRewardStatus:\", error);\r\n                return null;\r\n            }\r\n        } else {\r\n            data = newData;\r\n        }\r\n    }\r\n\r\n    return data;\r\n}\r\n\r\nexport async function checkStreak(userId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Just fetch the current status to display to the user\r\n    // The actual update happens when 'login' reward is awarded below\r\n    const { data: rewardStatus } = await supabase\r\n        .from(\"user_rewards\")\r\n        .select(\"current_streak, longest_streak, last_activity_date\")\r\n        .eq(\"user_id\", userId)\r\n        .single();\r\n\r\n    if (!rewardStatus) return { streak: 0, message: null };\r\n\r\n    // We can infer if they are on a streak or if it's broken based on the date,\r\n    // but primarily we just want to show the current value.\r\n    // The DB trigger updates this immediately upon the 'login' transaction insertion.\r\n\r\n    return {\r\n        streak: rewardStatus.current_streak,\r\n        message: null\r\n    };\r\n}\r\n\r\nexport async function awardCoins(\r\n    userId: string,\r\n    action: ActionType,\r\n    entityId?: string,\r\n    description?: string\r\n) {\r\n    const supabase = await createClient();\r\n    const today = new Date().toISOString().split('T')[0];\r\n\r\n    // 1. Check strict duplicate rules (Client-Side Protection)\r\n    // We don't want to spam the DB trigger with 'login' events every refresh\r\n    if (action === 'login') {\r\n        entityId = today; // Force entityId to be date for login\r\n    }\r\n\r\n    if (entityId) {\r\n        const { data: existing } = await supabase\r\n            .from(\"reward_transactions\")\r\n            .select(\"id\")\r\n            .eq(\"user_id\", userId)\r\n            .eq(\"action_type\", action)\r\n            .eq(\"entity_id\", entityId)\r\n            .gte(\"created_at\", `${today}T00:00:00`)\r\n            .single();\r\n\r\n        if (existing) {\r\n            return { success: false, message: \"Already rewarded for this today!\" };\r\n        }\r\n    }\r\n\r\n    // 2. Define Amount (We still define it here to pass to DB, or DB could handle default)\r\n    let coins = 0;\r\n    switch (action) {\r\n        case 'login': coins = REWARD_RULES.login.coins; break;\r\n        case 'video_watch': coins = REWARD_RULES.video_watch.coins; break;\r\n        case 'lesson_completion': coins = REWARD_RULES.lesson_completion.coins; break;\r\n        case 'quiz_completion': coins = REWARD_RULES.quiz_completion.coins; break;\r\n        case 'module_completion': coins = REWARD_RULES.module_completion.coins; break;\r\n        case 'referral': coins = REWARD_RULES.referral.coins; break;\r\n        case 'mission_complete': coins = REWARD_RULES.mission_complete.coins; break;\r\n        case 'bonus': coins = 10; break;\r\n        default: coins = 0;\r\n    }\r\n\r\n    // 3. Insert Transaction (The DB Trigger takes it from here!)\r\n    // It will: Update Coins, XP, Level, and Streak (if login)\r\n    const { error } = await supabase.from(\"reward_transactions\").insert({\r\n        user_id: userId,\r\n        amount: coins,\r\n        action_type: action,\r\n        entity_id: entityId,\r\n        description: description || `Reward for ${action}`\r\n    });\r\n\r\n    if (error) {\r\n        console.error(\"Reward Insert Error:\", error);\r\n        return { success: false, message: \"Failed to process reward.\" };\r\n    }\r\n\r\n    // 4. Post-Process (Optional Notifications or Revalidation)\r\n    revalidatePath(\"/student\");\r\n\r\n    if (action === 'login') {\r\n        // Special message for login\r\n        return { success: true, coins, message: \"Daily Reward Claimed!\" };\r\n    }\r\n\r\n    return { success: true, coins, message: `‚≠ê +${coins} coins!` };\r\n}\r\n\r\nexport async function getLeaderboard(type: 'weekly' | 'all_time' = 'all_time', limit: number = 10) {\r\n    const supabase = await createClient();\r\n\r\n    const sortColumn = type === 'weekly' ? 'weekly_xp' : 'total_coins'; // or xp\r\n\r\n    const { data } = await supabase\r\n        .from(\"user_rewards\")\r\n        .select(`\r\n            total_coins,\r\n            xp,\r\n            weekly_xp,\r\n            level,\r\n            current_streak,\r\n            user_id,\r\n            profiles:user_id (\r\n                full_name,\r\n                avatar_url\r\n            )\r\n        `)\r\n        .order(sortColumn, { ascending: false })\r\n        .limit(limit);\r\n\r\n    return data?.map((entry: any) => ({\r\n        ...entry,\r\n        profiles: Array.isArray(entry.profiles) ? entry.profiles[0] : entry.profiles\r\n    })) || [];\r\n}\r\n\r\nexport async function checkModuleCompletion(userId: string, moduleId: string) {\r\n    const supabase = await createClient();\r\n    const { data: lessons } = await supabase.from(\"lessons\").select(\"id\").eq(\"module_id\", moduleId);\r\n    if (!lessons || lessons.length === 0) return;\r\n\r\n    const { data: completed } = await supabase\r\n        .from(\"lesson_progress\")\r\n        .select(\"lesson_id\")\r\n        .eq(\"user_id\", userId)\r\n        .eq(\"completed\", true)\r\n        .in(\"lesson_id\", lessons.map(l => l.id));\r\n\r\n    const completedCount = completed?.length || 0;\r\n    if (completedCount === lessons.length) {\r\n        return await awardCoins(userId, 'module_completion', moduleId, 'Completed a module!');\r\n    }\r\n    return null;\r\n}\r\n\r\nexport async function checkFirstLessonReward(userId: string) {\r\n    const supabase = await createClient();\r\n    const { count } = await supabase\r\n        .from(\"lesson_progress\")\r\n        .select(\"*\", { count: 'exact', head: true })\r\n        .eq(\"user_id\", userId)\r\n        .eq(\"completed\", true);\r\n\r\n    if (count !== 1) return;\r\n\r\n    const { data: profile } = await supabase\r\n        .from(\"profiles\")\r\n        .select(\"referred_by\")\r\n        .eq(\"id\", userId)\r\n        .single();\r\n\r\n    if (!profile?.referred_by) return;\r\n\r\n    const referrerId = profile.referred_by;\r\n    const { data: existing } = await supabase\r\n        .from(\"reward_transactions\")\r\n        .select(\"*\")\r\n        .eq(\"user_id\", referrerId)\r\n        .eq(\"action_type\", 'referral')\r\n        .eq(\"entity_id\", userId)\r\n        .single();\r\n\r\n    if (existing) return;\r\n\r\n    // Award referrer\r\n    await awardCoins(referrerId, 'referral', userId, `Referral bonus for user ${userId}`);\r\n\r\n    // Check Badge for Referrer\r\n    await checkBadgeUnlock(referrerId, 'social_butterfly');\r\n}\r\n\r\n// --- NEW GAMIFICATION FUNCTIONS ---\r\n\r\nexport async function getDailyMissions(userId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Use RPC function to get or create missions\r\n    const { data, error } = await supabase.rpc('get_or_create_daily_missions', {\r\n        p_user_id: userId\r\n    });\r\n\r\n    if (error) {\r\n        console.error(\"Error fetching daily missions:\", error);\r\n        return [];\r\n    }\r\n\r\n    return data || [];\r\n}\r\n\r\n\r\nexport async function updateMissionProgress(userId: string, type: 'login' | 'quiz' | 'video') {\r\n    const supabase = await createClient();\r\n\r\n    // Use RPC function to update mission progress\r\n    const { data, error } = await supabase.rpc('update_mission_progress', {\r\n        p_user_id: userId,\r\n        p_mission_type: type\r\n    });\r\n\r\n    if (error) {\r\n        console.error(\"Error updating mission progress:\", error);\r\n        return;\r\n    }\r\n\r\n    // Check if any mission was completed\r\n    const missions = data || [];\r\n    const completedMission = missions.find((m: any) =>\r\n        m.id === type && m.completed && m.progress === m.goal\r\n    );\r\n\r\n    if (completedMission) {\r\n        // Award mission bonus\r\n        const today = new Date().toISOString().split('T')[0];\r\n        await awardCoins(userId, 'mission_complete', `${today}-${type}`, `Mission Complete: ${completedMission.title}`);\r\n    }\r\n\r\n    revalidatePath(\"/student\");\r\n}\r\n\r\n\r\nexport async function checkBadgeUnlock(userId: string, badgeId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Check if already has badge\r\n    const { data: existing } = await supabase\r\n        .from(\"user_badges\")\r\n        .select(\"*\")\r\n        .eq(\"user_id\", userId)\r\n        .eq(\"badge_id\", badgeId)\r\n        .single();\r\n\r\n    if (existing) return;\r\n\r\n    // Logic to verify if they actually earned it could go here, \r\n    // but usually we call this function when we KNOW they met the condition.\r\n\r\n    await supabase.from(\"user_badges\").insert({\r\n        user_id: userId,\r\n        badge_id: badgeId\r\n    });\r\n\r\n    // Could return a notification object\r\n}\r\n\r\nexport async function getUserBadges(userId: string) {\r\n    const supabase = await createClient();\r\n    const { data } = await supabase\r\n        .from(\"user_badges\")\r\n        .select(\"badge_id, earned_at\")\r\n        .eq(\"user_id\", userId);\r\n    return data || [];\r\n}\r\n\r\nexport async function getStreakHistory(userId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Fetch dates from reward_transactions\r\n    const { data } = await supabase\r\n        .from(\"reward_transactions\")\r\n        .select(\"created_at\")\r\n        .eq(\"user_id\", userId)\r\n        .order(\"created_at\", { ascending: false });\r\n\r\n    if (!data) return [];\r\n\r\n    // Extract unique dates (YYYY-MM-DD)\r\n    const uniqueDates = new Set(\r\n        data.map(item => item.created_at.split('T')[0])\r\n    );\r\n\r\n    return Array.from(uniqueDates);\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;;;;IAuBsB,kBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA"
      }
    },
    {
      "offset": {
        "line": 894,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/app/actions/rewardActions.ts"
        ],
        "sourcesContent": [
          "\"use server\";\r\n\r\nimport { createClient } from \"@/lib/supabase/server\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\ntype ActionType = 'login' | 'video_watch' | 'lesson_completion' | 'quiz_completion' | 'module_completion' | 'referral' | 'bonus' | 'mission_complete';\r\n\r\nconst REWARD_RULES = {\r\n    login: { coins: 5, limit: 1 },\r\n    video_watch: { coins: 10, limit: 10 },\r\n    lesson_completion: { coins: 10, limit: 20 }, // Generic lesson completion\r\n    quiz_completion: { coins: 15, limit: 10 },\r\n    quiz_bonus: { coins: 10, limit: 10 },\r\n    module_completion: { coins: 50, limit: 5 },\r\n    referral: { coins: 100, limit: 10 },\r\n    streak_3: { coins: 10, limit: 1 },\r\n    streak_7: { coins: 30, limit: 1 },\r\n    streak_30: { coins: 100, limit: 1 },\r\n    mission_complete: { coins: 20, limit: 3 }\r\n};\r\n\r\nconst DAILY_COIN_CAP = 100;\r\n\r\nexport async function getRewardStatus(userId: string) {\r\n    const supabase = await createClient();\r\n    let { data } = await supabase\r\n        .from(\"user_rewards\")\r\n        .select(\"*\")\r\n        .eq(\"user_id\", userId)\r\n        .single();\r\n\r\n    if (!data) {\r\n        // Initialize if not exists\r\n        const { data: newData, error } = await supabase\r\n            .from(\"user_rewards\")\r\n            .insert({ user_id: userId })\r\n            .select()\r\n            .single();\r\n\r\n        if (error) {\r\n            if (error.code === '23505') {\r\n                const { data: retryData } = await supabase\r\n                    .from(\"user_rewards\")\r\n                    .select(\"*\")\r\n                    .eq(\"user_id\", userId)\r\n                    .single();\r\n                data = retryData;\r\n            } else {\r\n                console.error(\"Error creating user_rewards in getRewardStatus:\", error);\r\n                return null;\r\n            }\r\n        } else {\r\n            data = newData;\r\n        }\r\n    }\r\n\r\n    return data;\r\n}\r\n\r\nexport async function checkStreak(userId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Just fetch the current status to display to the user\r\n    // The actual update happens when 'login' reward is awarded below\r\n    const { data: rewardStatus } = await supabase\r\n        .from(\"user_rewards\")\r\n        .select(\"current_streak, longest_streak, last_activity_date\")\r\n        .eq(\"user_id\", userId)\r\n        .single();\r\n\r\n    if (!rewardStatus) return { streak: 0, message: null };\r\n\r\n    // We can infer if they are on a streak or if it's broken based on the date,\r\n    // but primarily we just want to show the current value.\r\n    // The DB trigger updates this immediately upon the 'login' transaction insertion.\r\n\r\n    return {\r\n        streak: rewardStatus.current_streak,\r\n        message: null\r\n    };\r\n}\r\n\r\nexport async function awardCoins(\r\n    userId: string,\r\n    action: ActionType,\r\n    entityId?: string,\r\n    description?: string\r\n) {\r\n    const supabase = await createClient();\r\n    const today = new Date().toISOString().split('T')[0];\r\n\r\n    // 1. Check strict duplicate rules (Client-Side Protection)\r\n    // We don't want to spam the DB trigger with 'login' events every refresh\r\n    if (action === 'login') {\r\n        entityId = today; // Force entityId to be date for login\r\n    }\r\n\r\n    if (entityId) {\r\n        const { data: existing } = await supabase\r\n            .from(\"reward_transactions\")\r\n            .select(\"id\")\r\n            .eq(\"user_id\", userId)\r\n            .eq(\"action_type\", action)\r\n            .eq(\"entity_id\", entityId)\r\n            .gte(\"created_at\", `${today}T00:00:00`)\r\n            .single();\r\n\r\n        if (existing) {\r\n            return { success: false, message: \"Already rewarded for this today!\" };\r\n        }\r\n    }\r\n\r\n    // 2. Define Amount (We still define it here to pass to DB, or DB could handle default)\r\n    let coins = 0;\r\n    switch (action) {\r\n        case 'login': coins = REWARD_RULES.login.coins; break;\r\n        case 'video_watch': coins = REWARD_RULES.video_watch.coins; break;\r\n        case 'lesson_completion': coins = REWARD_RULES.lesson_completion.coins; break;\r\n        case 'quiz_completion': coins = REWARD_RULES.quiz_completion.coins; break;\r\n        case 'module_completion': coins = REWARD_RULES.module_completion.coins; break;\r\n        case 'referral': coins = REWARD_RULES.referral.coins; break;\r\n        case 'mission_complete': coins = REWARD_RULES.mission_complete.coins; break;\r\n        case 'bonus': coins = 10; break;\r\n        default: coins = 0;\r\n    }\r\n\r\n    // 3. Insert Transaction (The DB Trigger takes it from here!)\r\n    // It will: Update Coins, XP, Level, and Streak (if login)\r\n    const { error } = await supabase.from(\"reward_transactions\").insert({\r\n        user_id: userId,\r\n        amount: coins,\r\n        action_type: action,\r\n        entity_id: entityId,\r\n        description: description || `Reward for ${action}`\r\n    });\r\n\r\n    if (error) {\r\n        console.error(\"Reward Insert Error:\", error);\r\n        return { success: false, message: \"Failed to process reward.\" };\r\n    }\r\n\r\n    // 4. Post-Process (Optional Notifications or Revalidation)\r\n    revalidatePath(\"/student\");\r\n\r\n    if (action === 'login') {\r\n        // Special message for login\r\n        return { success: true, coins, message: \"Daily Reward Claimed!\" };\r\n    }\r\n\r\n    return { success: true, coins, message: `‚≠ê +${coins} coins!` };\r\n}\r\n\r\nexport async function getLeaderboard(type: 'weekly' | 'all_time' = 'all_time', limit: number = 10) {\r\n    const supabase = await createClient();\r\n\r\n    const sortColumn = type === 'weekly' ? 'weekly_xp' : 'total_coins'; // or xp\r\n\r\n    const { data } = await supabase\r\n        .from(\"user_rewards\")\r\n        .select(`\r\n            total_coins,\r\n            xp,\r\n            weekly_xp,\r\n            level,\r\n            current_streak,\r\n            user_id,\r\n            profiles:user_id (\r\n                full_name,\r\n                avatar_url\r\n            )\r\n        `)\r\n        .order(sortColumn, { ascending: false })\r\n        .limit(limit);\r\n\r\n    return data?.map((entry: any) => ({\r\n        ...entry,\r\n        profiles: Array.isArray(entry.profiles) ? entry.profiles[0] : entry.profiles\r\n    })) || [];\r\n}\r\n\r\nexport async function checkModuleCompletion(userId: string, moduleId: string) {\r\n    const supabase = await createClient();\r\n    const { data: lessons } = await supabase.from(\"lessons\").select(\"id\").eq(\"module_id\", moduleId);\r\n    if (!lessons || lessons.length === 0) return;\r\n\r\n    const { data: completed } = await supabase\r\n        .from(\"lesson_progress\")\r\n        .select(\"lesson_id\")\r\n        .eq(\"user_id\", userId)\r\n        .eq(\"completed\", true)\r\n        .in(\"lesson_id\", lessons.map(l => l.id));\r\n\r\n    const completedCount = completed?.length || 0;\r\n    if (completedCount === lessons.length) {\r\n        return await awardCoins(userId, 'module_completion', moduleId, 'Completed a module!');\r\n    }\r\n    return null;\r\n}\r\n\r\nexport async function checkFirstLessonReward(userId: string) {\r\n    const supabase = await createClient();\r\n    const { count } = await supabase\r\n        .from(\"lesson_progress\")\r\n        .select(\"*\", { count: 'exact', head: true })\r\n        .eq(\"user_id\", userId)\r\n        .eq(\"completed\", true);\r\n\r\n    if (count !== 1) return;\r\n\r\n    const { data: profile } = await supabase\r\n        .from(\"profiles\")\r\n        .select(\"referred_by\")\r\n        .eq(\"id\", userId)\r\n        .single();\r\n\r\n    if (!profile?.referred_by) return;\r\n\r\n    const referrerId = profile.referred_by;\r\n    const { data: existing } = await supabase\r\n        .from(\"reward_transactions\")\r\n        .select(\"*\")\r\n        .eq(\"user_id\", referrerId)\r\n        .eq(\"action_type\", 'referral')\r\n        .eq(\"entity_id\", userId)\r\n        .single();\r\n\r\n    if (existing) return;\r\n\r\n    // Award referrer\r\n    await awardCoins(referrerId, 'referral', userId, `Referral bonus for user ${userId}`);\r\n\r\n    // Check Badge for Referrer\r\n    await checkBadgeUnlock(referrerId, 'social_butterfly');\r\n}\r\n\r\n// --- NEW GAMIFICATION FUNCTIONS ---\r\n\r\nexport async function getDailyMissions(userId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Use RPC function to get or create missions\r\n    const { data, error } = await supabase.rpc('get_or_create_daily_missions', {\r\n        p_user_id: userId\r\n    });\r\n\r\n    if (error) {\r\n        console.error(\"Error fetching daily missions:\", error);\r\n        return [];\r\n    }\r\n\r\n    return data || [];\r\n}\r\n\r\n\r\nexport async function updateMissionProgress(userId: string, type: 'login' | 'quiz' | 'video') {\r\n    const supabase = await createClient();\r\n\r\n    // Use RPC function to update mission progress\r\n    const { data, error } = await supabase.rpc('update_mission_progress', {\r\n        p_user_id: userId,\r\n        p_mission_type: type\r\n    });\r\n\r\n    if (error) {\r\n        console.error(\"Error updating mission progress:\", error);\r\n        return;\r\n    }\r\n\r\n    // Check if any mission was completed\r\n    const missions = data || [];\r\n    const completedMission = missions.find((m: any) =>\r\n        m.id === type && m.completed && m.progress === m.goal\r\n    );\r\n\r\n    if (completedMission) {\r\n        // Award mission bonus\r\n        const today = new Date().toISOString().split('T')[0];\r\n        await awardCoins(userId, 'mission_complete', `${today}-${type}`, `Mission Complete: ${completedMission.title}`);\r\n    }\r\n\r\n    revalidatePath(\"/student\");\r\n}\r\n\r\n\r\nexport async function checkBadgeUnlock(userId: string, badgeId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Check if already has badge\r\n    const { data: existing } = await supabase\r\n        .from(\"user_badges\")\r\n        .select(\"*\")\r\n        .eq(\"user_id\", userId)\r\n        .eq(\"badge_id\", badgeId)\r\n        .single();\r\n\r\n    if (existing) return;\r\n\r\n    // Logic to verify if they actually earned it could go here, \r\n    // but usually we call this function when we KNOW they met the condition.\r\n\r\n    await supabase.from(\"user_badges\").insert({\r\n        user_id: userId,\r\n        badge_id: badgeId\r\n    });\r\n\r\n    // Could return a notification object\r\n}\r\n\r\nexport async function getUserBadges(userId: string) {\r\n    const supabase = await createClient();\r\n    const { data } = await supabase\r\n        .from(\"user_badges\")\r\n        .select(\"badge_id, earned_at\")\r\n        .eq(\"user_id\", userId);\r\n    return data || [];\r\n}\r\n\r\nexport async function getStreakHistory(userId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Fetch dates from reward_transactions\r\n    const { data } = await supabase\r\n        .from(\"reward_transactions\")\r\n        .select(\"created_at\")\r\n        .eq(\"user_id\", userId)\r\n        .order(\"created_at\", { ascending: false });\r\n\r\n    if (!data) return [];\r\n\r\n    // Extract unique dates (YYYY-MM-DD)\r\n    const uniqueDates = new Set(\r\n        data.map(item => item.created_at.split('T')[0])\r\n    );\r\n\r\n    return Array.from(uniqueDates);\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;;;;IA6OsB,mBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA"
      }
    },
    {
      "offset": {
        "line": 909,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/app/actions/rewardActions.ts"
        ],
        "sourcesContent": [
          "\"use server\";\r\n\r\nimport { createClient } from \"@/lib/supabase/server\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\ntype ActionType = 'login' | 'video_watch' | 'lesson_completion' | 'quiz_completion' | 'module_completion' | 'referral' | 'bonus' | 'mission_complete';\r\n\r\nconst REWARD_RULES = {\r\n    login: { coins: 5, limit: 1 },\r\n    video_watch: { coins: 10, limit: 10 },\r\n    lesson_completion: { coins: 10, limit: 20 }, // Generic lesson completion\r\n    quiz_completion: { coins: 15, limit: 10 },\r\n    quiz_bonus: { coins: 10, limit: 10 },\r\n    module_completion: { coins: 50, limit: 5 },\r\n    referral: { coins: 100, limit: 10 },\r\n    streak_3: { coins: 10, limit: 1 },\r\n    streak_7: { coins: 30, limit: 1 },\r\n    streak_30: { coins: 100, limit: 1 },\r\n    mission_complete: { coins: 20, limit: 3 }\r\n};\r\n\r\nconst DAILY_COIN_CAP = 100;\r\n\r\nexport async function getRewardStatus(userId: string) {\r\n    const supabase = await createClient();\r\n    let { data } = await supabase\r\n        .from(\"user_rewards\")\r\n        .select(\"*\")\r\n        .eq(\"user_id\", userId)\r\n        .single();\r\n\r\n    if (!data) {\r\n        // Initialize if not exists\r\n        const { data: newData, error } = await supabase\r\n            .from(\"user_rewards\")\r\n            .insert({ user_id: userId })\r\n            .select()\r\n            .single();\r\n\r\n        if (error) {\r\n            if (error.code === '23505') {\r\n                const { data: retryData } = await supabase\r\n                    .from(\"user_rewards\")\r\n                    .select(\"*\")\r\n                    .eq(\"user_id\", userId)\r\n                    .single();\r\n                data = retryData;\r\n            } else {\r\n                console.error(\"Error creating user_rewards in getRewardStatus:\", error);\r\n                return null;\r\n            }\r\n        } else {\r\n            data = newData;\r\n        }\r\n    }\r\n\r\n    return data;\r\n}\r\n\r\nexport async function checkStreak(userId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Just fetch the current status to display to the user\r\n    // The actual update happens when 'login' reward is awarded below\r\n    const { data: rewardStatus } = await supabase\r\n        .from(\"user_rewards\")\r\n        .select(\"current_streak, longest_streak, last_activity_date\")\r\n        .eq(\"user_id\", userId)\r\n        .single();\r\n\r\n    if (!rewardStatus) return { streak: 0, message: null };\r\n\r\n    // We can infer if they are on a streak or if it's broken based on the date,\r\n    // but primarily we just want to show the current value.\r\n    // The DB trigger updates this immediately upon the 'login' transaction insertion.\r\n\r\n    return {\r\n        streak: rewardStatus.current_streak,\r\n        message: null\r\n    };\r\n}\r\n\r\nexport async function awardCoins(\r\n    userId: string,\r\n    action: ActionType,\r\n    entityId?: string,\r\n    description?: string\r\n) {\r\n    const supabase = await createClient();\r\n    const today = new Date().toISOString().split('T')[0];\r\n\r\n    // 1. Check strict duplicate rules (Client-Side Protection)\r\n    // We don't want to spam the DB trigger with 'login' events every refresh\r\n    if (action === 'login') {\r\n        entityId = today; // Force entityId to be date for login\r\n    }\r\n\r\n    if (entityId) {\r\n        const { data: existing } = await supabase\r\n            .from(\"reward_transactions\")\r\n            .select(\"id\")\r\n            .eq(\"user_id\", userId)\r\n            .eq(\"action_type\", action)\r\n            .eq(\"entity_id\", entityId)\r\n            .gte(\"created_at\", `${today}T00:00:00`)\r\n            .single();\r\n\r\n        if (existing) {\r\n            return { success: false, message: \"Already rewarded for this today!\" };\r\n        }\r\n    }\r\n\r\n    // 2. Define Amount (We still define it here to pass to DB, or DB could handle default)\r\n    let coins = 0;\r\n    switch (action) {\r\n        case 'login': coins = REWARD_RULES.login.coins; break;\r\n        case 'video_watch': coins = REWARD_RULES.video_watch.coins; break;\r\n        case 'lesson_completion': coins = REWARD_RULES.lesson_completion.coins; break;\r\n        case 'quiz_completion': coins = REWARD_RULES.quiz_completion.coins; break;\r\n        case 'module_completion': coins = REWARD_RULES.module_completion.coins; break;\r\n        case 'referral': coins = REWARD_RULES.referral.coins; break;\r\n        case 'mission_complete': coins = REWARD_RULES.mission_complete.coins; break;\r\n        case 'bonus': coins = 10; break;\r\n        default: coins = 0;\r\n    }\r\n\r\n    // 3. Insert Transaction (The DB Trigger takes it from here!)\r\n    // It will: Update Coins, XP, Level, and Streak (if login)\r\n    const { error } = await supabase.from(\"reward_transactions\").insert({\r\n        user_id: userId,\r\n        amount: coins,\r\n        action_type: action,\r\n        entity_id: entityId,\r\n        description: description || `Reward for ${action}`\r\n    });\r\n\r\n    if (error) {\r\n        console.error(\"Reward Insert Error:\", error);\r\n        return { success: false, message: \"Failed to process reward.\" };\r\n    }\r\n\r\n    // 4. Post-Process (Optional Notifications or Revalidation)\r\n    revalidatePath(\"/student\");\r\n\r\n    if (action === 'login') {\r\n        // Special message for login\r\n        return { success: true, coins, message: \"Daily Reward Claimed!\" };\r\n    }\r\n\r\n    return { success: true, coins, message: `‚≠ê +${coins} coins!` };\r\n}\r\n\r\nexport async function getLeaderboard(type: 'weekly' | 'all_time' = 'all_time', limit: number = 10) {\r\n    const supabase = await createClient();\r\n\r\n    const sortColumn = type === 'weekly' ? 'weekly_xp' : 'total_coins'; // or xp\r\n\r\n    const { data } = await supabase\r\n        .from(\"user_rewards\")\r\n        .select(`\r\n            total_coins,\r\n            xp,\r\n            weekly_xp,\r\n            level,\r\n            current_streak,\r\n            user_id,\r\n            profiles:user_id (\r\n                full_name,\r\n                avatar_url\r\n            )\r\n        `)\r\n        .order(sortColumn, { ascending: false })\r\n        .limit(limit);\r\n\r\n    return data?.map((entry: any) => ({\r\n        ...entry,\r\n        profiles: Array.isArray(entry.profiles) ? entry.profiles[0] : entry.profiles\r\n    })) || [];\r\n}\r\n\r\nexport async function checkModuleCompletion(userId: string, moduleId: string) {\r\n    const supabase = await createClient();\r\n    const { data: lessons } = await supabase.from(\"lessons\").select(\"id\").eq(\"module_id\", moduleId);\r\n    if (!lessons || lessons.length === 0) return;\r\n\r\n    const { data: completed } = await supabase\r\n        .from(\"lesson_progress\")\r\n        .select(\"lesson_id\")\r\n        .eq(\"user_id\", userId)\r\n        .eq(\"completed\", true)\r\n        .in(\"lesson_id\", lessons.map(l => l.id));\r\n\r\n    const completedCount = completed?.length || 0;\r\n    if (completedCount === lessons.length) {\r\n        return await awardCoins(userId, 'module_completion', moduleId, 'Completed a module!');\r\n    }\r\n    return null;\r\n}\r\n\r\nexport async function checkFirstLessonReward(userId: string) {\r\n    const supabase = await createClient();\r\n    const { count } = await supabase\r\n        .from(\"lesson_progress\")\r\n        .select(\"*\", { count: 'exact', head: true })\r\n        .eq(\"user_id\", userId)\r\n        .eq(\"completed\", true);\r\n\r\n    if (count !== 1) return;\r\n\r\n    const { data: profile } = await supabase\r\n        .from(\"profiles\")\r\n        .select(\"referred_by\")\r\n        .eq(\"id\", userId)\r\n        .single();\r\n\r\n    if (!profile?.referred_by) return;\r\n\r\n    const referrerId = profile.referred_by;\r\n    const { data: existing } = await supabase\r\n        .from(\"reward_transactions\")\r\n        .select(\"*\")\r\n        .eq(\"user_id\", referrerId)\r\n        .eq(\"action_type\", 'referral')\r\n        .eq(\"entity_id\", userId)\r\n        .single();\r\n\r\n    if (existing) return;\r\n\r\n    // Award referrer\r\n    await awardCoins(referrerId, 'referral', userId, `Referral bonus for user ${userId}`);\r\n\r\n    // Check Badge for Referrer\r\n    await checkBadgeUnlock(referrerId, 'social_butterfly');\r\n}\r\n\r\n// --- NEW GAMIFICATION FUNCTIONS ---\r\n\r\nexport async function getDailyMissions(userId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Use RPC function to get or create missions\r\n    const { data, error } = await supabase.rpc('get_or_create_daily_missions', {\r\n        p_user_id: userId\r\n    });\r\n\r\n    if (error) {\r\n        console.error(\"Error fetching daily missions:\", error);\r\n        return [];\r\n    }\r\n\r\n    return data || [];\r\n}\r\n\r\n\r\nexport async function updateMissionProgress(userId: string, type: 'login' | 'quiz' | 'video') {\r\n    const supabase = await createClient();\r\n\r\n    // Use RPC function to update mission progress\r\n    const { data, error } = await supabase.rpc('update_mission_progress', {\r\n        p_user_id: userId,\r\n        p_mission_type: type\r\n    });\r\n\r\n    if (error) {\r\n        console.error(\"Error updating mission progress:\", error);\r\n        return;\r\n    }\r\n\r\n    // Check if any mission was completed\r\n    const missions = data || [];\r\n    const completedMission = missions.find((m: any) =>\r\n        m.id === type && m.completed && m.progress === m.goal\r\n    );\r\n\r\n    if (completedMission) {\r\n        // Award mission bonus\r\n        const today = new Date().toISOString().split('T')[0];\r\n        await awardCoins(userId, 'mission_complete', `${today}-${type}`, `Mission Complete: ${completedMission.title}`);\r\n    }\r\n\r\n    revalidatePath(\"/student\");\r\n}\r\n\r\n\r\nexport async function checkBadgeUnlock(userId: string, badgeId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Check if already has badge\r\n    const { data: existing } = await supabase\r\n        .from(\"user_badges\")\r\n        .select(\"*\")\r\n        .eq(\"user_id\", userId)\r\n        .eq(\"badge_id\", badgeId)\r\n        .single();\r\n\r\n    if (existing) return;\r\n\r\n    // Logic to verify if they actually earned it could go here, \r\n    // but usually we call this function when we KNOW they met the condition.\r\n\r\n    await supabase.from(\"user_badges\").insert({\r\n        user_id: userId,\r\n        badge_id: badgeId\r\n    });\r\n\r\n    // Could return a notification object\r\n}\r\n\r\nexport async function getUserBadges(userId: string) {\r\n    const supabase = await createClient();\r\n    const { data } = await supabase\r\n        .from(\"user_badges\")\r\n        .select(\"badge_id, earned_at\")\r\n        .eq(\"user_id\", userId);\r\n    return data || [];\r\n}\r\n\r\nexport async function getStreakHistory(userId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Fetch dates from reward_transactions\r\n    const { data } = await supabase\r\n        .from(\"reward_transactions\")\r\n        .select(\"created_at\")\r\n        .eq(\"user_id\", userId)\r\n        .order(\"created_at\", { ascending: false });\r\n\r\n    if (!data) return [];\r\n\r\n    // Extract unique dates (YYYY-MM-DD)\r\n    const uniqueDates = new Set(\r\n        data.map(item => item.created_at.split('T')[0])\r\n    );\r\n\r\n    return Array.from(uniqueDates);\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;;;;IAoTsB,gBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA"
      }
    },
    {
      "offset": {
        "line": 924,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/app/actions/rewardActions.ts"
        ],
        "sourcesContent": [
          "\"use server\";\r\n\r\nimport { createClient } from \"@/lib/supabase/server\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\ntype ActionType = 'login' | 'video_watch' | 'lesson_completion' | 'quiz_completion' | 'module_completion' | 'referral' | 'bonus' | 'mission_complete';\r\n\r\nconst REWARD_RULES = {\r\n    login: { coins: 5, limit: 1 },\r\n    video_watch: { coins: 10, limit: 10 },\r\n    lesson_completion: { coins: 10, limit: 20 }, // Generic lesson completion\r\n    quiz_completion: { coins: 15, limit: 10 },\r\n    quiz_bonus: { coins: 10, limit: 10 },\r\n    module_completion: { coins: 50, limit: 5 },\r\n    referral: { coins: 100, limit: 10 },\r\n    streak_3: { coins: 10, limit: 1 },\r\n    streak_7: { coins: 30, limit: 1 },\r\n    streak_30: { coins: 100, limit: 1 },\r\n    mission_complete: { coins: 20, limit: 3 }\r\n};\r\n\r\nconst DAILY_COIN_CAP = 100;\r\n\r\nexport async function getRewardStatus(userId: string) {\r\n    const supabase = await createClient();\r\n    let { data } = await supabase\r\n        .from(\"user_rewards\")\r\n        .select(\"*\")\r\n        .eq(\"user_id\", userId)\r\n        .single();\r\n\r\n    if (!data) {\r\n        // Initialize if not exists\r\n        const { data: newData, error } = await supabase\r\n            .from(\"user_rewards\")\r\n            .insert({ user_id: userId })\r\n            .select()\r\n            .single();\r\n\r\n        if (error) {\r\n            if (error.code === '23505') {\r\n                const { data: retryData } = await supabase\r\n                    .from(\"user_rewards\")\r\n                    .select(\"*\")\r\n                    .eq(\"user_id\", userId)\r\n                    .single();\r\n                data = retryData;\r\n            } else {\r\n                console.error(\"Error creating user_rewards in getRewardStatus:\", error);\r\n                return null;\r\n            }\r\n        } else {\r\n            data = newData;\r\n        }\r\n    }\r\n\r\n    return data;\r\n}\r\n\r\nexport async function checkStreak(userId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Just fetch the current status to display to the user\r\n    // The actual update happens when 'login' reward is awarded below\r\n    const { data: rewardStatus } = await supabase\r\n        .from(\"user_rewards\")\r\n        .select(\"current_streak, longest_streak, last_activity_date\")\r\n        .eq(\"user_id\", userId)\r\n        .single();\r\n\r\n    if (!rewardStatus) return { streak: 0, message: null };\r\n\r\n    // We can infer if they are on a streak or if it's broken based on the date,\r\n    // but primarily we just want to show the current value.\r\n    // The DB trigger updates this immediately upon the 'login' transaction insertion.\r\n\r\n    return {\r\n        streak: rewardStatus.current_streak,\r\n        message: null\r\n    };\r\n}\r\n\r\nexport async function awardCoins(\r\n    userId: string,\r\n    action: ActionType,\r\n    entityId?: string,\r\n    description?: string\r\n) {\r\n    const supabase = await createClient();\r\n    const today = new Date().toISOString().split('T')[0];\r\n\r\n    // 1. Check strict duplicate rules (Client-Side Protection)\r\n    // We don't want to spam the DB trigger with 'login' events every refresh\r\n    if (action === 'login') {\r\n        entityId = today; // Force entityId to be date for login\r\n    }\r\n\r\n    if (entityId) {\r\n        const { data: existing } = await supabase\r\n            .from(\"reward_transactions\")\r\n            .select(\"id\")\r\n            .eq(\"user_id\", userId)\r\n            .eq(\"action_type\", action)\r\n            .eq(\"entity_id\", entityId)\r\n            .gte(\"created_at\", `${today}T00:00:00`)\r\n            .single();\r\n\r\n        if (existing) {\r\n            return { success: false, message: \"Already rewarded for this today!\" };\r\n        }\r\n    }\r\n\r\n    // 2. Define Amount (We still define it here to pass to DB, or DB could handle default)\r\n    let coins = 0;\r\n    switch (action) {\r\n        case 'login': coins = REWARD_RULES.login.coins; break;\r\n        case 'video_watch': coins = REWARD_RULES.video_watch.coins; break;\r\n        case 'lesson_completion': coins = REWARD_RULES.lesson_completion.coins; break;\r\n        case 'quiz_completion': coins = REWARD_RULES.quiz_completion.coins; break;\r\n        case 'module_completion': coins = REWARD_RULES.module_completion.coins; break;\r\n        case 'referral': coins = REWARD_RULES.referral.coins; break;\r\n        case 'mission_complete': coins = REWARD_RULES.mission_complete.coins; break;\r\n        case 'bonus': coins = 10; break;\r\n        default: coins = 0;\r\n    }\r\n\r\n    // 3. Insert Transaction (The DB Trigger takes it from here!)\r\n    // It will: Update Coins, XP, Level, and Streak (if login)\r\n    const { error } = await supabase.from(\"reward_transactions\").insert({\r\n        user_id: userId,\r\n        amount: coins,\r\n        action_type: action,\r\n        entity_id: entityId,\r\n        description: description || `Reward for ${action}`\r\n    });\r\n\r\n    if (error) {\r\n        console.error(\"Reward Insert Error:\", error);\r\n        return { success: false, message: \"Failed to process reward.\" };\r\n    }\r\n\r\n    // 4. Post-Process (Optional Notifications or Revalidation)\r\n    revalidatePath(\"/student\");\r\n\r\n    if (action === 'login') {\r\n        // Special message for login\r\n        return { success: true, coins, message: \"Daily Reward Claimed!\" };\r\n    }\r\n\r\n    return { success: true, coins, message: `‚≠ê +${coins} coins!` };\r\n}\r\n\r\nexport async function getLeaderboard(type: 'weekly' | 'all_time' = 'all_time', limit: number = 10) {\r\n    const supabase = await createClient();\r\n\r\n    const sortColumn = type === 'weekly' ? 'weekly_xp' : 'total_coins'; // or xp\r\n\r\n    const { data } = await supabase\r\n        .from(\"user_rewards\")\r\n        .select(`\r\n            total_coins,\r\n            xp,\r\n            weekly_xp,\r\n            level,\r\n            current_streak,\r\n            user_id,\r\n            profiles:user_id (\r\n                full_name,\r\n                avatar_url\r\n            )\r\n        `)\r\n        .order(sortColumn, { ascending: false })\r\n        .limit(limit);\r\n\r\n    return data?.map((entry: any) => ({\r\n        ...entry,\r\n        profiles: Array.isArray(entry.profiles) ? entry.profiles[0] : entry.profiles\r\n    })) || [];\r\n}\r\n\r\nexport async function checkModuleCompletion(userId: string, moduleId: string) {\r\n    const supabase = await createClient();\r\n    const { data: lessons } = await supabase.from(\"lessons\").select(\"id\").eq(\"module_id\", moduleId);\r\n    if (!lessons || lessons.length === 0) return;\r\n\r\n    const { data: completed } = await supabase\r\n        .from(\"lesson_progress\")\r\n        .select(\"lesson_id\")\r\n        .eq(\"user_id\", userId)\r\n        .eq(\"completed\", true)\r\n        .in(\"lesson_id\", lessons.map(l => l.id));\r\n\r\n    const completedCount = completed?.length || 0;\r\n    if (completedCount === lessons.length) {\r\n        return await awardCoins(userId, 'module_completion', moduleId, 'Completed a module!');\r\n    }\r\n    return null;\r\n}\r\n\r\nexport async function checkFirstLessonReward(userId: string) {\r\n    const supabase = await createClient();\r\n    const { count } = await supabase\r\n        .from(\"lesson_progress\")\r\n        .select(\"*\", { count: 'exact', head: true })\r\n        .eq(\"user_id\", userId)\r\n        .eq(\"completed\", true);\r\n\r\n    if (count !== 1) return;\r\n\r\n    const { data: profile } = await supabase\r\n        .from(\"profiles\")\r\n        .select(\"referred_by\")\r\n        .eq(\"id\", userId)\r\n        .single();\r\n\r\n    if (!profile?.referred_by) return;\r\n\r\n    const referrerId = profile.referred_by;\r\n    const { data: existing } = await supabase\r\n        .from(\"reward_transactions\")\r\n        .select(\"*\")\r\n        .eq(\"user_id\", referrerId)\r\n        .eq(\"action_type\", 'referral')\r\n        .eq(\"entity_id\", userId)\r\n        .single();\r\n\r\n    if (existing) return;\r\n\r\n    // Award referrer\r\n    await awardCoins(referrerId, 'referral', userId, `Referral bonus for user ${userId}`);\r\n\r\n    // Check Badge for Referrer\r\n    await checkBadgeUnlock(referrerId, 'social_butterfly');\r\n}\r\n\r\n// --- NEW GAMIFICATION FUNCTIONS ---\r\n\r\nexport async function getDailyMissions(userId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Use RPC function to get or create missions\r\n    const { data, error } = await supabase.rpc('get_or_create_daily_missions', {\r\n        p_user_id: userId\r\n    });\r\n\r\n    if (error) {\r\n        console.error(\"Error fetching daily missions:\", error);\r\n        return [];\r\n    }\r\n\r\n    return data || [];\r\n}\r\n\r\n\r\nexport async function updateMissionProgress(userId: string, type: 'login' | 'quiz' | 'video') {\r\n    const supabase = await createClient();\r\n\r\n    // Use RPC function to update mission progress\r\n    const { data, error } = await supabase.rpc('update_mission_progress', {\r\n        p_user_id: userId,\r\n        p_mission_type: type\r\n    });\r\n\r\n    if (error) {\r\n        console.error(\"Error updating mission progress:\", error);\r\n        return;\r\n    }\r\n\r\n    // Check if any mission was completed\r\n    const missions = data || [];\r\n    const completedMission = missions.find((m: any) =>\r\n        m.id === type && m.completed && m.progress === m.goal\r\n    );\r\n\r\n    if (completedMission) {\r\n        // Award mission bonus\r\n        const today = new Date().toISOString().split('T')[0];\r\n        await awardCoins(userId, 'mission_complete', `${today}-${type}`, `Mission Complete: ${completedMission.title}`);\r\n    }\r\n\r\n    revalidatePath(\"/student\");\r\n}\r\n\r\n\r\nexport async function checkBadgeUnlock(userId: string, badgeId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Check if already has badge\r\n    const { data: existing } = await supabase\r\n        .from(\"user_badges\")\r\n        .select(\"*\")\r\n        .eq(\"user_id\", userId)\r\n        .eq(\"badge_id\", badgeId)\r\n        .single();\r\n\r\n    if (existing) return;\r\n\r\n    // Logic to verify if they actually earned it could go here, \r\n    // but usually we call this function when we KNOW they met the condition.\r\n\r\n    await supabase.from(\"user_badges\").insert({\r\n        user_id: userId,\r\n        badge_id: badgeId\r\n    });\r\n\r\n    // Could return a notification object\r\n}\r\n\r\nexport async function getUserBadges(userId: string) {\r\n    const supabase = await createClient();\r\n    const { data } = await supabase\r\n        .from(\"user_badges\")\r\n        .select(\"badge_id, earned_at\")\r\n        .eq(\"user_id\", userId);\r\n    return data || [];\r\n}\r\n\r\nexport async function getStreakHistory(userId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Fetch dates from reward_transactions\r\n    const { data } = await supabase\r\n        .from(\"reward_transactions\")\r\n        .select(\"created_at\")\r\n        .eq(\"user_id\", userId)\r\n        .order(\"created_at\", { ascending: false });\r\n\r\n    if (!data) return [];\r\n\r\n    // Extract unique dates (YYYY-MM-DD)\r\n    const uniqueDates = new Set(\r\n        data.map(item => item.created_at.split('T')[0])\r\n    );\r\n\r\n    return Array.from(uniqueDates);\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;;;;IAwJsB,iBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA"
      }
    },
    {
      "offset": {
        "line": 939,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/app/actions/rewardActions.ts"
        ],
        "sourcesContent": [
          "\"use server\";\r\n\r\nimport { createClient } from \"@/lib/supabase/server\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\ntype ActionType = 'login' | 'video_watch' | 'lesson_completion' | 'quiz_completion' | 'module_completion' | 'referral' | 'bonus' | 'mission_complete';\r\n\r\nconst REWARD_RULES = {\r\n    login: { coins: 5, limit: 1 },\r\n    video_watch: { coins: 10, limit: 10 },\r\n    lesson_completion: { coins: 10, limit: 20 }, // Generic lesson completion\r\n    quiz_completion: { coins: 15, limit: 10 },\r\n    quiz_bonus: { coins: 10, limit: 10 },\r\n    module_completion: { coins: 50, limit: 5 },\r\n    referral: { coins: 100, limit: 10 },\r\n    streak_3: { coins: 10, limit: 1 },\r\n    streak_7: { coins: 30, limit: 1 },\r\n    streak_30: { coins: 100, limit: 1 },\r\n    mission_complete: { coins: 20, limit: 3 }\r\n};\r\n\r\nconst DAILY_COIN_CAP = 100;\r\n\r\nexport async function getRewardStatus(userId: string) {\r\n    const supabase = await createClient();\r\n    let { data } = await supabase\r\n        .from(\"user_rewards\")\r\n        .select(\"*\")\r\n        .eq(\"user_id\", userId)\r\n        .single();\r\n\r\n    if (!data) {\r\n        // Initialize if not exists\r\n        const { data: newData, error } = await supabase\r\n            .from(\"user_rewards\")\r\n            .insert({ user_id: userId })\r\n            .select()\r\n            .single();\r\n\r\n        if (error) {\r\n            if (error.code === '23505') {\r\n                const { data: retryData } = await supabase\r\n                    .from(\"user_rewards\")\r\n                    .select(\"*\")\r\n                    .eq(\"user_id\", userId)\r\n                    .single();\r\n                data = retryData;\r\n            } else {\r\n                console.error(\"Error creating user_rewards in getRewardStatus:\", error);\r\n                return null;\r\n            }\r\n        } else {\r\n            data = newData;\r\n        }\r\n    }\r\n\r\n    return data;\r\n}\r\n\r\nexport async function checkStreak(userId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Just fetch the current status to display to the user\r\n    // The actual update happens when 'login' reward is awarded below\r\n    const { data: rewardStatus } = await supabase\r\n        .from(\"user_rewards\")\r\n        .select(\"current_streak, longest_streak, last_activity_date\")\r\n        .eq(\"user_id\", userId)\r\n        .single();\r\n\r\n    if (!rewardStatus) return { streak: 0, message: null };\r\n\r\n    // We can infer if they are on a streak or if it's broken based on the date,\r\n    // but primarily we just want to show the current value.\r\n    // The DB trigger updates this immediately upon the 'login' transaction insertion.\r\n\r\n    return {\r\n        streak: rewardStatus.current_streak,\r\n        message: null\r\n    };\r\n}\r\n\r\nexport async function awardCoins(\r\n    userId: string,\r\n    action: ActionType,\r\n    entityId?: string,\r\n    description?: string\r\n) {\r\n    const supabase = await createClient();\r\n    const today = new Date().toISOString().split('T')[0];\r\n\r\n    // 1. Check strict duplicate rules (Client-Side Protection)\r\n    // We don't want to spam the DB trigger with 'login' events every refresh\r\n    if (action === 'login') {\r\n        entityId = today; // Force entityId to be date for login\r\n    }\r\n\r\n    if (entityId) {\r\n        const { data: existing } = await supabase\r\n            .from(\"reward_transactions\")\r\n            .select(\"id\")\r\n            .eq(\"user_id\", userId)\r\n            .eq(\"action_type\", action)\r\n            .eq(\"entity_id\", entityId)\r\n            .gte(\"created_at\", `${today}T00:00:00`)\r\n            .single();\r\n\r\n        if (existing) {\r\n            return { success: false, message: \"Already rewarded for this today!\" };\r\n        }\r\n    }\r\n\r\n    // 2. Define Amount (We still define it here to pass to DB, or DB could handle default)\r\n    let coins = 0;\r\n    switch (action) {\r\n        case 'login': coins = REWARD_RULES.login.coins; break;\r\n        case 'video_watch': coins = REWARD_RULES.video_watch.coins; break;\r\n        case 'lesson_completion': coins = REWARD_RULES.lesson_completion.coins; break;\r\n        case 'quiz_completion': coins = REWARD_RULES.quiz_completion.coins; break;\r\n        case 'module_completion': coins = REWARD_RULES.module_completion.coins; break;\r\n        case 'referral': coins = REWARD_RULES.referral.coins; break;\r\n        case 'mission_complete': coins = REWARD_RULES.mission_complete.coins; break;\r\n        case 'bonus': coins = 10; break;\r\n        default: coins = 0;\r\n    }\r\n\r\n    // 3. Insert Transaction (The DB Trigger takes it from here!)\r\n    // It will: Update Coins, XP, Level, and Streak (if login)\r\n    const { error } = await supabase.from(\"reward_transactions\").insert({\r\n        user_id: userId,\r\n        amount: coins,\r\n        action_type: action,\r\n        entity_id: entityId,\r\n        description: description || `Reward for ${action}`\r\n    });\r\n\r\n    if (error) {\r\n        console.error(\"Reward Insert Error:\", error);\r\n        return { success: false, message: \"Failed to process reward.\" };\r\n    }\r\n\r\n    // 4. Post-Process (Optional Notifications or Revalidation)\r\n    revalidatePath(\"/student\");\r\n\r\n    if (action === 'login') {\r\n        // Special message for login\r\n        return { success: true, coins, message: \"Daily Reward Claimed!\" };\r\n    }\r\n\r\n    return { success: true, coins, message: `‚≠ê +${coins} coins!` };\r\n}\r\n\r\nexport async function getLeaderboard(type: 'weekly' | 'all_time' = 'all_time', limit: number = 10) {\r\n    const supabase = await createClient();\r\n\r\n    const sortColumn = type === 'weekly' ? 'weekly_xp' : 'total_coins'; // or xp\r\n\r\n    const { data } = await supabase\r\n        .from(\"user_rewards\")\r\n        .select(`\r\n            total_coins,\r\n            xp,\r\n            weekly_xp,\r\n            level,\r\n            current_streak,\r\n            user_id,\r\n            profiles:user_id (\r\n                full_name,\r\n                avatar_url\r\n            )\r\n        `)\r\n        .order(sortColumn, { ascending: false })\r\n        .limit(limit);\r\n\r\n    return data?.map((entry: any) => ({\r\n        ...entry,\r\n        profiles: Array.isArray(entry.profiles) ? entry.profiles[0] : entry.profiles\r\n    })) || [];\r\n}\r\n\r\nexport async function checkModuleCompletion(userId: string, moduleId: string) {\r\n    const supabase = await createClient();\r\n    const { data: lessons } = await supabase.from(\"lessons\").select(\"id\").eq(\"module_id\", moduleId);\r\n    if (!lessons || lessons.length === 0) return;\r\n\r\n    const { data: completed } = await supabase\r\n        .from(\"lesson_progress\")\r\n        .select(\"lesson_id\")\r\n        .eq(\"user_id\", userId)\r\n        .eq(\"completed\", true)\r\n        .in(\"lesson_id\", lessons.map(l => l.id));\r\n\r\n    const completedCount = completed?.length || 0;\r\n    if (completedCount === lessons.length) {\r\n        return await awardCoins(userId, 'module_completion', moduleId, 'Completed a module!');\r\n    }\r\n    return null;\r\n}\r\n\r\nexport async function checkFirstLessonReward(userId: string) {\r\n    const supabase = await createClient();\r\n    const { count } = await supabase\r\n        .from(\"lesson_progress\")\r\n        .select(\"*\", { count: 'exact', head: true })\r\n        .eq(\"user_id\", userId)\r\n        .eq(\"completed\", true);\r\n\r\n    if (count !== 1) return;\r\n\r\n    const { data: profile } = await supabase\r\n        .from(\"profiles\")\r\n        .select(\"referred_by\")\r\n        .eq(\"id\", userId)\r\n        .single();\r\n\r\n    if (!profile?.referred_by) return;\r\n\r\n    const referrerId = profile.referred_by;\r\n    const { data: existing } = await supabase\r\n        .from(\"reward_transactions\")\r\n        .select(\"*\")\r\n        .eq(\"user_id\", referrerId)\r\n        .eq(\"action_type\", 'referral')\r\n        .eq(\"entity_id\", userId)\r\n        .single();\r\n\r\n    if (existing) return;\r\n\r\n    // Award referrer\r\n    await awardCoins(referrerId, 'referral', userId, `Referral bonus for user ${userId}`);\r\n\r\n    // Check Badge for Referrer\r\n    await checkBadgeUnlock(referrerId, 'social_butterfly');\r\n}\r\n\r\n// --- NEW GAMIFICATION FUNCTIONS ---\r\n\r\nexport async function getDailyMissions(userId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Use RPC function to get or create missions\r\n    const { data, error } = await supabase.rpc('get_or_create_daily_missions', {\r\n        p_user_id: userId\r\n    });\r\n\r\n    if (error) {\r\n        console.error(\"Error fetching daily missions:\", error);\r\n        return [];\r\n    }\r\n\r\n    return data || [];\r\n}\r\n\r\n\r\nexport async function updateMissionProgress(userId: string, type: 'login' | 'quiz' | 'video') {\r\n    const supabase = await createClient();\r\n\r\n    // Use RPC function to update mission progress\r\n    const { data, error } = await supabase.rpc('update_mission_progress', {\r\n        p_user_id: userId,\r\n        p_mission_type: type\r\n    });\r\n\r\n    if (error) {\r\n        console.error(\"Error updating mission progress:\", error);\r\n        return;\r\n    }\r\n\r\n    // Check if any mission was completed\r\n    const missions = data || [];\r\n    const completedMission = missions.find((m: any) =>\r\n        m.id === type && m.completed && m.progress === m.goal\r\n    );\r\n\r\n    if (completedMission) {\r\n        // Award mission bonus\r\n        const today = new Date().toISOString().split('T')[0];\r\n        await awardCoins(userId, 'mission_complete', `${today}-${type}`, `Mission Complete: ${completedMission.title}`);\r\n    }\r\n\r\n    revalidatePath(\"/student\");\r\n}\r\n\r\n\r\nexport async function checkBadgeUnlock(userId: string, badgeId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Check if already has badge\r\n    const { data: existing } = await supabase\r\n        .from(\"user_badges\")\r\n        .select(\"*\")\r\n        .eq(\"user_id\", userId)\r\n        .eq(\"badge_id\", badgeId)\r\n        .single();\r\n\r\n    if (existing) return;\r\n\r\n    // Logic to verify if they actually earned it could go here, \r\n    // but usually we call this function when we KNOW they met the condition.\r\n\r\n    await supabase.from(\"user_badges\").insert({\r\n        user_id: userId,\r\n        badge_id: badgeId\r\n    });\r\n\r\n    // Could return a notification object\r\n}\r\n\r\nexport async function getUserBadges(userId: string) {\r\n    const supabase = await createClient();\r\n    const { data } = await supabase\r\n        .from(\"user_badges\")\r\n        .select(\"badge_id, earned_at\")\r\n        .eq(\"user_id\", userId);\r\n    return data || [];\r\n}\r\n\r\nexport async function getStreakHistory(userId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Fetch dates from reward_transactions\r\n    const { data } = await supabase\r\n        .from(\"reward_transactions\")\r\n        .select(\"created_at\")\r\n        .eq(\"user_id\", userId)\r\n        .order(\"created_at\", { ascending: false });\r\n\r\n    if (!data) return [];\r\n\r\n    // Extract unique dates (YYYY-MM-DD)\r\n    const uniqueDates = new Set(\r\n        data.map(item => item.created_at.split('T')[0])\r\n    );\r\n\r\n    return Array.from(uniqueDates);\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;;;;IA2DsB,cAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA"
      }
    },
    {
      "offset": {
        "line": 954,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/app/actions/rewardActions.ts"
        ],
        "sourcesContent": [
          "\"use server\";\r\n\r\nimport { createClient } from \"@/lib/supabase/server\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\ntype ActionType = 'login' | 'video_watch' | 'lesson_completion' | 'quiz_completion' | 'module_completion' | 'referral' | 'bonus' | 'mission_complete';\r\n\r\nconst REWARD_RULES = {\r\n    login: { coins: 5, limit: 1 },\r\n    video_watch: { coins: 10, limit: 10 },\r\n    lesson_completion: { coins: 10, limit: 20 }, // Generic lesson completion\r\n    quiz_completion: { coins: 15, limit: 10 },\r\n    quiz_bonus: { coins: 10, limit: 10 },\r\n    module_completion: { coins: 50, limit: 5 },\r\n    referral: { coins: 100, limit: 10 },\r\n    streak_3: { coins: 10, limit: 1 },\r\n    streak_7: { coins: 30, limit: 1 },\r\n    streak_30: { coins: 100, limit: 1 },\r\n    mission_complete: { coins: 20, limit: 3 }\r\n};\r\n\r\nconst DAILY_COIN_CAP = 100;\r\n\r\nexport async function getRewardStatus(userId: string) {\r\n    const supabase = await createClient();\r\n    let { data } = await supabase\r\n        .from(\"user_rewards\")\r\n        .select(\"*\")\r\n        .eq(\"user_id\", userId)\r\n        .single();\r\n\r\n    if (!data) {\r\n        // Initialize if not exists\r\n        const { data: newData, error } = await supabase\r\n            .from(\"user_rewards\")\r\n            .insert({ user_id: userId })\r\n            .select()\r\n            .single();\r\n\r\n        if (error) {\r\n            if (error.code === '23505') {\r\n                const { data: retryData } = await supabase\r\n                    .from(\"user_rewards\")\r\n                    .select(\"*\")\r\n                    .eq(\"user_id\", userId)\r\n                    .single();\r\n                data = retryData;\r\n            } else {\r\n                console.error(\"Error creating user_rewards in getRewardStatus:\", error);\r\n                return null;\r\n            }\r\n        } else {\r\n            data = newData;\r\n        }\r\n    }\r\n\r\n    return data;\r\n}\r\n\r\nexport async function checkStreak(userId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Just fetch the current status to display to the user\r\n    // The actual update happens when 'login' reward is awarded below\r\n    const { data: rewardStatus } = await supabase\r\n        .from(\"user_rewards\")\r\n        .select(\"current_streak, longest_streak, last_activity_date\")\r\n        .eq(\"user_id\", userId)\r\n        .single();\r\n\r\n    if (!rewardStatus) return { streak: 0, message: null };\r\n\r\n    // We can infer if they are on a streak or if it's broken based on the date,\r\n    // but primarily we just want to show the current value.\r\n    // The DB trigger updates this immediately upon the 'login' transaction insertion.\r\n\r\n    return {\r\n        streak: rewardStatus.current_streak,\r\n        message: null\r\n    };\r\n}\r\n\r\nexport async function awardCoins(\r\n    userId: string,\r\n    action: ActionType,\r\n    entityId?: string,\r\n    description?: string\r\n) {\r\n    const supabase = await createClient();\r\n    const today = new Date().toISOString().split('T')[0];\r\n\r\n    // 1. Check strict duplicate rules (Client-Side Protection)\r\n    // We don't want to spam the DB trigger with 'login' events every refresh\r\n    if (action === 'login') {\r\n        entityId = today; // Force entityId to be date for login\r\n    }\r\n\r\n    if (entityId) {\r\n        const { data: existing } = await supabase\r\n            .from(\"reward_transactions\")\r\n            .select(\"id\")\r\n            .eq(\"user_id\", userId)\r\n            .eq(\"action_type\", action)\r\n            .eq(\"entity_id\", entityId)\r\n            .gte(\"created_at\", `${today}T00:00:00`)\r\n            .single();\r\n\r\n        if (existing) {\r\n            return { success: false, message: \"Already rewarded for this today!\" };\r\n        }\r\n    }\r\n\r\n    // 2. Define Amount (We still define it here to pass to DB, or DB could handle default)\r\n    let coins = 0;\r\n    switch (action) {\r\n        case 'login': coins = REWARD_RULES.login.coins; break;\r\n        case 'video_watch': coins = REWARD_RULES.video_watch.coins; break;\r\n        case 'lesson_completion': coins = REWARD_RULES.lesson_completion.coins; break;\r\n        case 'quiz_completion': coins = REWARD_RULES.quiz_completion.coins; break;\r\n        case 'module_completion': coins = REWARD_RULES.module_completion.coins; break;\r\n        case 'referral': coins = REWARD_RULES.referral.coins; break;\r\n        case 'mission_complete': coins = REWARD_RULES.mission_complete.coins; break;\r\n        case 'bonus': coins = 10; break;\r\n        default: coins = 0;\r\n    }\r\n\r\n    // 3. Insert Transaction (The DB Trigger takes it from here!)\r\n    // It will: Update Coins, XP, Level, and Streak (if login)\r\n    const { error } = await supabase.from(\"reward_transactions\").insert({\r\n        user_id: userId,\r\n        amount: coins,\r\n        action_type: action,\r\n        entity_id: entityId,\r\n        description: description || `Reward for ${action}`\r\n    });\r\n\r\n    if (error) {\r\n        console.error(\"Reward Insert Error:\", error);\r\n        return { success: false, message: \"Failed to process reward.\" };\r\n    }\r\n\r\n    // 4. Post-Process (Optional Notifications or Revalidation)\r\n    revalidatePath(\"/student\");\r\n\r\n    if (action === 'login') {\r\n        // Special message for login\r\n        return { success: true, coins, message: \"Daily Reward Claimed!\" };\r\n    }\r\n\r\n    return { success: true, coins, message: `‚≠ê +${coins} coins!` };\r\n}\r\n\r\nexport async function getLeaderboard(type: 'weekly' | 'all_time' = 'all_time', limit: number = 10) {\r\n    const supabase = await createClient();\r\n\r\n    const sortColumn = type === 'weekly' ? 'weekly_xp' : 'total_coins'; // or xp\r\n\r\n    const { data } = await supabase\r\n        .from(\"user_rewards\")\r\n        .select(`\r\n            total_coins,\r\n            xp,\r\n            weekly_xp,\r\n            level,\r\n            current_streak,\r\n            user_id,\r\n            profiles:user_id (\r\n                full_name,\r\n                avatar_url\r\n            )\r\n        `)\r\n        .order(sortColumn, { ascending: false })\r\n        .limit(limit);\r\n\r\n    return data?.map((entry: any) => ({\r\n        ...entry,\r\n        profiles: Array.isArray(entry.profiles) ? entry.profiles[0] : entry.profiles\r\n    })) || [];\r\n}\r\n\r\nexport async function checkModuleCompletion(userId: string, moduleId: string) {\r\n    const supabase = await createClient();\r\n    const { data: lessons } = await supabase.from(\"lessons\").select(\"id\").eq(\"module_id\", moduleId);\r\n    if (!lessons || lessons.length === 0) return;\r\n\r\n    const { data: completed } = await supabase\r\n        .from(\"lesson_progress\")\r\n        .select(\"lesson_id\")\r\n        .eq(\"user_id\", userId)\r\n        .eq(\"completed\", true)\r\n        .in(\"lesson_id\", lessons.map(l => l.id));\r\n\r\n    const completedCount = completed?.length || 0;\r\n    if (completedCount === lessons.length) {\r\n        return await awardCoins(userId, 'module_completion', moduleId, 'Completed a module!');\r\n    }\r\n    return null;\r\n}\r\n\r\nexport async function checkFirstLessonReward(userId: string) {\r\n    const supabase = await createClient();\r\n    const { count } = await supabase\r\n        .from(\"lesson_progress\")\r\n        .select(\"*\", { count: 'exact', head: true })\r\n        .eq(\"user_id\", userId)\r\n        .eq(\"completed\", true);\r\n\r\n    if (count !== 1) return;\r\n\r\n    const { data: profile } = await supabase\r\n        .from(\"profiles\")\r\n        .select(\"referred_by\")\r\n        .eq(\"id\", userId)\r\n        .single();\r\n\r\n    if (!profile?.referred_by) return;\r\n\r\n    const referrerId = profile.referred_by;\r\n    const { data: existing } = await supabase\r\n        .from(\"reward_transactions\")\r\n        .select(\"*\")\r\n        .eq(\"user_id\", referrerId)\r\n        .eq(\"action_type\", 'referral')\r\n        .eq(\"entity_id\", userId)\r\n        .single();\r\n\r\n    if (existing) return;\r\n\r\n    // Award referrer\r\n    await awardCoins(referrerId, 'referral', userId, `Referral bonus for user ${userId}`);\r\n\r\n    // Check Badge for Referrer\r\n    await checkBadgeUnlock(referrerId, 'social_butterfly');\r\n}\r\n\r\n// --- NEW GAMIFICATION FUNCTIONS ---\r\n\r\nexport async function getDailyMissions(userId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Use RPC function to get or create missions\r\n    const { data, error } = await supabase.rpc('get_or_create_daily_missions', {\r\n        p_user_id: userId\r\n    });\r\n\r\n    if (error) {\r\n        console.error(\"Error fetching daily missions:\", error);\r\n        return [];\r\n    }\r\n\r\n    return data || [];\r\n}\r\n\r\n\r\nexport async function updateMissionProgress(userId: string, type: 'login' | 'quiz' | 'video') {\r\n    const supabase = await createClient();\r\n\r\n    // Use RPC function to update mission progress\r\n    const { data, error } = await supabase.rpc('update_mission_progress', {\r\n        p_user_id: userId,\r\n        p_mission_type: type\r\n    });\r\n\r\n    if (error) {\r\n        console.error(\"Error updating mission progress:\", error);\r\n        return;\r\n    }\r\n\r\n    // Check if any mission was completed\r\n    const missions = data || [];\r\n    const completedMission = missions.find((m: any) =>\r\n        m.id === type && m.completed && m.progress === m.goal\r\n    );\r\n\r\n    if (completedMission) {\r\n        // Award mission bonus\r\n        const today = new Date().toISOString().split('T')[0];\r\n        await awardCoins(userId, 'mission_complete', `${today}-${type}`, `Mission Complete: ${completedMission.title}`);\r\n    }\r\n\r\n    revalidatePath(\"/student\");\r\n}\r\n\r\n\r\nexport async function checkBadgeUnlock(userId: string, badgeId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Check if already has badge\r\n    const { data: existing } = await supabase\r\n        .from(\"user_badges\")\r\n        .select(\"*\")\r\n        .eq(\"user_id\", userId)\r\n        .eq(\"badge_id\", badgeId)\r\n        .single();\r\n\r\n    if (existing) return;\r\n\r\n    // Logic to verify if they actually earned it could go here, \r\n    // but usually we call this function when we KNOW they met the condition.\r\n\r\n    await supabase.from(\"user_badges\").insert({\r\n        user_id: userId,\r\n        badge_id: badgeId\r\n    });\r\n\r\n    // Could return a notification object\r\n}\r\n\r\nexport async function getUserBadges(userId: string) {\r\n    const supabase = await createClient();\r\n    const { data } = await supabase\r\n        .from(\"user_badges\")\r\n        .select(\"badge_id, earned_at\")\r\n        .eq(\"user_id\", userId);\r\n    return data || [];\r\n}\r\n\r\nexport async function getStreakHistory(userId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // Fetch dates from reward_transactions\r\n    const { data } = await supabase\r\n        .from(\"reward_transactions\")\r\n        .select(\"created_at\")\r\n        .eq(\"user_id\", userId)\r\n        .order(\"created_at\", { ascending: false });\r\n\r\n    if (!data) return [];\r\n\r\n    // Extract unique dates (YYYY-MM-DD)\r\n    const uniqueDates = new Set(\r\n        data.map(item => item.created_at.split('T')[0])\r\n    );\r\n\r\n    return Array.from(uniqueDates);\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;;;;IA6TsB,mBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA"
      }
    },
    {
      "offset": {
        "line": 969,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/hooks/useRewards.ts"
        ],
        "sourcesContent": [
          "\"use client\";\r\n\r\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\r\nimport {\r\n    getRewardStatus,\r\n    getDailyMissions,\r\n    getUserBadges,\r\n    getLeaderboard,\r\n    awardCoins,\r\n    checkStreak,\r\n    getStreakHistory\r\n} from \"@/app/actions/rewardActions\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\n\r\n// Keys for React Query\r\nexport const REWARD_KEYS = {\r\n    all: [\"rewards\"] as const,\r\n    status: (userId: string) => [...REWARD_KEYS.all, \"status\", userId] as const,\r\n    missions: (userId: string) => [...REWARD_KEYS.all, \"missions\", userId] as const,\r\n    badges: (userId: string) => [...REWARD_KEYS.all, \"badges\", userId] as const,\r\n    leaderboard: (type: string) => [...REWARD_KEYS.all, \"leaderboard\", type] as const,\r\n    transactions: (userId: string) => [...REWARD_KEYS.all, \"transactions\", userId] as const,\r\n    streakHistory: (userId: string) => [...REWARD_KEYS.all, \"streakHistory\", userId] as const,\r\n};\r\n\r\nexport function useRewards(userId?: string) {\r\n    const queryClient = useQueryClient();\r\n\r\n    // 1. Reward Status (Coins, Streak, XP)\r\n    const { data: rewardStatus, isLoading: statusLoading } = useQuery({\r\n        queryKey: REWARD_KEYS.status(userId || \"\"),\r\n        queryFn: () => userId ? getRewardStatus(userId) : null,\r\n        enabled: !!userId,\r\n        staleTime: 1000 * 60 * 5, // 5 minutes\r\n    });\r\n\r\n    // 2. Daily Missions\r\n    const { data: missions, isLoading: missionsLoading } = useQuery({\r\n        queryKey: REWARD_KEYS.missions(userId || \"\"),\r\n        queryFn: () => userId ? getDailyMissions(userId) : [],\r\n        enabled: !!userId,\r\n        staleTime: 1000 * 60 * 60, // 1 hour (missions don't change often in a day)\r\n    });\r\n\r\n    // 3. User Badges\r\n    const { data: badges, isLoading: badgesLoading } = useQuery({\r\n        queryKey: REWARD_KEYS.badges(userId || \"\"),\r\n        queryFn: () => userId ? getUserBadges(userId) : [],\r\n        enabled: !!userId,\r\n        staleTime: 1000 * 60 * 30, // 30 minutes\r\n    });\r\n\r\n    // 4. Transactions History\r\n    const { data: transactions, isLoading: transactionsLoading } = useQuery({\r\n        queryKey: REWARD_KEYS.transactions(userId || \"\"),\r\n        queryFn: async () => {\r\n            if (!userId) return [];\r\n            const supabase = createClient();\r\n            const { data } = await supabase\r\n                .from(\"reward_transactions\")\r\n                .select(\"*\")\r\n                .eq(\"user_id\", userId)\r\n                .order(\"created_at\", { ascending: false })\r\n                .limit(10);\r\n            return data || [];\r\n        },\r\n        enabled: !!userId,\r\n    });\r\n\r\n    // Mutations\r\n\r\n    // Award Coins\r\n    const awardCoinsMutation = useMutation({\r\n        mutationFn: async ({ action, entityId, description }: { action: any, entityId?: string, description?: string }) => {\r\n            if (!userId) throw new Error(\"User ID required\");\r\n            return await awardCoins(userId, action, entityId, description);\r\n        },\r\n        onSuccess: () => {\r\n            // Invalidate relevant queries to refresh data\r\n            if (userId) {\r\n                queryClient.invalidateQueries({ queryKey: REWARD_KEYS.status(userId) });\r\n                queryClient.invalidateQueries({ queryKey: REWARD_KEYS.transactions(userId) });\r\n                queryClient.invalidateQueries({ queryKey: REWARD_KEYS.leaderboard('weekly') });\r\n                queryClient.invalidateQueries({ queryKey: REWARD_KEYS.leaderboard('all_time') });\r\n            }\r\n        },\r\n    });\r\n\r\n    // Check Streak\r\n    const checkStreakMutation = useMutation({\r\n        mutationFn: async () => {\r\n            if (!userId) throw new Error(\"User ID required\");\r\n            return await checkStreak(userId);\r\n        },\r\n        onSuccess: () => {\r\n            if (userId) {\r\n                queryClient.invalidateQueries({ queryKey: REWARD_KEYS.status(userId) });\r\n            }\r\n        },\r\n    });\r\n\r\n    return {\r\n        rewardStatus,\r\n        statusLoading,\r\n        missions,\r\n        missionsLoading,\r\n        badges,\r\n        badgesLoading,\r\n        transactions,\r\n        transactionsLoading,\r\n        awardCoins: awardCoinsMutation.mutateAsync,\r\n        checkStreak: checkStreakMutation.mutateAsync,\r\n    };\r\n}\r\n\r\nexport function useLeaderboard(type: 'weekly' | 'all_time' = 'weekly', limit: number = 10) {\r\n    return useQuery({\r\n        queryKey: [...REWARD_KEYS.leaderboard(type), limit],\r\n        queryFn: () => getLeaderboard(type, limit),\r\n        staleTime: 1000 * 60 * 5, // 5 minutes\r\n    });\r\n}\r\n\r\nexport function useStreakHistory(userId: string) {\r\n    return useQuery({\r\n        queryKey: REWARD_KEYS.streakHistory(userId),\r\n        queryFn: () => getStreakHistory(userId),\r\n        enabled: !!userId,\r\n    });\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;;;;;;;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;;AAZA;;;;AAeO,MAAM,cAAc;IACvB,KAAK;QAAC;KAAU;IAChB,QAAQ,CAAC,SAAmB;eAAI,YAAY,GAAG;YAAE;YAAU;SAAO;IAClE,UAAU,CAAC,SAAmB;eAAI,YAAY,GAAG;YAAE;YAAY;SAAO;IACtE,QAAQ,CAAC,SAAmB;eAAI,YAAY,GAAG;YAAE;YAAU;SAAO;IAClE,aAAa,CAAC,OAAiB;eAAI,YAAY,GAAG;YAAE;YAAe;SAAK;IACxE,cAAc,CAAC,SAAmB;eAAI,YAAY,GAAG;YAAE;YAAgB;SAAO;IAC9E,eAAe,CAAC,SAAmB;eAAI,YAAY,GAAG;YAAE;YAAiB;SAAO;AACpF;AAEO,SAAS,WAAW,MAAe;;IACtC,MAAM,cAAc,IAAA,2MAAc;IAElC,uCAAuC;IACvC,MAAM,EAAE,MAAM,YAAY,EAAE,WAAW,aAAa,EAAE,GAAG,IAAA,0LAAQ,EAAC;QAC9D,UAAU,YAAY,MAAM,CAAC,UAAU;QACvC,OAAO;mCAAE,IAAM,SAAS,IAAA,4KAAe,EAAC,UAAU;;QAClD,SAAS,CAAC,CAAC;QACX,WAAW,OAAO,KAAK;IAC3B;IAEA,oBAAoB;IACpB,MAAM,EAAE,MAAM,QAAQ,EAAE,WAAW,eAAe,EAAE,GAAG,IAAA,0LAAQ,EAAC;QAC5D,UAAU,YAAY,QAAQ,CAAC,UAAU;QACzC,OAAO;mCAAE,IAAM,SAAS,IAAA,6KAAgB,EAAC,UAAU,EAAE;;QACrD,SAAS,CAAC,CAAC;QACX,WAAW,OAAO,KAAK;IAC3B;IAEA,iBAAiB;IACjB,MAAM,EAAE,MAAM,MAAM,EAAE,WAAW,aAAa,EAAE,GAAG,IAAA,0LAAQ,EAAC;QACxD,UAAU,YAAY,MAAM,CAAC,UAAU;QACvC,OAAO;mCAAE,IAAM,SAAS,IAAA,0KAAa,EAAC,UAAU,EAAE;;QAClD,SAAS,CAAC,CAAC;QACX,WAAW,OAAO,KAAK;IAC3B;IAEA,0BAA0B;IAC1B,MAAM,EAAE,MAAM,YAAY,EAAE,WAAW,mBAAmB,EAAE,GAAG,IAAA,0LAAQ,EAAC;QACpE,UAAU,YAAY,YAAY,CAAC,UAAU;QAC7C,OAAO;mCAAE;gBACL,IAAI,CAAC,QAAQ,OAAO,EAAE;gBACtB,MAAM,WAAW,IAAA,4IAAY;gBAC7B,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,SAClB,IAAI,CAAC,uBACL,MAAM,CAAC,KACP,EAAE,CAAC,WAAW,QACd,KAAK,CAAC,cAAc;oBAAE,WAAW;gBAAM,GACvC,KAAK,CAAC;gBACX,OAAO,QAAQ,EAAE;YACrB;;QACA,SAAS,CAAC,CAAC;IACf;IAEA,YAAY;IAEZ,cAAc;IACd,MAAM,qBAAqB,IAAA,gMAAW,EAAC;QACnC,UAAU;0DAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,WAAW,EAA4D;gBAC1G,IAAI,CAAC,QAAQ,MAAM,IAAI,MAAM;gBAC7B,OAAO,MAAM,IAAA,uKAAU,EAAC,QAAQ,QAAQ,UAAU;YACtD;;QACA,SAAS;0DAAE;gBACP,8CAA8C;gBAC9C,IAAI,QAAQ;oBACR,YAAY,iBAAiB,CAAC;wBAAE,UAAU,YAAY,MAAM,CAAC;oBAAQ;oBACrE,YAAY,iBAAiB,CAAC;wBAAE,UAAU,YAAY,YAAY,CAAC;oBAAQ;oBAC3E,YAAY,iBAAiB,CAAC;wBAAE,UAAU,YAAY,WAAW,CAAC;oBAAU;oBAC5E,YAAY,iBAAiB,CAAC;wBAAE,UAAU,YAAY,WAAW,CAAC;oBAAY;gBAClF;YACJ;;IACJ;IAEA,eAAe;IACf,MAAM,sBAAsB,IAAA,gMAAW,EAAC;QACpC,UAAU;2DAAE;gBACR,IAAI,CAAC,QAAQ,MAAM,IAAI,MAAM;gBAC7B,OAAO,MAAM,IAAA,wKAAW,EAAC;YAC7B;;QACA,SAAS;2DAAE;gBACP,IAAI,QAAQ;oBACR,YAAY,iBAAiB,CAAC;wBAAE,UAAU,YAAY,MAAM,CAAC;oBAAQ;gBACzE;YACJ;;IACJ;IAEA,OAAO;QACH;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,YAAY,mBAAmB,WAAW;QAC1C,aAAa,oBAAoB,WAAW;IAChD;AACJ;GAxFgB;;QACQ,2MAAc;QAGuB,0LAAQ;QAQV,0LAAQ;QAQZ,0LAAQ;QAQI,0LAAQ;QAmB5C,gMAAW;QAiBV,gMAAW;;;AA0BpC,SAAS,eAAe,OAA8B,QAAQ,EAAE,QAAgB,EAAE;;IACrF,OAAO,IAAA,0LAAQ,EAAC;QACZ,UAAU;eAAI,YAAY,WAAW,CAAC;YAAO;SAAM;QACnD,OAAO;uCAAE,IAAM,IAAA,2KAAc,EAAC,MAAM;;QACpC,WAAW,OAAO,KAAK;IAC3B;AACJ;IANgB;;QACL,0LAAQ;;;AAOZ,SAAS,iBAAiB,MAAc;;IAC3C,OAAO,IAAA,0LAAQ,EAAC;QACZ,UAAU,YAAY,aAAa,CAAC;QACpC,OAAO;yCAAE,IAAM,IAAA,6KAAgB,EAAC;;QAChC,SAAS,CAAC,CAAC;IACf;AACJ;IANgB;;QACL,0LAAQ"
      }
    },
    {
      "offset": {
        "line": 1186,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/ui/tooltip.tsx"
        ],
        "sourcesContent": [
          "'use client'\r\n\r\nimport * as React from 'react'\r\nimport * as TooltipPrimitive from '@radix-ui/react-tooltip'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction TooltipProvider({\r\n  delayDuration = 0,\r\n  ...props\r\n}: React.ComponentProps<typeof TooltipPrimitive.Provider>) {\r\n  return (\r\n    <TooltipPrimitive.Provider\r\n      data-slot=\"tooltip-provider\"\r\n      delayDuration={delayDuration}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction Tooltip({\r\n  ...props\r\n}: React.ComponentProps<typeof TooltipPrimitive.Root>) {\r\n  return (\r\n    <TooltipProvider>\r\n      <TooltipPrimitive.Root data-slot=\"tooltip\" {...props} />\r\n    </TooltipProvider>\r\n  )\r\n}\r\n\r\nfunction TooltipTrigger({\r\n  ...props\r\n}: React.ComponentProps<typeof TooltipPrimitive.Trigger>) {\r\n  return <TooltipPrimitive.Trigger data-slot=\"tooltip-trigger\" {...props} />\r\n}\r\n\r\nfunction TooltipContent({\r\n  className,\r\n  sideOffset = 0,\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<typeof TooltipPrimitive.Content>) {\r\n  return (\r\n    <TooltipPrimitive.Portal>\r\n      <TooltipPrimitive.Content\r\n        data-slot=\"tooltip-content\"\r\n        sideOffset={sideOffset}\r\n        className={cn(\r\n          'bg-foreground text-background animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance',\r\n          className,\r\n        )}\r\n        {...props}\r\n      >\r\n        {children}\r\n        <TooltipPrimitive.Arrow className=\"bg-foreground fill-foreground z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]\" />\r\n      </TooltipPrimitive.Content>\r\n    </TooltipPrimitive.Portal>\r\n  )\r\n}\r\n\r\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\r\n"
        ],
        "names": [],
        "mappings": ";;;;;;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,gBAAgB,EACvB,gBAAgB,CAAC,EACjB,GAAG,OACoD;IACvD,qBACE,6LAAC,kLAAyB;QACxB,aAAU;QACV,eAAe;QACd,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,QAAQ,EACf,GAAG,OACgD;IACnD,qBACE,6LAAC;kBACC,cAAA,6LAAC,8KAAqB;YAAC,aAAU;YAAW,GAAG,KAAK;;;;;;;;;;;AAG1D;MARS;AAUT,SAAS,eAAe,EACtB,GAAG,OACmD;IACtD,qBAAO,6LAAC,iLAAwB;QAAC,aAAU;QAAmB,GAAG,KAAK;;;;;;AACxE;MAJS;AAMT,SAAS,eAAe,EACtB,SAAS,EACT,aAAa,CAAC,EACd,QAAQ,EACR,GAAG,OACmD;IACtD,qBACE,6LAAC,gLAAuB;kBACtB,cAAA,6LAAC,iLAAwB;YACvB,aAAU;YACV,YAAY;YACZ,WAAW,IAAA,qHAAE,EACX,qaACA;YAED,GAAG,KAAK;;gBAER;8BACD,6LAAC,+KAAsB;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAI1C;MAtBS"
      }
    },
    {
      "offset": {
        "line": 1285,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/ui/dialog.tsx"
        ],
        "sourcesContent": [
          "'use client'\r\n\r\nimport * as React from 'react'\r\nimport * as DialogPrimitive from '@radix-ui/react-dialog'\r\nimport { XIcon } from 'lucide-react'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Dialog({\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Root>) {\r\n  return <DialogPrimitive.Root data-slot=\"dialog\" {...props} />\r\n}\r\n\r\nfunction DialogTrigger({\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Trigger>) {\r\n  return <DialogPrimitive.Trigger data-slot=\"dialog-trigger\" {...props} />\r\n}\r\n\r\nfunction DialogPortal({\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Portal>) {\r\n  return <DialogPrimitive.Portal data-slot=\"dialog-portal\" {...props} />\r\n}\r\n\r\nfunction DialogClose({\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Close>) {\r\n  return <DialogPrimitive.Close data-slot=\"dialog-close\" {...props} />\r\n}\r\n\r\nfunction DialogOverlay({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Overlay>) {\r\n  return (\r\n    <DialogPrimitive.Overlay\r\n      data-slot=\"dialog-overlay\"\r\n      className={cn(\r\n        'data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction DialogContent({\r\n  className,\r\n  children,\r\n  showCloseButton = true,\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Content> & {\r\n  showCloseButton?: boolean\r\n}) {\r\n  return (\r\n    <DialogPortal data-slot=\"dialog-portal\">\r\n      <DialogOverlay />\r\n      <DialogPrimitive.Content\r\n        data-slot=\"dialog-content\"\r\n        className={cn(\r\n          'bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg',\r\n          className,\r\n        )}\r\n        {...props}\r\n      >\r\n        {children}\r\n        {showCloseButton && (\r\n          <DialogPrimitive.Close\r\n            data-slot=\"dialog-close\"\r\n            className=\"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\"\r\n          >\r\n            <XIcon />\r\n            <span className=\"sr-only\">Close</span>\r\n          </DialogPrimitive.Close>\r\n        )}\r\n      </DialogPrimitive.Content>\r\n    </DialogPortal>\r\n  )\r\n}\r\n\r\nfunction DialogHeader({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"dialog-header\"\r\n      className={cn('flex flex-col gap-2 text-center sm:text-left', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction DialogFooter({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"dialog-footer\"\r\n      className={cn(\r\n        'flex flex-col-reverse gap-2 sm:flex-row sm:justify-end',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction DialogTitle({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Title>) {\r\n  return (\r\n    <DialogPrimitive.Title\r\n      data-slot=\"dialog-title\"\r\n      className={cn('text-lg leading-none font-semibold', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction DialogDescription({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Description>) {\r\n  return (\r\n    <DialogPrimitive.Description\r\n      data-slot=\"dialog-description\"\r\n      className={cn('text-muted-foreground text-sm', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {\r\n  Dialog,\r\n  DialogClose,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogOverlay,\r\n  DialogPortal,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;;;;;;;;;;;;;;;;;;;;AAGA;AACA;AAEA;AANA;;;;;AAQA,SAAS,OAAO,EACd,GAAG,OAC+C;IAClD,qBAAO,6LAAC,6KAAoB;QAAC,aAAU;QAAU,GAAG,KAAK;;;;;;AAC3D;KAJS;AAMT,SAAS,cAAc,EACrB,GAAG,OACkD;IACrD,qBAAO,6LAAC,gLAAuB;QAAC,aAAU;QAAkB,GAAG,KAAK;;;;;;AACtE;MAJS;AAMT,SAAS,aAAa,EACpB,GAAG,OACiD;IACpD,qBAAO,6LAAC,+KAAsB;QAAC,aAAU;QAAiB,GAAG,KAAK;;;;;;AACpE;MAJS;AAMT,SAAS,YAAY,EACnB,GAAG,OACgD;IACnD,qBAAO,6LAAC,8KAAqB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;MAJS;AAMT,SAAS,cAAc,EACrB,SAAS,EACT,GAAG,OACkD;IACrD,qBACE,6LAAC,gLAAuB;QACtB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,0JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,cAAc,EACrB,SAAS,EACT,QAAQ,EACR,kBAAkB,IAAI,EACtB,GAAG,OAGJ;IACC,qBACE,6LAAC;QAAa,aAAU;;0BACtB,6LAAC;;;;;0BACD,6LAAC,gLAAuB;gBACtB,aAAU;gBACV,WAAW,IAAA,qHAAE,EACX,+WACA;gBAED,GAAG,KAAK;;oBAER;oBACA,iCACC,6LAAC,8KAAqB;wBACpB,aAAU;wBACV,WAAU;;0CAEV,6LAAC,4MAAK;;;;;0CACN,6LAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;AAMtC;MAhCS;AAkCT,SAAS,aAAa,EAAE,SAAS,EAAE,GAAG,OAAoC;IACxE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,gDAAgD;QAC7D,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,aAAa,EAAE,SAAS,EAAE,GAAG,OAAoC;IACxE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,0DACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6LAAC,8KAAqB;QACpB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,kBAAkB,EACzB,SAAS,EACT,GAAG,OACsD;IACzD,qBACE,6LAAC,oLAA2B;QAC1B,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MAXS"
      }
    },
    {
      "offset": {
        "line": 1491,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/ui/avatar.tsx"
        ],
        "sourcesContent": [
          "'use client'\r\n\r\nimport * as React from 'react'\r\nimport * as AvatarPrimitive from '@radix-ui/react-avatar'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Avatar({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AvatarPrimitive.Root>) {\r\n  return (\r\n    <AvatarPrimitive.Root\r\n      data-slot=\"avatar\"\r\n      className={cn(\r\n        'relative flex size-8 shrink-0 overflow-hidden rounded-full',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AvatarImage({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AvatarPrimitive.Image>) {\r\n  return (\r\n    <AvatarPrimitive.Image\r\n      data-slot=\"avatar-image\"\r\n      className={cn('aspect-square size-full', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AvatarFallback({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AvatarPrimitive.Fallback>) {\r\n  return (\r\n    <AvatarPrimitive.Fallback\r\n      data-slot=\"avatar-fallback\"\r\n      className={cn(\r\n        'bg-muted flex size-full items-center justify-center rounded-full',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Avatar, AvatarImage, AvatarFallback }\r\n"
        ],
        "names": [],
        "mappings": ";;;;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,OAAO,EACd,SAAS,EACT,GAAG,OAC+C;IAClD,qBACE,6LAAC,6KAAoB;QACnB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,8DACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS;AAgBT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6LAAC,8KAAqB;QACpB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,2BAA2B;QACxC,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,eAAe,EACtB,SAAS,EACT,GAAG,OACmD;IACtD,qBACE,6LAAC,iLAAwB;QACvB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,oEACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS"
      }
    },
    {
      "offset": {
        "line": 1554,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/ui/scroll-area.tsx"
        ],
        "sourcesContent": [
          "'use client'\r\n\r\nimport * as React from 'react'\r\nimport * as ScrollAreaPrimitive from '@radix-ui/react-scroll-area'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction ScrollArea({\r\n  className,\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<typeof ScrollAreaPrimitive.Root>) {\r\n  return (\r\n    <ScrollAreaPrimitive.Root\r\n      data-slot=\"scroll-area\"\r\n      className={cn('relative', className)}\r\n      {...props}\r\n    >\r\n      <ScrollAreaPrimitive.Viewport\r\n        data-slot=\"scroll-area-viewport\"\r\n        className=\"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1\"\r\n      >\r\n        {children}\r\n      </ScrollAreaPrimitive.Viewport>\r\n      <ScrollBar />\r\n      <ScrollAreaPrimitive.Corner />\r\n    </ScrollAreaPrimitive.Root>\r\n  )\r\n}\r\n\r\nfunction ScrollBar({\r\n  className,\r\n  orientation = 'vertical',\r\n  ...props\r\n}: React.ComponentProps<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>) {\r\n  return (\r\n    <ScrollAreaPrimitive.ScrollAreaScrollbar\r\n      data-slot=\"scroll-area-scrollbar\"\r\n      orientation={orientation}\r\n      className={cn(\r\n        'flex touch-none p-px transition-colors select-none',\r\n        orientation === 'vertical' &&\r\n          'h-full w-2.5 border-l border-l-transparent',\r\n        orientation === 'horizontal' &&\r\n          'h-2.5 flex-col border-t border-t-transparent',\r\n        className,\r\n      )}\r\n      {...props}\r\n    >\r\n      <ScrollAreaPrimitive.ScrollAreaThumb\r\n        data-slot=\"scroll-area-thumb\"\r\n        className=\"bg-border relative flex-1 rounded-full\"\r\n      />\r\n    </ScrollAreaPrimitive.ScrollAreaScrollbar>\r\n  )\r\n}\r\n\r\nexport { ScrollArea, ScrollBar }\r\n"
        ],
        "names": [],
        "mappings": ";;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,WAAW,EAClB,SAAS,EACT,QAAQ,EACR,GAAG,OACmD;IACtD,qBACE,6LAAC,qLAAwB;QACvB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,YAAY;QACzB,GAAG,KAAK;;0BAET,6LAAC,yLAA4B;gBAC3B,aAAU;gBACV,WAAU;0BAET;;;;;;0BAEH,6LAAC;;;;;0BACD,6LAAC,uLAA0B;;;;;;;;;;;AAGjC;KArBS;AAuBT,SAAS,UAAU,EACjB,SAAS,EACT,cAAc,UAAU,EACxB,GAAG,OACkE;IACrE,qBACE,6LAAC,oMAAuC;QACtC,aAAU;QACV,aAAa;QACb,WAAW,IAAA,qHAAE,EACX,sDACA,gBAAgB,cACd,8CACF,gBAAgB,gBACd,gDACF;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,gMAAmC;YAClC,aAAU;YACV,WAAU;;;;;;;;;;;AAIlB;MAzBS"
      }
    },
    {
      "offset": {
        "line": 1632,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/RewardModal.tsx"
        ],
        "sourcesContent": [
          "\"use client\";\r\n\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { Coins, Flame, Hexagon, Trophy, Crown, Medal } from \"lucide-react\";\r\nimport { motion } from \"framer-motion\";\r\nimport { useLeaderboard } from \"@/hooks/useRewards\";\r\n\r\ninterface RewardModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    userRewards: any;\r\n    userProfile: any;\r\n}\r\n\r\nexport function RewardModal({ isOpen, onClose, userRewards, userProfile }: RewardModalProps) {\r\n    const { data: leaderboardData, isLoading: loading } = useLeaderboard('all_time', 20);\r\n    const leaderboard = leaderboardData || [];\r\n\r\n    const getRankIcon = (index: number) => {\r\n        switch (index) {\r\n            case 0: return <Crown className=\"w-5 h-5 text-yellow-500 fill-yellow-500\" />;\r\n            case 1: return <Medal className=\"w-5 h-5 text-slate-400 fill-slate-400\" />;\r\n            case 2: return <Medal className=\"w-5 h-5 text-amber-700 fill-amber-700\" />;\r\n            default: return <span className=\"text-sm font-bold text-slate-500 w-5 text-center\">{index + 1}</span>;\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Dialog open={isOpen} onOpenChange={onClose}>\r\n            <DialogContent className=\"sm:max-w-md md:max-w-2xl bg-white dark:bg-slate-950 border-slate-200 dark:border-slate-800 p-0 overflow-hidden gap-0\">\r\n                <DialogTitle className=\"sr-only\">Rewards & Leaderboard</DialogTitle>\r\n                <div className=\"grid md:grid-cols-2 h-[600px] md:h-[500px]\">\r\n                    {/* Left: User Summary */}\r\n                    <div className=\"bg-linear-to-br from-indigo-600 to-violet-700 p-6 text-white flex flex-col items-center justify-center relative overflow-hidden\">\r\n                        <div className=\"absolute inset-0 bg-[url('/grid.svg')] opacity-10\"></div>\r\n                        <div className=\"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full blur-3xl -mr-16 -mt-16\"></div>\r\n                        <div className=\"absolute bottom-0 left-0 w-32 h-32 bg-black/10 rounded-full blur-3xl -ml-16 -mb-16\"></div>\r\n\r\n                        <div className=\"relative z-10 flex flex-col items-center text-center space-y-4\">\r\n                            <div className=\"relative\">\r\n                                <Avatar className=\"w-24 h-24 border-4 border-white/20 shadow-xl\">\r\n                                    <AvatarImage src={userProfile?.avatar_url} />\r\n                                    <AvatarFallback className=\"text-2xl font-bold bg-indigo-800 text-white\">\r\n                                        {userProfile?.full_name?.[0] || \"U\"}\r\n                                    </AvatarFallback>\r\n                                </Avatar>\r\n                                <div className=\"absolute -bottom-2 -right-2 bg-yellow-400 text-yellow-900 text-xs font-bold px-2 py-1 rounded-full border-2 border-indigo-600 shadow-lg flex items-center gap-1\">\r\n                                    <Trophy className=\"w-3 h-3\" />\r\n                                    <span>Rank #{leaderboard.findIndex(u => u.user_id === userRewards?.user_id) + 1 || \"-\"}</span>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div>\r\n                                <h2 className=\"text-xl font-bold\">{userProfile?.full_name || \"Learner\"}</h2>\r\n                                <p className=\"text-indigo-200 text-sm\">Keep pushing your limits!</p>\r\n                            </div>\r\n\r\n                            <div className=\"grid grid-cols-3 gap-3 w-full mt-4\">\r\n                                <div className=\"bg-white/10 backdrop-blur-md rounded-xl p-3 flex flex-col items-center border border-white/10\">\r\n                                    <div className=\"bg-yellow-400/20 p-2 rounded-full mb-2\">\r\n                                        <Coins className=\"w-5 h-5 text-yellow-300\" />\r\n                                    </div>\r\n                                    <span className=\"text-lg font-bold\">{userRewards?.total_coins || 0}</span>\r\n                                    <span className=\"text-xs text-indigo-200\">Coins</span>\r\n                                </div>\r\n                                <div className=\"bg-white/10 backdrop-blur-md rounded-xl p-3 flex flex-col items-center border border-white/10\">\r\n                                    <div className=\"bg-orange-500/20 p-2 rounded-full mb-2\">\r\n                                        <Flame className=\"w-5 h-5 text-orange-400\" />\r\n                                    </div>\r\n                                    <span className=\"text-lg font-bold\">{userRewards?.current_streak || 0}</span>\r\n                                    <span className=\"text-xs text-indigo-200\">Streak</span>\r\n                                </div>\r\n                                <div className=\"bg-white/10 backdrop-blur-md rounded-xl p-3 flex flex-col items-center border border-white/10\">\r\n                                    <div className=\"bg-purple-500/20 p-2 rounded-full mb-2\">\r\n                                        <Hexagon className=\"w-5 h-5 text-purple-300\" />\r\n                                    </div>\r\n                                    <span className=\"text-lg font-bold\">{userRewards?.xp || 0}</span>\r\n                                    <span className=\"text-xs text-indigo-200\">XP</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Right: Leaderboard */}\r\n                    <div className=\"flex flex-col h-full bg-slate-50 dark:bg-slate-900/50\">\r\n                        <div className=\"p-4 border-b border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900\">\r\n                            <h3 className=\"font-bold flex items-center gap-2\">\r\n                                <Trophy className=\"w-4 h-4 text-yellow-500\" />\r\n                                Top Learners\r\n                            </h3>\r\n                        </div>\r\n                        <ScrollArea className=\"flex-1 p-4\">\r\n                            {loading ? (\r\n                                <div className=\"space-y-3\">\r\n                                    {[1, 2, 3, 4, 5].map(i => (\r\n                                        <div key={i} className=\"h-14 bg-slate-200 dark:bg-slate-800 rounded-xl animate-pulse\" />\r\n                                    ))}\r\n                                </div>\r\n                            ) : (\r\n                                <div className=\"space-y-2\">\r\n                                    {leaderboard.map((user, index) => (\r\n                                        <motion.div\r\n                                            key={user.user_id}\r\n                                            initial={{ opacity: 0, y: 10 }}\r\n                                            animate={{ opacity: 1, y: 0 }}\r\n                                            transition={{ delay: index * 0.05 }}\r\n                                            className={`flex items-center gap-3 p-3 rounded-xl border transition-all ${user.user_id === userRewards?.user_id\r\n                                                ? \"bg-indigo-50 dark:bg-indigo-900/20 border-indigo-200 dark:border-indigo-800 shadow-sm\"\r\n                                                : \"bg-white dark:bg-slate-900 border-slate-100 dark:border-slate-800 hover:border-slate-300 dark:hover:border-slate-700\"\r\n                                                }`}\r\n                                        >\r\n                                            <div className=\"w-8 flex justify-center\">\r\n                                                {getRankIcon(index)}\r\n                                            </div>\r\n                                            <Avatar className=\"w-10 h-10 border border-slate-200 dark:border-slate-700\">\r\n                                                <AvatarImage src={user.profiles?.avatar_url} />\r\n                                                <AvatarFallback className=\"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 text-xs\">\r\n                                                    {user.profiles?.full_name?.[0] || \"U\"}\r\n                                                </AvatarFallback>\r\n                                            </Avatar>\r\n                                            <div className=\"flex-1 min-w-0\">\r\n                                                <p className={`text-sm font-medium truncate ${user.user_id === userRewards?.user_id ? \"text-indigo-700 dark:text-indigo-300\" : \"\"}`}>\r\n                                                    {user.profiles?.full_name || \"Anonymous\"}\r\n                                                </p>\r\n                                                <div className=\"flex items-center gap-2 text-xs text-slate-500\">\r\n                                                    <span className=\"flex items-center gap-0.5\">\r\n                                                        <Coins className=\"w-3 h-3 text-yellow-500\" /> {user.total_coins}\r\n                                                    </span>\r\n                                                    <span className=\"flex items-center gap-0.5\">\r\n                                                        <Hexagon className=\"w-3 h-3 text-purple-500\" /> {user.xp || 0} XP\r\n                                                    </span>\r\n                                                </div>\r\n                                            </div>\r\n                                        </motion.div>\r\n                                    ))}\r\n                                </div>\r\n                            )}\r\n                        </ScrollArea>\r\n                    </div>\r\n                </div>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n"
        ],
        "names": [],
        "mappings": "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"
      }
    },
    {
      "offset": {
        "line": 2177,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/RewardDisplay.tsx"
        ],
        "sourcesContent": [
          "import { useState } from \"react\";\r\nimport { useRewards } from \"@/hooks/useRewards\";\r\nimport { Gift, Flame, Hexagon } from \"lucide-react\";\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { RewardModal } from \"./RewardModal\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\nimport { useQuery } from \"@tanstack/react-query\";\r\n\r\nexport function RewardDisplay({ userId, userProfile }: { userId: string; userProfile?: any }) {\r\n    const { rewardStatus: rewards } = useRewards(userId);\r\n    const [isModalOpen, setIsModalOpen] = useState(false);\r\n\r\n    // Fetch profile if not provided\r\n    const { data: fetchedProfile } = useQuery({\r\n        queryKey: ['profile', userId],\r\n        queryFn: async () => {\r\n            const supabase = createClient();\r\n            const { data } = await supabase.from(\"profiles\").select(\"*\").eq(\"id\", userId).single();\r\n            return data;\r\n        },\r\n        enabled: !userProfile,\r\n        staleTime: 1000 * 60 * 5\r\n    });\r\n\r\n    const profile = userProfile || fetchedProfile;\r\n\r\n    if (!rewards) return null;\r\n\r\n    return (\r\n        <>\r\n            <div\r\n                onClick={() => setIsModalOpen(true)}\r\n                className=\"flex items-center gap-3 sm:gap-6 mr-4 cursor-pointer hover:opacity-90 transition-opacity\"\r\n            >\r\n                {/* Coins (Gift Icon) */}\r\n                <TooltipProvider>\r\n                    <Tooltip>\r\n                        <TooltipTrigger asChild>\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <Gift className=\"w-6 h-6 sm:w-7 sm:h-7 text-orange-400 fill-orange-400/20\" />\r\n                                <AnimatePresence mode=\"popLayout\">\r\n                                    <motion.span\r\n                                        key={rewards.total_coins}\r\n                                        initial={{ y: 10, opacity: 0 }}\r\n                                        animate={{ y: 0, opacity: 1 }}\r\n                                        exit={{ y: -10, opacity: 0 }}\r\n                                        className=\"text-base sm:text-lg font-bold text-slate-700 dark:text-slate-200\"\r\n                                    >\r\n                                        {rewards.total_coins}\r\n                                    </motion.span>\r\n                                </AnimatePresence>\r\n                            </div>\r\n                        </TooltipTrigger>\r\n                        <TooltipContent><p>Total Coins</p></TooltipContent>\r\n                    </Tooltip>\r\n                </TooltipProvider>\r\n\r\n                {/* Streak (Flame in Circle) */}\r\n                <TooltipProvider>\r\n                    <Tooltip>\r\n                        <TooltipTrigger asChild>\r\n                            <div className=\"hidden sm:flex items-center gap-2\">\r\n                                <div className={`flex items-center justify-center w-7 h-7 sm:w-8 sm:h-8 rounded-full ${rewards.current_streak > 0 ? \"bg-orange-100 dark:bg-orange-900/30\" : \"bg-slate-200 dark:bg-slate-800\"}`}>\r\n                                    <Flame className={`w-4 h-4 sm:w-5 sm:h-5 ${rewards.current_streak > 0 ? \"text-orange-500 fill-orange-500 animate-pulse\" : \"text-slate-400 fill-slate-400\"}`} />\r\n                                </div>\r\n                                <span className=\"text-base sm:text-lg font-bold text-slate-700 dark:text-slate-200\">{rewards.current_streak}</span>\r\n                            </div>\r\n                        </TooltipTrigger>\r\n                        <TooltipContent><p>Daily Streak</p></TooltipContent>\r\n                    </Tooltip>\r\n                </TooltipProvider>\r\n\r\n                {/* XP (Hexagon) */}\r\n                <TooltipProvider>\r\n                    <Tooltip>\r\n                        <TooltipTrigger asChild>\r\n                            <div className=\"hidden sm:flex items-center gap-2\">\r\n                                <div className=\"relative flex items-center justify-center w-7 h-7 sm:w-8 sm:h-8\">\r\n                                    <Hexagon className=\"w-full h-full text-blue-200 dark:text-blue-900 fill-blue-100 dark:fill-blue-900/50\" />\r\n                                    <span className=\"absolute text-[8px] sm:text-[10px] font-bold text-blue-600 dark:text-blue-400\">XP</span>\r\n                                </div>\r\n                                <span className=\"text-base sm:text-lg font-bold text-slate-700 dark:text-slate-200\">{rewards.xp || 0}</span>\r\n                            </div>\r\n                        </TooltipTrigger>\r\n                        <TooltipContent><p>XP Progress</p></TooltipContent>\r\n                    </Tooltip>\r\n                </TooltipProvider>\r\n            </div>\r\n\r\n            <RewardModal\r\n                isOpen={isModalOpen}\r\n                onClose={() => setIsModalOpen(false)}\r\n                userRewards={rewards}\r\n                userProfile={profile}\r\n            />\r\n        </>\r\n    );\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;;;;;;;;;;;AAEO,SAAS,cAAc,EAAE,MAAM,EAAE,WAAW,EAAyC;;IACxF,MAAM,EAAE,cAAc,OAAO,EAAE,GAAG,IAAA,oIAAU,EAAC;IAC7C,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAE/C,gCAAgC;IAChC,MAAM,EAAE,MAAM,cAAc,EAAE,GAAG,IAAA,0LAAQ,EAAC;QACtC,UAAU;YAAC;YAAW;SAAO;QAC7B,OAAO;sCAAE;gBACL,MAAM,WAAW,IAAA,4IAAY;gBAC7B,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,YAAY,MAAM,CAAC,KAAK,EAAE,CAAC,MAAM,QAAQ,MAAM;gBACpF,OAAO;YACX;;QACA,SAAS,CAAC;QACV,WAAW,OAAO,KAAK;IAC3B;IAEA,MAAM,UAAU,eAAe;IAE/B,IAAI,CAAC,SAAS,OAAO;IAErB,qBACI;;0BACI,6LAAC;gBACG,SAAS,IAAM,eAAe;gBAC9B,WAAU;;kCAGV,6LAAC,kJAAe;kCACZ,cAAA,6LAAC,0IAAO;;8CACJ,6LAAC,iJAAc;oCAAC,OAAO;8CACnB,cAAA,6LAAC;wCAAI,WAAU;;0DACX,6LAAC,6MAAI;gDAAC,WAAU;;;;;;0DAChB,6LAAC,+MAAe;gDAAC,MAAK;0DAClB,cAAA,6LAAC,uMAAM,CAAC,IAAI;oDAER,SAAS;wDAAE,GAAG;wDAAI,SAAS;oDAAE;oDAC7B,SAAS;wDAAE,GAAG;wDAAG,SAAS;oDAAE;oDAC5B,MAAM;wDAAE,GAAG,CAAC;wDAAI,SAAS;oDAAE;oDAC3B,WAAU;8DAET,QAAQ,WAAW;mDANf,QAAQ,WAAW;;;;;;;;;;;;;;;;;;;;;8CAWxC,6LAAC,iJAAc;8CAAC,cAAA,6LAAC;kDAAE;;;;;;;;;;;;;;;;;;;;;;kCAK3B,6LAAC,kJAAe;kCACZ,cAAA,6LAAC,0IAAO;;8CACJ,6LAAC,iJAAc;oCAAC,OAAO;8CACnB,cAAA,6LAAC;wCAAI,WAAU;;0DACX,6LAAC;gDAAI,WAAW,CAAC,oEAAoE,EAAE,QAAQ,cAAc,GAAG,IAAI,wCAAwC,kCAAkC;0DAC1L,cAAA,6LAAC,gNAAK;oDAAC,WAAW,CAAC,sBAAsB,EAAE,QAAQ,cAAc,GAAG,IAAI,kDAAkD,iCAAiC;;;;;;;;;;;0DAE/J,6LAAC;gDAAK,WAAU;0DAAqE,QAAQ,cAAc;;;;;;;;;;;;;;;;;8CAGnH,6LAAC,iJAAc;8CAAC,cAAA,6LAAC;kDAAE;;;;;;;;;;;;;;;;;;;;;;kCAK3B,6LAAC,kJAAe;kCACZ,cAAA,6LAAC,0IAAO;;8CACJ,6LAAC,iJAAc;oCAAC,OAAO;8CACnB,cAAA,6LAAC;wCAAI,WAAU;;0DACX,6LAAC;gDAAI,WAAU;;kEACX,6LAAC,sNAAO;wDAAC,WAAU;;;;;;kEACnB,6LAAC;wDAAK,WAAU;kEAAgF;;;;;;;;;;;;0DAEpG,6LAAC;gDAAK,WAAU;0DAAqE,QAAQ,EAAE,IAAI;;;;;;;;;;;;;;;;;8CAG3G,6LAAC,iJAAc;8CAAC,cAAA,6LAAC;kDAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAK/B,6LAAC,4IAAW;gBACR,QAAQ;gBACR,SAAS,IAAM,eAAe;gBAC9B,aAAa;gBACb,aAAa;;;;;;;;AAI7B;GAzFgB;;QACsB,oIAAU;QAIX,0LAAQ;;;KAL7B"
      }
    },
    {
      "offset": {
        "line": 2483,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/hooks/useNotifications.ts"
        ],
        "sourcesContent": [
          "import { useEffect } from \"react\";\r\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\nimport { toast } from \"sonner\";\r\n\r\nconst supabase = createClient();\r\n\r\nexport type Notification = {\r\n    id: string;\r\n    user_id: string;\r\n    title: string;\r\n    message: string;\r\n    type: \"info\" | \"success\" | \"warning\" | \"error\";\r\n    is_read: boolean;\r\n    link?: string;\r\n    created_at: string;\r\n};\r\n\r\nexport const useNotifications = (userId?: string) => {\r\n    const queryClient = useQueryClient();\r\n\r\n    const { data: notifications = [], isLoading } = useQuery({\r\n        queryKey: [\"notifications\", userId],\r\n        queryFn: async () => {\r\n            if (!userId) return [];\r\n\r\n            const { data, error } = await supabase\r\n                .from(\"notifications\")\r\n                .select(\"*\")\r\n                .eq(\"user_id\", userId)\r\n                .order(\"created_at\", { ascending: false })\r\n                .limit(50); // Limit to last 50 notifications\r\n\r\n            if (error) {\r\n                throw error;\r\n            }\r\n            return data as Notification[];\r\n        },\r\n        enabled: !!userId,\r\n        // Refetch every minute to keep fresh\r\n        refetchInterval: 60000,\r\n    });\r\n\r\n    const unreadCount = notifications.filter((n) => !n.is_read).length;\r\n\r\n    const markAsReadMutation = useMutation({\r\n        mutationFn: async (notificationId: string) => {\r\n            const { error } = await supabase\r\n                .from(\"notifications\")\r\n                .update({ is_read: true })\r\n                .eq(\"id\", notificationId);\r\n\r\n            if (error) throw error;\r\n        },\r\n        onSuccess: () => {\r\n            queryClient.invalidateQueries({ queryKey: [\"notifications\", userId] });\r\n        },\r\n        onError: () => {\r\n            toast.error(\"Failed to update notification\");\r\n        },\r\n    });\r\n\r\n    const markAllAsReadMutation = useMutation({\r\n        mutationFn: async () => {\r\n            if (!userId) return;\r\n            const { error } = await supabase\r\n                .from(\"notifications\")\r\n                .update({ is_read: true })\r\n                .eq(\"user_id\", userId)\r\n                .eq(\"is_read\", false);\r\n\r\n            if (error) throw error;\r\n        },\r\n        onSuccess: () => {\r\n            queryClient.invalidateQueries({ queryKey: [\"notifications\", userId] });\r\n            toast.success(\"All notifications marked as read\");\r\n        },\r\n        onError: () => {\r\n            toast.error(\"Failed to mark all as read\");\r\n        },\r\n    });\r\n\r\n    // Real-time subscription\r\n    useEffect(() => {\r\n        if (!userId) return;\r\n\r\n        const channel = supabase\r\n            .channel(`notifications-${userId}`)\r\n            .on(\r\n                \"postgres_changes\",\r\n                {\r\n                    event: \"INSERT\",\r\n                    schema: \"public\",\r\n                    table: \"notifications\",\r\n                    filter: `user_id=eq.${userId}`,\r\n                },\r\n                (payload) => {\r\n                    const newNotification = payload.new as Notification;\r\n\r\n                    // 1. Invalidate query to refresh list\r\n                    queryClient.invalidateQueries({ queryKey: [\"notifications\", userId] });\r\n\r\n                    // 2. Show Toast (Show this FIRST so it's visible even if audio fails)\r\n                    toast(newNotification.title, {\r\n                        description: newNotification.message,\r\n                        action: newNotification.link ? {\r\n                            label: \"View\",\r\n                            onClick: () => window.location.href = newNotification.link!\r\n                        } : undefined,\r\n                    });\r\n\r\n                    // 3. Play Sound\r\n                    const audio = new Audio(\"https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3\");\r\n                    audio.play().catch(() => {\r\n                        // Silently fail - audio is not critical\r\n                    });\r\n                }\r\n            )\r\n            .subscribe();\r\n\r\n        return () => {\r\n            supabase.removeChannel(channel);\r\n        };\r\n    }, [userId, queryClient]);\r\n\r\n    return {\r\n        notifications,\r\n        isLoading,\r\n        unreadCount,\r\n        markAsRead: markAsReadMutation.mutate,\r\n        markAllAsRead: markAllAsReadMutation.mutate,\r\n    };\r\n};\r\n"
        ],
        "names": [],
        "mappings": "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"
      }
    },
    {
      "offset": {
        "line": 2647,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/app/admin/components/layout/Header.tsx"
        ],
        "sourcesContent": [
          "\"use client\";\r\nimport { useState, useRef, useEffect } from \"react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport Image from \"next/image\";\r\nimport {\r\n  Bell,\r\n  Moon,\r\n  Sun,\r\n  User,\r\n  Settings,\r\n  Info,\r\n  LogOut,\r\n  X,\r\n  Search,\r\n  Command,\r\n  CheckCircle2,\r\n  AlertCircle\r\n} from \"lucide-react\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { RewardDisplay } from \"@/components/RewardDisplay\";\r\n\r\nimport { useNotifications } from \"@/hooks/useNotifications\";\r\n\r\nexport default function Header({\r\n  theme,\r\n  toggleTheme,\r\n  sidebarCollapsed,\r\n  profile,\r\n  setSidebarCollapsed\r\n}: {\r\n  theme: string;\r\n  toggleTheme: () => void;\r\n  sidebarCollapsed: boolean;\r\n  profile: any;\r\n  setSidebarCollapsed: any;\r\n}) {\r\n  const router = useRouter();\r\n  const [openProfile, setOpenProfile] = useState(false);\r\n  const [openNotif, setOpenNotif] = useState(false);\r\n  const [expandedNotifId, setExpandedNotifId] = useState<string | null>(null);\r\n\r\n  const { notifications, unreadCount, markAsRead, markAllAsRead } = useNotifications(profile?.id);\r\n\r\n  const profileRef = useRef<HTMLDivElement>(null);\r\n  const notifRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Close dropdowns when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (e: MouseEvent) => {\r\n      const target = e.target as Node;\r\n      if (!target) return;\r\n\r\n      if (profileRef.current && !profileRef.current.contains(target)) {\r\n        setOpenProfile(false);\r\n      }\r\n      if (notifRef.current && !notifRef.current.contains(target)) {\r\n        setOpenNotif(false);\r\n      }\r\n    };\r\n    document.addEventListener(\"mousedown\", handleClickOutside);\r\n    return () => document.removeEventListener(\"mousedown\", handleClickOutside);\r\n  }, []);\r\n\r\n  const handleLogout = async () => {\r\n    const supabase = createClient();\r\n    await supabase.auth.signOut();\r\n    // Force a hard alignment to the login page to clear all React/Query state\r\n    window.location.href = \"/auth/login\";\r\n  };\r\n\r\n  const handleNotificationClick = (id: string, isRead: boolean) => {\r\n    // Toggle expansion\r\n    if (expandedNotifId === id) {\r\n      setExpandedNotifId(null);\r\n    } else {\r\n      setExpandedNotifId(id);\r\n      // Mark as read if not already\r\n      if (!isRead) {\r\n        markAsRead(id);\r\n      }\r\n    }\r\n  };\r\n\r\n\r\n\r\n  return (\r\n    <header\r\n      className={`fixed top-0 right-0 h-16 z-30 flex items-center justify-between px-4 md:px-8 transition-all duration-300\r\n      ${sidebarCollapsed ? \"md:left-20\" : \"md:left-64\"} left-0\r\n      bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-800 shadow-sm`}\r\n    >\r\n      {/* Left Side: Search or Breadcrumbs */}\r\n      <div className=\"flex items-center gap-4 ml-12 md:ml-0\">\r\n        <div className=\"hidden md:flex items-center relative\">\r\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400\" />\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Search...\"\r\n            className=\"h-10 pl-10 pr-4 rounded-full bg-slate-100 dark:bg-slate-800 border-none focus:ring-2 focus:ring-indigo-500/20 w-64 text-sm transition-all\"\r\n          />\r\n          <div className=\"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-1\">\r\n            <span className=\"text-[10px] font-medium text-slate-400 border border-slate-300 dark:border-slate-600 rounded px-1.5 py-0.5\">‚åòK</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n\r\n\r\n      {/* Right Side: Actions */}\r\n      <div className=\"flex items-center gap-2 md:gap-4\">\r\n        {/* Reward Display - Only for Students */}\r\n        {profile?.id && profile?.role === \"student\" && <RewardDisplay userId={profile.id} userProfile={profile} />}\r\n\r\n        {/* Theme Toggle */}\r\n        <button\r\n          onClick={toggleTheme}\r\n          className=\"p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors text-slate-600 dark:text-slate-400\"\r\n        >\r\n          {theme === \"light\" ? <Moon className=\"w-5 h-5\" /> : <Sun className=\"w-5 h-5\" />}\r\n        </button>\r\n\r\n        {/* Notifications */}\r\n        <div ref={notifRef} className=\"relative\">\r\n\r\n\r\n          <button\r\n            onClick={() => setOpenNotif(!openNotif)}\r\n            className=\"relative p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors text-slate-600 dark:text-slate-400\"\r\n          >\r\n            <Bell className=\"w-5 h-5\" />\r\n            {unreadCount > 0 && (\r\n              <span className=\"absolute top-1.5 right-1.5 w-2 h-2 bg-red-500 rounded-full border-2 border-white dark:border-slate-900\"></span>\r\n            )}\r\n          </button>\r\n\r\n          <AnimatePresence>\r\n            {openNotif && (\r\n              <motion.div\r\n                initial={{ opacity: 0, y: 10, scale: 0.95 }}\r\n                animate={{ opacity: 1, y: 0, scale: 1 }}\r\n                exit={{ opacity: 0, y: 10, scale: 0.95 }}\r\n                transition={{ duration: 0.2 }}\r\n                className=\"absolute right-0 top-14 w-80 md:w-96 bg-white dark:bg-slate-900 rounded-2xl shadow-xl border border-slate-200 dark:border-slate-800 overflow-hidden origin-top-right\"\r\n              >\r\n                <div className=\"p-4 border-b border-slate-100 dark:border-slate-800 flex items-center justify-between\">\r\n                  <h3 className=\"font-semibold text-slate-900 dark:text-white\">Notifications</h3>\r\n                  {unreadCount > 0 && (\r\n                    <button\r\n                      onClick={() => markAllAsRead()}\r\n                      className=\"text-xs text-indigo-600 dark:text-indigo-400 font-medium hover:underline\"\r\n                    >\r\n                      Mark all as read\r\n                    </button>\r\n                  )}\r\n                </div>\r\n                <div className=\"max-h-[400px] overflow-y-auto custom-scrollbar\">\r\n                  {notifications.length === 0 ? (\r\n                    <div className=\"p-8 text-center text-slate-500 dark:text-slate-400\">\r\n                      <Bell className=\"w-8 h-8 mx-auto mb-2 opacity-20\" />\r\n                      <p className=\"text-sm\">No notifications yet</p>\r\n                    </div>\r\n                  ) : (\r\n                    notifications.map((notif) => (\r\n                      <div\r\n                        key={notif.id}\r\n                        onClick={() => handleNotificationClick(notif.id, notif.is_read)}\r\n                        className={`p-4 border-b border-slate-100 dark:border-slate-800 hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors cursor-pointer\r\n                          ${!notif.is_read ? 'bg-indigo-50/30 dark:bg-indigo-900/10' : ''}`}\r\n                      >\r\n                        <div className=\"flex gap-3\">\r\n                          <div className={`mt-1 w-8 h-8 rounded-full flex items-center justify-center shrink-0 \r\n                            ${notif.type === 'success' ? 'bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400' :\r\n                              notif.type === 'info' ? 'bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400' :\r\n                                notif.type === 'warning' ? 'bg-yellow-100 text-yellow-600 dark:bg-yellow-900/30 dark:text-yellow-400' :\r\n                                  notif.type === 'error' ? 'bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400' :\r\n                                    'bg-slate-100 text-slate-600'}`}>\r\n                            {notif.type === 'success' ? <CheckCircle2 className=\"w-4 h-4\" /> :\r\n                              notif.type === 'warning' ? <AlertCircle className=\"w-4 h-4\" /> :\r\n                                notif.type === 'error' ? <AlertCircle className=\"w-4 h-4\" /> :\r\n                                  <Info className=\"w-4 h-4\" />}\r\n                          </div>\r\n                          <div className=\"flex-1\">\r\n                            <div className=\"flex justify-between items-start\">\r\n                              <h4 className={`text-sm font-medium ${!notif.is_read ? 'text-slate-900 dark:text-white' : 'text-slate-700 dark:text-slate-300'}`}>\r\n                                {notif.title}\r\n                              </h4>\r\n                              <span className=\"text-[10px] text-slate-400 whitespace-nowrap ml-2\">\r\n                                {new Date(notif.created_at).toLocaleDateString()}\r\n                              </span>\r\n                            </div>\r\n\r\n                            {/* Expandable Message Area */}\r\n                            <div className=\"mt-1\">\r\n                              <p className={`text-xs text-slate-500 dark:text-slate-400 transition-all duration-300 ${expandedNotifId === notif.id ? '' : 'line-clamp-2'}`}>\r\n                                {notif.message}\r\n                              </p>\r\n\r\n                              {/* Show 'Show less' if expanded, or nothing if collapsed (implicit 'Show more' via truncation) */}\r\n                              {expandedNotifId === notif.id && (\r\n                                <span className=\"text-[10px] text-indigo-500 font-medium mt-1 block\">\r\n                                  Show less\r\n                                </span>\r\n                              )}\r\n                            </div>\r\n\r\n                            {notif.link && expandedNotifId === notif.id && (\r\n                              <button\r\n                                onClick={(e) => {\r\n                                  e.stopPropagation();\r\n                                  router.push(notif.link!);\r\n                                  setOpenNotif(false);\r\n                                }}\r\n                                className=\"mt-2 text-xs bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 px-2 py-1 rounded hover:bg-indigo-100 dark:hover:bg-indigo-900/50 transition-colors\"\r\n                              >\r\n                                View Details ‚Üí\r\n                              </button>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    ))\r\n                  )}\r\n                </div>\r\n                <div className=\"p-3 border-t border-slate-100 dark:border-slate-800 text-center\">\r\n                  <button className=\"text-sm text-slate-600 dark:text-slate-400 hover:text-indigo-600 dark:hover:text-indigo-400 font-medium transition-colors\">\r\n                    View All Notifications\r\n                  </button>\r\n                </div>\r\n              </motion.div>\r\n            )}\r\n          </AnimatePresence>\r\n        </div>\r\n\r\n        {/* Profile */}\r\n        <div ref={profileRef} className=\"relative ml-2\">\r\n          <button\r\n            onClick={() => setOpenProfile(!openProfile)}\r\n            className=\"flex items-center gap-3 p-1.5 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 transition-all border border-transparent hover:border-slate-200 dark:hover:border-slate-700\"\r\n          >\r\n            {profile?.avatar_url ? (\r\n              <Image\r\n                src={profile.avatar_url}\r\n                alt={profile?.full_name || \"Profile\"}\r\n                width={32}\r\n                height={32}\r\n                className=\"w-8 h-8 rounded-full object-cover shadow-md\"\r\n                priority\r\n              />\r\n            ) : (\r\n              <div className=\"w-8 h-8 rounded-full bg-linear-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white text-sm font-bold shadow-md\">\r\n                {profile?.full_name?.[0] || \"A\"}\r\n              </div>\r\n            )}\r\n            <div className=\"hidden md:block text-left mr-2\">\r\n              <p className=\"text-sm font-medium text-slate-700 dark:text-slate-200 leading-none\">\r\n                {profile?.full_name || \"Admin\"}\r\n              </p>\r\n              <p className=\"text-[10px] text-slate-500 dark:text-slate-400 mt-1\">\r\n                {profile?.role || \"Administrator\"}\r\n              </p>\r\n            </div>\r\n            <ChevronDown className=\"w-4 h-4 text-slate-400 hidden md:block\" />\r\n          </button>\r\n\r\n          <AnimatePresence>\r\n            {openProfile && (\r\n              <motion.div\r\n                initial={{ opacity: 0, y: 10, scale: 0.95 }}\r\n                animate={{ opacity: 1, y: 0, scale: 1 }}\r\n                exit={{ opacity: 0, y: 10, scale: 0.95 }}\r\n                transition={{ duration: 0.2 }}\r\n                className=\"absolute right-0 top-14 w-64 bg-white dark:bg-slate-900 rounded-2xl shadow-xl border border-slate-200 dark:border-slate-800 overflow-hidden origin-top-right\"\r\n              >\r\n                <div className=\"p-4 border-b border-slate-100 dark:border-slate-800\">\r\n                  <p className=\"font-medium text-slate-900 dark:text-white\">{profile?.full_name}</p>\r\n                  <p className=\"text-xs text-slate-500 dark:text-slate-400 truncate\">{profile?.email}</p>\r\n                </div>\r\n                <div className=\"p-2\">\r\n                  <button\r\n                    onClick={() => {\r\n                      const profilePath = profile?.role === 'student' ? '/student/settings' : '/admin/profile';\r\n                      router.push(profilePath);\r\n                      setOpenProfile(false);\r\n                    }}\r\n                    className=\"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors\"\r\n                  >\r\n                    <User className=\"w-4 h-4\" /> Profile\r\n                  </button>\r\n                  <button\r\n                    onClick={() => {\r\n                      const settingsPath = profile?.role === 'student' ? '/student/settings' : '/admin/settings';\r\n                      router.push(settingsPath);\r\n                      setOpenProfile(false);\r\n                    }}\r\n                    className=\"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors\"\r\n                  >\r\n                    <Settings className=\"w-4 h-4\" /> Settings\r\n                  </button>\r\n                </div>\r\n                <div className=\"p-2 border-t border-slate-100 dark:border-slate-800\">\r\n                  <button\r\n                    onClick={handleLogout}\r\n                    className=\"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors\"\r\n                  >\r\n                    <LogOut className=\"w-4 h-4\" /> Sign Out\r\n                  </button>\r\n                </div>\r\n              </motion.div>\r\n            )}\r\n          </AnimatePresence>\r\n        </div>\r\n      </div>\r\n    </header>\r\n  );\r\n}\r\n\r\nfunction ChevronDown({ className }: { className?: string }) {\r\n  return (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      width=\"24\"\r\n      height=\"24\"\r\n      viewBox=\"0 0 24 24\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      strokeWidth=\"2\"\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      className={className}\r\n    >\r\n      <path d=\"m6 9 6 6 6-6\" />\r\n    </svg>\r\n  );\r\n}\r\n"
        ],
        "names": [],
        "mappings": "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"
      }
    },
    {
      "offset": {
        "line": 3337,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/app/admin/components/layout/MobileNav.tsx"
        ],
        "sourcesContent": [
          "\"use client\";\r\nimport React from \"react\";\r\nimport {\r\n  BookOpen,\r\n  Grid,\r\n  LayoutDashboard,\r\n  Settings,\r\n  Users,\r\n  Home,\r\n  BookCheck,\r\n  Layers,\r\n  Award,\r\n  TrendingUp,\r\n  CreditCard,\r\n  Gift,\r\n  MessageSquare,\r\n  GraduationCap\r\n} from \"lucide-react\";\r\nimport { usePathname } from \"next/navigation\";\r\nimport Link from \"next/link\";\r\nimport { motion } from \"framer-motion\";\r\nimport { useCommunityModal } from \"@/context/CommunityModalContext\";\r\n\r\nconst iconMap = {\r\n  dashboard: LayoutDashboard,\r\n  user: Users,\r\n  home: Home,\r\n  book: BookOpen,\r\n  grid: Grid,\r\n  settings: Settings,\r\n  question: BookCheck,\r\n  layers: Layers,\r\n  graduation: GraduationCap,\r\n  bookopen: BookOpen,\r\n  trendingup: TrendingUp,\r\n  award: Award,\r\n  payment: CreditCard,\r\n  gift: Gift,\r\n  messagesquare: MessageSquare,\r\n};\r\n\r\nexport default function MobileNav({\r\n  theme,\r\n  toggleTheme,\r\n  links,\r\n  profile,\r\n}: {\r\n  theme: string;\r\n  toggleTheme: () => void;\r\n  links: any[];\r\n  profile?: any;\r\n}) {\r\n  const pathname = usePathname();\r\n  const { openCommunity } = useCommunityModal();\r\n\r\n  // Filter links for mobile if needed, or use all. \r\n  // Typically bottom nav has 4-5 items. \r\n  // If many items, maybe show first 4 and a \"More\" or just scroll?\r\n  // User asked for \"same as app\". App has Home, Library, Community, Account.\r\n  // The links prop passed from StudentLayout has: Dashboard, My Courses, All Courses, Community, My Series, Result, Rewards, All Series, Settings.\r\n  // That's too many for a bottom bar.\r\n  // I should filter for the main ones that match the app.\r\n\r\n  const appTabs = [\"Dashboard\", \"My Courses\", \"All Series\", \"Community\", \"Settings\"];\r\n\r\n  // Dynamic filtering:\r\n  const navItems = links?.filter(link => appTabs.includes(link.label)) || [];\r\n\r\n  // Fallback to ensure we have at least these if links are missing/renamed\r\n  // But wait, \"My Courses\" in links has label \"My Courses\".\r\n  // \"Settings\" has label \"Settings\".\r\n  // \"Community\" has label \"Community\".\r\n  // \"Dashboard\" has label \"Dashboard\".\r\n\r\n  const handleItemClick = (item: any) => {\r\n    if (item.onClick === \"openCommunity\") {\r\n      const isAdmin = profile?.role === 'admin' || profile?.role === 'creator';\r\n      openCommunity({ isAdmin });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"md:hidden fixed bottom-0 left-0 right-0 z-50 bg-white/95 dark:bg-slate-900/95 backdrop-blur-xl border-t border-slate-200 dark:border-slate-800 pb-safe\">\r\n      <nav className=\"flex items-center justify-around w-full h-16\">\r\n        {navItems.map((item) => {\r\n          const Icon = iconMap[item.icon as keyof typeof iconMap] || Grid;\r\n          const isActive = pathname === item.href || (item.href !== '#' && pathname.startsWith(item.href));\r\n          const isCommunity = item.label === \"Community\";\r\n\r\n          const content = (\r\n            <div className=\"flex flex-col items-center justify-center w-full h-full gap-1\">\r\n              <div className=\"relative\">\r\n                <Icon\r\n                  className={`w-6 h-6 transition-all duration-300 ${isActive || (isCommunity && false) // Community doesn't have active route usually\r\n                    ? \"text-indigo-600 dark:text-indigo-400\"\r\n                    : \"text-slate-500 dark:text-slate-400\"\r\n                    }`}\r\n                />\r\n                {isActive && (\r\n                  <motion.div\r\n                    layoutId=\"mobileNavDot\"\r\n                    className=\"absolute -bottom-2 left-1/2 -translate-x-1/2 w-1 h-1 bg-indigo-600 rounded-full\"\r\n                  />\r\n                )}\r\n              </div>\r\n              <span\r\n                className={`text-[10px] font-medium transition-colors duration-300 ${isActive\r\n                  ? \"text-indigo-600 dark:text-indigo-400\"\r\n                  : \"text-slate-500 dark:text-slate-400\"\r\n                  }`}\r\n              >\r\n                {item.label === \"My Courses\" ? \"Library\" : item.label === \"Dashboard\" ? \"Home\" : item.label === \"Settings\" ? \"Account\" : item.label}\r\n              </span>\r\n            </div>\r\n          );\r\n\r\n          if (item.onClick === \"openCommunity\") {\r\n            return (\r\n              <button\r\n                key={item.label}\r\n                onClick={() => handleItemClick(item)}\r\n                className=\"flex-1 h-full\"\r\n              >\r\n                {content}\r\n              </button>\r\n            )\r\n          }\r\n\r\n          // Use SPA navigation for student routes\r\n          const isStudentRoute = item.href.startsWith('/student');\r\n\r\n          if (isStudentRoute) {\r\n            return (\r\n              <button\r\n                key={item.label}\r\n                onClick={() => {\r\n                  if (typeof window !== 'undefined' && (window as any).__studentNavigate) {\r\n                    (window as any).__studentNavigate(item.href);\r\n                  } else {\r\n                    window.location.href = item.href;\r\n                  }\r\n                }}\r\n                className=\"flex-1 h-full flex\"\r\n              >\r\n                {content}\r\n              </button>\r\n            );\r\n          }\r\n\r\n          return (\r\n            <Link\r\n              key={item.label}\r\n              href={item.href}\r\n              className=\"flex-1 h-full flex\"\r\n            >\r\n              {content}\r\n            </Link>\r\n          );\r\n        })}\r\n      </nav>\r\n    </div>\r\n  );\r\n}\r\n"
        ],
        "names": [],
        "mappings": "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"
      }
    },
    {
      "offset": {
        "line": 3535,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/ui/button.tsx"
        ],
        "sourcesContent": [
          "import * as React from 'react'\r\nimport { Slot } from '@radix-ui/react-slot'\r\nimport { cva, type VariantProps } from 'class-variance-authority'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nconst buttonVariants = cva(\r\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: 'bg-primary text-primary-foreground hover:bg-primary/90',\r\n        destructive:\r\n          'bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\r\n        outline:\r\n          'border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50',\r\n        secondary:\r\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\r\n        ghost:\r\n          'hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50',\r\n        link: 'text-primary underline-offset-4 hover:underline',\r\n      },\r\n      size: {\r\n        default: 'h-9 px-4 py-2 has-[>svg]:px-3',\r\n        sm: 'h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5',\r\n        lg: 'h-10 rounded-md px-6 has-[>svg]:px-4',\r\n        icon: 'size-9',\r\n        'icon-sm': 'size-8',\r\n        'icon-lg': 'size-10',\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: 'default',\r\n      size: 'default',\r\n    },\r\n  },\r\n)\r\n\r\nfunction Button({\r\n  className,\r\n  variant,\r\n  size,\r\n  asChild = false,\r\n  ...props\r\n}: React.ComponentProps<'button'> &\r\n  VariantProps<typeof buttonVariants> & {\r\n    asChild?: boolean\r\n  }) {\r\n  const Comp = asChild ? Slot : 'button'\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"button\"\r\n      className={cn(buttonVariants({ variant, size, className }))}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Button, buttonVariants }\r\n"
        ],
        "names": [],
        "mappings": ";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,0KAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,2KAAI,GAAG;IAE9B,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf;KAnBS"
      }
    },
    {
      "offset": {
        "line": 3600,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/ui/CourseThumbnail.tsx"
        ],
        "sourcesContent": [
          "import React from \"react\";\r\nimport Image from \"next/image\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\n\r\ninterface CourseThumbnailProps {\r\n    src?: string | null;\r\n    title: string;\r\n    category?: string;\r\n    className?: string;\r\n    priority?: boolean;\r\n    variant?: \"default\" | \"card\";\r\n}\r\n\r\nexport function CourseThumbnail({\r\n    src,\r\n    title,\r\n    category,\r\n    className,\r\n    priority = false,\r\n    variant = \"default\",\r\n}: CourseThumbnailProps) {\r\n    const isCard = variant === \"card\";\r\n\r\n    // Base classes that apply to both\r\n    const baseClasses = \"relative overflow-hidden bg-slate-100 dark:bg-slate-800\";\r\n\r\n    // Default variant specific classes (standalone card look)\r\n    const defaultClasses = \"aspect-video rounded-2xl shadow-md transition-all duration-300 hover:shadow-2xl hover:-translate-y-1\";\r\n\r\n    // Card variant specific classes (fills parent, no external styles)\r\n    const cardClasses = \"w-full h-full\";\r\n\r\n    // Check if we have a valid thumbnail URL (not null, empty, or the string \"NULL\")\r\n    const hasValidThumbnail = src && src !== 'NULL' && src !== 'null' && src.trim() !== '';\r\n\r\n    // If valid thumbnail exists, show it normally\r\n    if (hasValidThumbnail) {\r\n        return (\r\n            <div\r\n                className={cn(\r\n                    baseClasses,\r\n                    isCard ? cardClasses : defaultClasses,\r\n                    className\r\n                )}\r\n            >\r\n                {/* eslint-disable-next-line @next/next/no-img-element */}\r\n                <Image\r\n                    src={src}\r\n                    alt={title}\r\n                    fill\r\n                    className=\"object-cover transition-transform duration-300 hover:scale-105\"\r\n                    priority={priority}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Gradient Based on Title Hash\r\n    const gradients = [\r\n        \"from-indigo-500 via-blue-600 to-sky-700\",\r\n        \"from-emerald-400 via-green-600 to-teal-700\",\r\n        \"from-orange-400 via-red-500 to-rose-600\",\r\n        \"from-fuchsia-500 via-purple-600 to-indigo-700\",\r\n        \"from-cyan-400 via-blue-600 to-slate-700\",\r\n    ];\r\n\r\n    const safeTitle = title || \"Untitled Course\";\r\n    const hash = [...safeTitle].reduce((acc, ch) => acc + ch.charCodeAt(0), 0);\r\n    const gradientIndex = hash % gradients.length;\r\n    const selectedGradient = gradients[gradientIndex];\r\n\r\n    return (\r\n        <div\r\n            className={cn(\r\n                \"relative overflow-hidden bg-linear-to-br\",\r\n                selectedGradient,\r\n                isCard ? \"w-full h-full\" : \"w-full aspect-video rounded-2xl shadow-lg transition-all duration-300 hover:shadow-2xl hover:-translate-y-1\",\r\n                className\r\n            )}\r\n        >\r\n            {/* Glow Blobs */}\r\n            <div className=\"absolute -top-20 -left-20 w-48 h-48 bg-white/10 blur-3xl rounded-full pointer-events-none\" />\r\n            <div className=\"absolute bottom-[-80px] right-[-40px] w-64 h-64 bg-black/20 blur-3xl rounded-full pointer-events-none\" />\r\n\r\n            {/* Abstract Background Pattern */}\r\n            <div className=\"absolute inset-0 opacity-10 pointer-events-none\">\r\n                <svg width=\"100%\" height=\"100%\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                    <defs>\r\n                        <pattern id=\"grid\" width=\"40\" height=\"40\" patternUnits=\"userSpaceOnUse\">\r\n                            <path d=\"M 40 0 L 0 0 0 40\" fill=\"none\" stroke=\"white\" strokeWidth=\"1\" />\r\n                        </pattern>\r\n                    </defs>\r\n                    <rect width=\"100%\" height=\"100%\" fill=\"url(#grid)\" />\r\n                    <circle cx=\"80%\" cy=\"20%\" r=\"100\" fill=\"white\" fillOpacity=\"0.1\" />\r\n                    <circle cx=\"10%\" cy=\"90%\" r=\"60\" fill=\"white\" fillOpacity=\"0.1\" />\r\n                </svg>\r\n            </div>\r\n\r\n            {/* Subtle Math Pattern */}\r\n            <div className=\"absolute inset-0 opacity-15\">\r\n                <svg width=\"100%\" height=\"100%\">\r\n                    <defs>\r\n                        <pattern id=\"pattern\" width=\"36\" height=\"36\" patternUnits=\"userSpaceOnUse\">\r\n                            <path d=\"M 36 0 L 0 0 0 36\" fill=\"none\" stroke=\"white\" strokeWidth=\"0.8\" />\r\n                        </pattern>\r\n                    </defs>\r\n                    <rect width=\"100%\" height=\"100%\" fill=\"url(#pattern)\" />\r\n                </svg>\r\n            </div>\r\n\r\n            {/* Glass Effect Overlay */}\r\n            <div className=\"absolute inset-[12px] rounded-2xl bg-white/10 backdrop-blur-lg flex flex-col justify-between p-4\">\r\n\r\n                {/* Top Row: Category + Logo */}\r\n                <div className=\"flex items-start justify-between\">\r\n                    {category && (\r\n                        <span className=\"text-white/90 text-[10px] tracking-widest uppercase rounded-full px-2 py-1 bg-white/15 backdrop-blur-sm\">\r\n                            {category}\r\n                        </span>\r\n                    )}\r\n\r\n                    {/* ‚ú® Premium math4code Text Logo */}\r\n                    <div className=\"px-2.5 py-1.5 rounded-lg bg-white/20 backdrop-blur-md text-white font-extrabold text-xs tracking-widest drop-shadow-[0_1px_3px_rgba(0,0,0,0.4)]\">\r\n                        math4code\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Title */}\r\n                <div className=\"flex items-end justify-between\">\r\n                    <h3 className=\"text-lg md:text-xl font-bold text-white leading-tight line-clamp-3 drop-shadow-md\">\r\n                        {safeTitle}\r\n                    </h3>\r\n\r\n                    <span className=\"text-5xl text-white/20 font-serif italic select-none\">‚à´</span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;;AACA;AACA;;;;AAYO,SAAS,gBAAgB,EAC5B,GAAG,EACH,KAAK,EACL,QAAQ,EACR,SAAS,EACT,WAAW,KAAK,EAChB,UAAU,SAAS,EACA;IACnB,MAAM,SAAS,YAAY;IAE3B,kCAAkC;IAClC,MAAM,cAAc;IAEpB,0DAA0D;IAC1D,MAAM,iBAAiB;IAEvB,mEAAmE;IACnE,MAAM,cAAc;IAEpB,iFAAiF;IACjF,MAAM,oBAAoB,OAAO,QAAQ,UAAU,QAAQ,UAAU,IAAI,IAAI,OAAO;IAEpF,8CAA8C;IAC9C,IAAI,mBAAmB;QACnB,qBACI,6LAAC;YACG,WAAW,IAAA,qHAAE,EACT,aACA,SAAS,cAAc,gBACvB;sBAIJ,cAAA,6LAAC,2IAAK;gBACF,KAAK;gBACL,KAAK;gBACL,IAAI;gBACJ,WAAU;gBACV,UAAU;;;;;;;;;;;IAI1B;IAEA,+BAA+B;IAC/B,MAAM,YAAY;QACd;QACA;QACA;QACA;QACA;KACH;IAED,MAAM,YAAY,SAAS;IAC3B,MAAM,OAAO;WAAI;KAAU,CAAC,MAAM,CAAC,CAAC,KAAK,KAAO,MAAM,GAAG,UAAU,CAAC,IAAI;IACxE,MAAM,gBAAgB,OAAO,UAAU,MAAM;IAC7C,MAAM,mBAAmB,SAAS,CAAC,cAAc;IAEjD,qBACI,6LAAC;QACG,WAAW,IAAA,qHAAE,EACT,4CACA,kBACA,SAAS,kBAAkB,+GAC3B;;0BAIJ,6LAAC;gBAAI,WAAU;;;;;;0BACf,6LAAC;gBAAI,WAAU;;;;;;0BAGf,6LAAC;gBAAI,WAAU;0BACX,cAAA,6LAAC;oBAAI,OAAM;oBAAO,QAAO;oBAAO,OAAM;;sCAClC,6LAAC;sCACG,cAAA,6LAAC;gCAAQ,IAAG;gCAAO,OAAM;gCAAK,QAAO;gCAAK,cAAa;0CACnD,cAAA,6LAAC;oCAAK,GAAE;oCAAoB,MAAK;oCAAO,QAAO;oCAAQ,aAAY;;;;;;;;;;;;;;;;sCAG3E,6LAAC;4BAAK,OAAM;4BAAO,QAAO;4BAAO,MAAK;;;;;;sCACtC,6LAAC;4BAAO,IAAG;4BAAM,IAAG;4BAAM,GAAE;4BAAM,MAAK;4BAAQ,aAAY;;;;;;sCAC3D,6LAAC;4BAAO,IAAG;4BAAM,IAAG;4BAAM,GAAE;4BAAK,MAAK;4BAAQ,aAAY;;;;;;;;;;;;;;;;;0BAKlE,6LAAC;gBAAI,WAAU;0BACX,cAAA,6LAAC;oBAAI,OAAM;oBAAO,QAAO;;sCACrB,6LAAC;sCACG,cAAA,6LAAC;gCAAQ,IAAG;gCAAU,OAAM;gCAAK,QAAO;gCAAK,cAAa;0CACtD,cAAA,6LAAC;oCAAK,GAAE;oCAAoB,MAAK;oCAAO,QAAO;oCAAQ,aAAY;;;;;;;;;;;;;;;;sCAG3E,6LAAC;4BAAK,OAAM;4BAAO,QAAO;4BAAO,MAAK;;;;;;;;;;;;;;;;;0BAK9C,6LAAC;gBAAI,WAAU;;kCAGX,6LAAC;wBAAI,WAAU;;4BACV,0BACG,6LAAC;gCAAK,WAAU;0CACX;;;;;;0CAKT,6LAAC;gCAAI,WAAU;0CAAkJ;;;;;;;;;;;;kCAMrK,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAG,WAAU;0CACT;;;;;;0CAGL,6LAAC;gCAAK,WAAU;0CAAuD;;;;;;;;;;;;;;;;;;;;;;;;AAK3F;KA7HgB"
      }
    },
    {
      "offset": {
        "line": 3875,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/hooks/community/useMessages.ts"
        ],
        "sourcesContent": [
          "import { useInfiniteQuery, useQueryClient } from \"@tanstack/react-query\";\r\nimport { useEffect } from \"react\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\nimport { CommunityMessage } from \"@/types/community\";\r\n\r\nconst supabase = createClient();\r\n\r\nexport const useChannelMessages = (channelId: string) => {\r\n  const query = useInfiniteQuery({\r\n    queryKey: [\"community\", \"messages\", channelId],\r\n    queryFn: async ({ pageParam = 0 }) => {\r\n      const pageSize = 20; // Reduced from 50 for performance\r\n      const start = pageParam * pageSize;\r\n      const end = start + pageSize - 1;\r\n\r\n      const { data, error } = await supabase\r\n        .from(\"community_messages\")\r\n        .select(`\r\n          id,\r\n          content,\r\n          created_at,\r\n          user_id,\r\n          channel_id,\r\n          attachments,\r\n          is_pinned,\r\n          is_announcement,\r\n          parent_message_id,\r\n          profiles:user_id (\r\n            full_name,\r\n            avatar_url,\r\n            role\r\n          ),\r\n          community_reactions!message_id (\r\n            id,\r\n            emoji,\r\n            user_id\r\n          ),\r\n          community_bookmarks!message_id (\r\n            id,\r\n            user_id\r\n          )\r\n        `)\r\n        .eq(\"channel_id\", channelId)\r\n        .order(\"created_at\", { ascending: false })\r\n        .range(start, end);\r\n\r\n      if (error) {\r\n        throw error;\r\n      }\r\n\r\n      return data as unknown as CommunityMessage[];\r\n    },\r\n    initialPageParam: 0,\r\n    getNextPageParam: (lastPage, allPages) => {\r\n      return lastPage.length === 20 ? allPages.length : undefined;\r\n    },\r\n    enabled: !!channelId,\r\n    staleTime: 1000 * 60, // 1 minute stale time\r\n    gcTime: 1000 * 60 * 30, // 30 minutes garbage collection\r\n    refetchOnWindowFocus: false, // Prevent jarring refetch of chat on focus\r\n  });\r\n\r\n  // Real-time subscription\r\n  const queryClient = useQueryClient();\r\n  useEffect(() => {\r\n    if (!channelId) return;\r\n\r\n    const channel = supabase\r\n      .channel(`community_messages:${channelId}`)\r\n      .on(\r\n        \"postgres_changes\",\r\n        {\r\n          event: \"INSERT\",\r\n          schema: \"public\",\r\n          table: \"community_messages\",\r\n          filter: `channel_id=eq.${channelId}`,\r\n        },\r\n        async (payload) => {\r\n          // Fetch the complete message with profile\r\n          const { data: newMessage, error } = await supabase\r\n            .from(\"community_messages\")\r\n            .select(`\r\n                id,\r\n                content,\r\n                created_at,\r\n                user_id,\r\n                channel_id,\r\n                attachments,\r\n                is_pinned,\r\n                is_announcement,\r\n                parent_message_id,\r\n                profiles:user_id (\r\n                    full_name,\r\n                    avatar_url,\r\n                    role\r\n                ),\r\n                community_reactions!message_id (\r\n                    id,\r\n                    emoji,\r\n                    user_id\r\n                )\r\n            `)\r\n            .eq(\"id\", payload.new.id)\r\n            .single();\r\n\r\n          if (error) {\r\n            return;\r\n          }\r\n\r\n          if (newMessage) {\r\n            queryClient.setQueryData([\"community\", \"messages\", channelId], (old: any) => {\r\n              if (!old) return { pages: [[newMessage]], pageParams: [0] };\r\n\r\n              // Check if message already exists (optimistic update)\r\n              const exists = old.pages[0].some((m: any) =>\r\n                m.id === newMessage.id ||\r\n                (m.id.startsWith('temp-') && m.content === newMessage.content && m.user_id === newMessage.user_id)\r\n              );\r\n\r\n              if (exists) {\r\n                return old;\r\n              }\r\n\r\n              const newPages = [...old.pages];\r\n              newPages[0] = [newMessage, ...newPages[0]];\r\n              return { ...old, pages: newPages };\r\n            });\r\n          }\r\n        }\r\n      )\r\n      .subscribe();\r\n\r\n    return () => {\r\n      supabase.removeChannel(channel);\r\n    };\r\n  }, [channelId, queryClient]);\r\n\r\n  return query;\r\n};\r\n"
        ],
        "names": [],
        "mappings": ";;;;AAAA;AAAA;AACA;AACA;;;;;AAGA,MAAM,WAAW,IAAA,4IAAY;AAEtB,MAAM,qBAAqB,CAAC;;IACjC,MAAM,QAAQ,IAAA,0MAAgB,EAAC;QAC7B,UAAU;YAAC;YAAa;YAAY;SAAU;QAC9C,OAAO;0DAAE,OAAO,EAAE,YAAY,CAAC,EAAE;gBAC/B,MAAM,WAAW,IAAI,kCAAkC;gBACvD,MAAM,QAAQ,YAAY;gBAC1B,MAAM,MAAM,QAAQ,WAAW;gBAE/B,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,sBACL,MAAM,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;QAwBT,CAAC,EACA,EAAE,CAAC,cAAc,WACjB,KAAK,CAAC,cAAc;oBAAE,WAAW;gBAAM,GACvC,KAAK,CAAC,OAAO;gBAEhB,IAAI,OAAO;oBACT,MAAM;gBACR;gBAEA,OAAO;YACT;;QACA,kBAAkB;QAClB,gBAAgB;0DAAE,CAAC,UAAU;gBAC3B,OAAO,SAAS,MAAM,KAAK,KAAK,SAAS,MAAM,GAAG;YACpD;;QACA,SAAS,CAAC,CAAC;QACX,WAAW,OAAO;QAClB,QAAQ,OAAO,KAAK;QACpB,sBAAsB;IACxB;IAEA,yBAAyB;IACzB,MAAM,cAAc,IAAA,2MAAc;IAClC,IAAA,0KAAS;wCAAC;YACR,IAAI,CAAC,WAAW;YAEhB,MAAM,UAAU,SACb,OAAO,CAAC,CAAC,mBAAmB,EAAE,WAAW,EACzC,EAAE,CACD,oBACA;gBACE,OAAO;gBACP,QAAQ;gBACR,OAAO;gBACP,QAAQ,CAAC,cAAc,EAAE,WAAW;YACtC;wDACA,OAAO;oBACL,0CAA0C;oBAC1C,MAAM,EAAE,MAAM,UAAU,EAAE,KAAK,EAAE,GAAG,MAAM,SACvC,IAAI,CAAC,sBACL,MAAM,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;YAoBT,CAAC,EACA,EAAE,CAAC,MAAM,QAAQ,GAAG,CAAC,EAAE,EACvB,MAAM;oBAET,IAAI,OAAO;wBACT;oBACF;oBAEA,IAAI,YAAY;wBACd,YAAY,YAAY,CAAC;4BAAC;4BAAa;4BAAY;yBAAU;oEAAE,CAAC;gCAC9D,IAAI,CAAC,KAAK,OAAO;oCAAE,OAAO;wCAAC;4CAAC;yCAAW;qCAAC;oCAAE,YAAY;wCAAC;qCAAE;gCAAC;gCAE1D,sDAAsD;gCACtD,MAAM,SAAS,IAAI,KAAK,CAAC,EAAE,CAAC,IAAI;mFAAC,CAAC,IAChC,EAAE,EAAE,KAAK,WAAW,EAAE,IACrB,EAAE,EAAE,CAAC,UAAU,CAAC,YAAY,EAAE,OAAO,KAAK,WAAW,OAAO,IAAI,EAAE,OAAO,KAAK,WAAW,OAAO;;gCAGnG,IAAI,QAAQ;oCACV,OAAO;gCACT;gCAEA,MAAM,WAAW;uCAAI,IAAI,KAAK;iCAAC;gCAC/B,QAAQ,CAAC,EAAE,GAAG;oCAAC;uCAAe,QAAQ,CAAC,EAAE;iCAAC;gCAC1C,OAAO;oCAAE,GAAG,GAAG;oCAAE,OAAO;gCAAS;4BACnC;;oBACF;gBACF;uDAED,SAAS;YAEZ;gDAAO;oBACL,SAAS,aAAa,CAAC;gBACzB;;QACF;uCAAG;QAAC;QAAW;KAAY;IAE3B,OAAO;AACT;GAnIa;;QACG,0MAAgB;QAuDV,2MAAc"
      }
    },
    {
      "offset": {
        "line": 4047,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/hooks/community/useChannels.ts"
        ],
        "sourcesContent": [
          "import { useQuery } from \"@tanstack/react-query\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\nimport { CommunityChannel } from \"@/types/community\";\r\n\r\n// Extended interface to include metadata\r\ninterface ChannelWithMeta extends CommunityChannel {\r\n    last_message_content?: string;\r\n    last_message_time?: string;\r\n    last_message_user?: string;\r\n}\r\n\r\nconst supabase = createClient();\r\n\r\nexport const useChannels = (courseId: string) => {\r\n    return useQuery<ChannelWithMeta[]>({\r\n        queryKey: [\"community\", \"channels\", courseId],\r\n        queryFn: async () => {\r\n            // Use the Optimized RPC for fast loading\r\n            const { data, error } = await supabase\r\n                .rpc('get_channels_with_meta', { target_course_id: courseId });\r\n\r\n            if (error) {\r\n                throw error;\r\n            }\r\n\r\n            return data as ChannelWithMeta[];\r\n        },\r\n        enabled: !!courseId\r\n    });\r\n};\r\n"
        ],
        "names": [],
        "mappings": ";;;;AAAA;AACA;;;;AAUA,MAAM,WAAW,IAAA,4IAAY;AAEtB,MAAM,cAAc,CAAC;;IACxB,OAAO,IAAA,0LAAQ,EAAoB;QAC/B,UAAU;YAAC;YAAa;YAAY;SAAS;QAC7C,OAAO;oCAAE;gBACL,yCAAyC;gBACzC,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SACzB,GAAG,CAAC,0BAA0B;oBAAE,kBAAkB;gBAAS;gBAEhE,IAAI,OAAO;oBACP,MAAM;gBACV;gBAEA,OAAO;YACX;;QACA,SAAS,CAAC,CAAC;IACf;AACJ;GAhBa;;QACF,0LAAQ"
      }
    },
    {
      "offset": {
        "line": 4092,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/hooks/community/useEnrolledCourses.ts"
        ],
        "sourcesContent": [
          "import { useQuery } from \"@tanstack/react-query\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\nimport { CommunityChannel } from \"@/types/community\";\r\n\r\nconst supabase = createClient();\r\n\r\nexport interface EnrolledCourseWithChannels {\r\n    id: string;\r\n    title: string;\r\n    thumbnail_url: string | null;\r\n    community_enabled: boolean;\r\n    channels: CommunityChannel[];\r\n}\r\n\r\nexport const useEnrolledCourses = (userId?: string) => {\r\n    return useQuery({\r\n        queryKey: [\"enrolled-courses\", userId],\r\n        queryFn: async () => {\r\n            if (!userId) throw new Error(\"User ID is required\");\r\n\r\n            // Fetch enrollments with course details\r\n            const { data: enrollments, error: enrollmentsError } = await supabase\r\n                .from(\"enrollments\")\r\n                .select(`\r\n          course_id,\r\n          courses (\r\n            id,\r\n            title,\r\n            thumbnail_url,\r\n            community_enabled\r\n          )\r\n        `)\r\n                .eq(\"user_id\", userId);\r\n\r\n            if (enrollmentsError) throw enrollmentsError;\r\n\r\n            // Filter courses with community enabled\r\n            const coursesWithCommunity = enrollments\r\n                ?.map((e: any) => e.courses)\r\n                .filter((c: any) => c && c.community_enabled) || [];\r\n\r\n            // Fetch channels for each course\r\n            const coursesWithChannels = await Promise.all(\r\n                coursesWithCommunity.map(async (course: any) => {\r\n                    const { data: channels } = await supabase\r\n                        .from(\"community_channels\")\r\n                        .select(\"*\")\r\n                        .eq(\"course_id\", course.id)\r\n                        .order(\"created_at\", { ascending: true });\r\n\r\n                    return {\r\n                        ...course,\r\n                        channels: channels || [],\r\n                    };\r\n                })\r\n            );\r\n\r\n            return coursesWithChannels as EnrolledCourseWithChannels[];\r\n        },\r\n        enabled: !!userId,\r\n    });\r\n};\r\n"
        ],
        "names": [],
        "mappings": ";;;;AAAA;AACA;;;;AAGA,MAAM,WAAW,IAAA,4IAAY;AAUtB,MAAM,qBAAqB,CAAC;;IAC/B,OAAO,IAAA,0LAAQ,EAAC;QACZ,UAAU;YAAC;YAAoB;SAAO;QACtC,OAAO;2CAAE;gBACL,IAAI,CAAC,QAAQ,MAAM,IAAI,MAAM;gBAE7B,wCAAwC;gBACxC,MAAM,EAAE,MAAM,WAAW,EAAE,OAAO,gBAAgB,EAAE,GAAG,MAAM,SACxD,IAAI,CAAC,eACL,MAAM,CAAC,CAAC;;;;;;;;QAQjB,CAAC,EACQ,EAAE,CAAC,WAAW;gBAEnB,IAAI,kBAAkB,MAAM;gBAE5B,wCAAwC;gBACxC,MAAM,uBAAuB,aACvB;mDAAI,CAAC,IAAW,EAAE,OAAO;kDAC1B;mDAAO,CAAC,IAAW,KAAK,EAAE,iBAAiB;qDAAK,EAAE;gBAEvD,iCAAiC;gBACjC,MAAM,sBAAsB,MAAM,QAAQ,GAAG,CACzC,qBAAqB,GAAG;mDAAC,OAAO;wBAC5B,MAAM,EAAE,MAAM,QAAQ,EAAE,GAAG,MAAM,SAC5B,IAAI,CAAC,sBACL,MAAM,CAAC,KACP,EAAE,CAAC,aAAa,OAAO,EAAE,EACzB,KAAK,CAAC,cAAc;4BAAE,WAAW;wBAAK;wBAE3C,OAAO;4BACH,GAAG,MAAM;4BACT,UAAU,YAAY,EAAE;wBAC5B;oBACJ;;gBAGJ,OAAO;YACX;;QACA,SAAS,CAAC,CAAC;IACf;AACJ;GA/Ca;;QACF,0LAAQ"
      }
    },
    {
      "offset": {
        "line": 4159,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/hooks/community/useActions.ts"
        ],
        "sourcesContent": [
          "import { useMutation, useQueryClient } from \"@tanstack/react-query\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\nimport { toast } from \"sonner\";\r\n\r\nconst supabase = createClient();\r\n\r\nexport const useSendMessage = (channelId: string) => {\r\n    const queryClient = useQueryClient();\r\n\r\n    return useMutation({\r\n        mutationFn: async ({ content, attachments = [] }: { content: string; attachments?: any[] }) => {\r\n            const { data: { user } } = await supabase.auth.getUser();\r\n            if (!user) {\r\n                throw new Error(\"Not authenticated\");\r\n            }\r\n\r\n            const { data, error } = await supabase\r\n                .from(\"community_messages\")\r\n                .insert({\r\n                    channel_id: channelId,\r\n                    user_id: user.id,\r\n                    content,\r\n                    attachments,\r\n                })\r\n                .select(`\r\n                    *,\r\n                    profiles!user_id (\r\n                        full_name,\r\n                        avatar_url,\r\n                        role\r\n                    )\r\n                `)\r\n                .single();\r\n\r\n            if (error) {\r\n                throw error;\r\n            }\r\n\r\n            return data;\r\n        },\r\n        onMutate: async ({ content, attachments = [] }) => {\r\n            await queryClient.cancelQueries({ queryKey: [\"community\", \"messages\", channelId] });\r\n\r\n            const previousMessages = queryClient.getQueryData([\"community\", \"messages\", channelId]);\r\n\r\n            const { data: { user } } = await supabase.auth.getUser();\r\n            if (!user) return { previousMessages };\r\n\r\n            // Fetch user profile for optimistic message\r\n            const { data: profile } = await supabase\r\n                .from(\"profiles\")\r\n                .select(\"full_name, avatar_url, role\")\r\n                .eq(\"id\", user.id)\r\n                .single();\r\n\r\n            const optimisticMessage = {\r\n                id: `temp-${Date.now()}`,\r\n                content,\r\n                channel_id: channelId,\r\n                user_id: user.id,\r\n                created_at: new Date().toISOString(),\r\n                updated_at: new Date().toISOString(),\r\n                attachments,\r\n                is_pinned: false,\r\n                is_announcement: false,\r\n                parent_message_id: null,\r\n                profiles: profile || {\r\n                    full_name: user.user_metadata.full_name || \"You\",\r\n                    avatar_url: user.user_metadata.avatar_url,\r\n                    role: user.user_metadata.role || \"student\",\r\n                },\r\n                community_reactions: [],\r\n            };\r\n\r\n            queryClient.setQueryData([\"community\", \"messages\", channelId], (old: any) => {\r\n                if (!old) return { pages: [[optimisticMessage]], pageParams: [0] };\r\n\r\n                const newPages = [...old.pages];\r\n                newPages[0] = [optimisticMessage, ...newPages[0]];\r\n\r\n                return {\r\n                    ...old,\r\n                    pages: newPages,\r\n                };\r\n            });\r\n\r\n            return { previousMessages };\r\n        },\r\n        onSuccess: () => {\r\n            toast.success(\"Message sent!\");\r\n        },\r\n        onError: (error: any, _, context) => {\r\n            if (context?.previousMessages) {\r\n                queryClient.setQueryData([\"community\", \"messages\", channelId], context.previousMessages);\r\n            }\r\n\r\n            const errorMessage = error.message || \"Failed to send message\";\r\n            toast.error(errorMessage);\r\n        },\r\n        onSettled: () => {\r\n            queryClient.invalidateQueries({ queryKey: [\"community\", \"messages\", channelId] });\r\n        },\r\n    });\r\n};\r\n\r\nexport const useToggleReaction = () => {\r\n    const queryClient = useQueryClient();\r\n\r\n    return useMutation({\r\n        mutationFn: async ({ messageId, emoji }: { messageId: string; emoji: string }) => {\r\n            const { data: { user } } = await supabase.auth.getUser();\r\n            if (!user) throw new Error(\"Not authenticated\");\r\n\r\n            // Check if reaction exists\r\n            const { data: existing } = await supabase\r\n                .from(\"community_reactions\")\r\n                .select(\"id\")\r\n                .eq(\"message_id\", messageId)\r\n                .eq(\"user_id\", user.id)\r\n                .eq(\"emoji\", emoji)\r\n                .single();\r\n\r\n            if (existing) {\r\n                // Remove reaction\r\n                const { error } = await supabase\r\n                    .from(\"community_reactions\")\r\n                    .delete()\r\n                    .eq(\"id\", existing.id);\r\n                if (error) throw error;\r\n            } else {\r\n                // Add reaction\r\n                const { error } = await supabase\r\n                    .from(\"community_reactions\")\r\n                    .insert({\r\n                        message_id: messageId,\r\n                        user_id: user.id,\r\n                        emoji,\r\n                    });\r\n                if (error) throw error;\r\n            }\r\n        },\r\n        onSuccess: (_, { messageId }) => {\r\n            // Invalidate specific message or channel messages\r\n            queryClient.invalidateQueries({ queryKey: [\"community\", \"messages\"] });\r\n        },\r\n        onError: () => {\r\n            toast.error(\"Failed to update reaction\");\r\n        }\r\n    });\r\n};\r\n"
        ],
        "names": [],
        "mappings": "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"
      }
    },
    {
      "offset": {
        "line": 4368,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/hooks/community/useBookmarks.ts"
        ],
        "sourcesContent": [
          "import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { createClient } from '@/lib/supabase/client';\r\nimport { toast } from '@/hooks/use-toast';\r\n\r\nexport const useMentions = () => {\r\n    return useQuery({\r\n        queryKey: ['community', 'mentions'],\r\n        queryFn: async () => {\r\n            const supabase = createClient();\r\n            const { data: { user } } = await supabase.auth.getUser();\r\n            if (!user) throw new Error('Not authenticated');\r\n\r\n            // Get user's name to search for mentions\r\n            const { data: profile } = await supabase\r\n                .from('profiles')\r\n                .select('full_name')\r\n                .eq('id', user.id)\r\n                .single();\r\n\r\n            if (!profile?.full_name) return [];\r\n\r\n            // Search for messages that mention the user\r\n            const { data, error } = await supabase\r\n                .from('community_messages')\r\n                .select(`\r\n                    *,\r\n                    profiles!user_id (\r\n                        full_name,\r\n                        avatar_url,\r\n                        role\r\n                    ),\r\n                    community_reactions (\r\n                        id,\r\n                        emoji,\r\n                        user_id\r\n                    ),\r\n                    community_bookmarks (\r\n                        id,\r\n                        user_id\r\n                    ),\r\n                    community_channels!channel_id (\r\n                        id,\r\n                        name,\r\n                        course_id,\r\n                        courses (\r\n                            id,\r\n                            title\r\n                        )\r\n                    )\r\n                `)\r\n                .ilike('content', `%@${profile.full_name}%`)\r\n                .order('created_at', { ascending: false })\r\n                .limit(50);\r\n\r\n            if (error) throw error;\r\n            return data || [];\r\n        },\r\n    });\r\n};\r\n\r\nexport const useBookmarkedMessages = () => {\r\n    return useQuery({\r\n        queryKey: ['community', 'bookmarks'],\r\n        queryFn: async () => {\r\n            const supabase = createClient();\r\n            const { data: { user } } = await supabase.auth.getUser();\r\n            if (!user) throw new Error('Not authenticated');\r\n\r\n            const { data, error } = await supabase\r\n                .from('community_bookmarks')\r\n                .select(`\r\n                    id,\r\n                    created_at,\r\n                    community_messages (\r\n                        id,\r\n                        content,\r\n                        created_at,\r\n                        channel_id,\r\n                        user_id,\r\n                        is_pinned,\r\n                        is_announcement,\r\n                        profiles:user_id (\r\n                            full_name,\r\n                            avatar_url,\r\n                            role\r\n                        ),\r\n                        community_reactions (\r\n                            id,\r\n                            emoji,\r\n                            user_id\r\n                        ),\r\n                        community_bookmarks (\r\n                            id,\r\n                            user_id\r\n                        ),\r\n                        community_channels (\r\n                            id,\r\n                            name,\r\n                            course_id,\r\n                            courses (\r\n                                id,\r\n                                title\r\n                            )\r\n                        )\r\n                    )\r\n                `)\r\n                .eq('user_id', user.id)\r\n                .order('created_at', { ascending: false });\r\n\r\n            if (error) throw error;\r\n\r\n            // Transform data to include message details\r\n            return data?.map((bookmark: any) => ({\r\n                bookmarkId: bookmark.id,\r\n                bookmarkedAt: bookmark.created_at,\r\n                message: bookmark.community_messages,\r\n            })) || [];\r\n        },\r\n    });\r\n};\r\n\r\nexport const useToggleBookmark = (channelId?: string) => {\r\n    const queryClient = useQueryClient();\r\n\r\n    return useMutation({\r\n        mutationFn: async ({ messageId, isBookmarked }: { messageId: string; isBookmarked: boolean }) => {\r\n            const supabase = createClient();\r\n            const { data: { user } } = await supabase.auth.getUser();\r\n            if (!user) throw new Error('Not authenticated');\r\n\r\n            if (isBookmarked) {\r\n                // Remove bookmark\r\n                const { error } = await supabase\r\n                    .from('community_bookmarks')\r\n                    .delete()\r\n                    .eq('user_id', user.id)\r\n                    .eq('message_id', messageId);\r\n\r\n                if (error) throw error;\r\n                return { action: 'removed' };\r\n            } else {\r\n                // Add bookmark - check if it already exists first\r\n                const { data: existing } = await supabase\r\n                    .from('community_bookmarks')\r\n                    .select('id')\r\n                    .eq('user_id', user.id)\r\n                    .eq('message_id', messageId)\r\n                    .single();\r\n\r\n                if (existing) {\r\n                    return { action: 'added' };\r\n                }\r\n\r\n                const { error } = await supabase\r\n                    .from('community_bookmarks')\r\n                    .insert({\r\n                        user_id: user.id,\r\n                        message_id: messageId,\r\n                    });\r\n\r\n                if (error) {\r\n                    if (error.code === '23505') {\r\n                        return { action: 'added' };\r\n                    }\r\n                    throw error;\r\n                }\r\n                return { action: 'added' };\r\n            }\r\n        },\r\n        onSuccess: (data) => {\r\n            // Invalidate all message queries\r\n            if (channelId) {\r\n                queryClient.invalidateQueries({ queryKey: ['community', 'messages', channelId] });\r\n            }\r\n            queryClient.invalidateQueries({ queryKey: ['community', 'bookmarks'] });\r\n            queryClient.invalidateQueries({ queryKey: ['community', 'messages'] });\r\n\r\n            toast({\r\n                title: data.action === 'added' ? 'Message bookmarked' : 'Bookmark removed',\r\n                description: data.action === 'added' ? 'Message saved to bookmarks' : 'Message removed from bookmarks',\r\n            });\r\n        },\r\n        onError: (error) => {\r\n            toast({\r\n                title: 'Failed to update bookmark',\r\n                description: error instanceof Error ? error.message : 'Unknown error',\r\n                variant: 'destructive',\r\n            });\r\n        },\r\n    });\r\n};\r\n"
        ],
        "names": [],
        "mappings": "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"
      }
    },
    {
      "offset": {
        "line": 4604,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/hooks/community/index.ts"
        ],
        "sourcesContent": [
          "export { useChannelMessages } from './useMessages';\r\nexport { useChannels } from './useChannels';\r\nexport { useEnrolledCourses } from './useEnrolledCourses';\r\nexport { useToggleReaction, useSendMessage } from './useActions';\r\nexport { useMentions, useBookmarkedMessages, useToggleBookmark } from './useBookmarks';\r\n"
        ],
        "names": [],
        "mappings": ";AAAA;AACA;AACA;AACA;AACA"
      }
    },
    {
      "offset": {
        "line": 4622,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/community/ChannelSidebar.tsx"
        ],
        "sourcesContent": [
          "import { CommunityChannel } from \"@/types/community\";\r\nimport { Hash, Volume2, HelpCircle, MessageSquare, X, ChevronDown, ChevronRight, Bookmark, AtSign, Settings } from \"lucide-react\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { CourseThumbnail } from \"@/components/ui/CourseThumbnail\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport type { EnrolledCourseWithChannels } from \"@/hooks/community/useEnrolledCourses\";\r\nimport { useMentions, useBookmarkedMessages } from \"@/hooks/community\";\r\n\r\ninterface ChannelSidebarProps {\r\n    channels: CommunityChannel[];\r\n    activeChannelId: string | null;\r\n    onSelectChannel: (channelId: string) => void;\r\n    courseId: string;\r\n    enrolledCourses: EnrolledCourseWithChannels[];\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    isAdmin?: boolean;\r\n    onViewChange?: (view: 'channels' | 'mentions' | 'bookmarks') => void;\r\n    onSelectCourse?: (courseId: string) => void;\r\n}\r\n\r\nexport const ChannelSidebar = ({\r\n    channels,\r\n    activeChannelId,\r\n    onSelectChannel,\r\n    courseId,\r\n    enrolledCourses,\r\n    isOpen,\r\n    onClose,\r\n    isAdmin = false,\r\n    onViewChange,\r\n    onSelectCourse,\r\n}: ChannelSidebarProps) => {\r\n    const router = useRouter();\r\n    const [expandedCourses, setExpandedCourses] = useState<Set<string>>(new Set([courseId]));\r\n\r\n    const getIcon = (type: string) => {\r\n        switch (type) {\r\n            case \"announcement\":\r\n                return <Volume2 className=\"w-4 h-4\" />;\r\n            case \"qa\":\r\n                return <HelpCircle className=\"w-4 h-4\" />;\r\n            default:\r\n                return <Hash className=\"w-4 h-4\" />;\r\n        }\r\n    };\r\n\r\n\r\n    const toggleCourse = (id: string) => {\r\n        const newExpanded = new Set(expandedCourses);\r\n        if (newExpanded.has(id)) {\r\n            newExpanded.delete(id);\r\n        } else {\r\n            newExpanded.add(id);\r\n        }\r\n        setExpandedCourses(newExpanded);\r\n    };\r\n\r\n    // Toggle course expansion and handle selection\r\n    const handleCourseClick = (id: string) => {\r\n        onSelectCourse?.(id);\r\n        toggleCourse(id);\r\n    };\r\n\r\n    // Auto-expand course when a channel from it is selected\r\n    useEffect(() => {\r\n        if (activeChannelId) {\r\n            const channelCourse = enrolledCourses.find(course =>\r\n                course.channels?.some(ch => ch.id === activeChannelId)\r\n            );\r\n            if (channelCourse && !expandedCourses.has(channelCourse.id)) {\r\n                toggleCourse(channelCourse.id);\r\n            }\r\n        }\r\n    }, [activeChannelId, enrolledCourses]);\r\n\r\n\r\n    return (\r\n        <>\r\n            {/* Mobile Backdrop */}\r\n            {isOpen && (\r\n                <div\r\n                    className=\"fixed inset-0 bg-black/60 z-40 md:hidden backdrop-blur-sm\"\r\n                    onClick={onClose}\r\n                />\r\n            )}\r\n\r\n            {/* Sidebar */}\r\n            <div\r\n                className={cn(\r\n                    \"w-72 border-r border-slate-200/80 dark:border-slate-800/80 h-full flex flex-col bg-white/95 dark:bg-slate-900/95 backdrop-blur-xl transition-transform duration-300 z-50 shadow-xl\",\r\n                    // Mobile: slide-in drawer\r\n                    \"fixed md:relative inset-y-0 left-0\",\r\n                    isOpen ? \"translate-x-0\" : \"-translate-x-full md:translate-x-0\"\r\n                )}\r\n            >\r\n                {/* Header */}\r\n                <div className=\"p-5 border-b border-slate-200/80 dark:border-slate-800/80 flex items-center justify-between bg-linear-to-r from-emerald-500/10 to-blue-500/10 dark:from-emerald-500/5 dark:to-blue-500/5\">\r\n                    <h2 className=\"font-bold text-xl tracking-tight flex items-center gap-2 text-slate-900 dark:text-slate-100\">\r\n                        <div className=\"w-8 h-8 rounded-lg bg-linear-to-br from-emerald-500 to-blue-600 flex items-center justify-center shadow-lg\">\r\n                            <MessageSquare className=\"w-5 h-5 text-white\" />\r\n                        </div>\r\n                        Community\r\n                    </h2>\r\n                    <Button\r\n                        variant=\"ghost\"\r\n                        size=\"icon\"\r\n                        className=\"md:hidden h-8 w-8 hover:bg-slate-100 dark:hover:bg-slate-800\"\r\n                        onClick={onClose}\r\n                    >\r\n                        <X className=\"h-4 w-4\" />\r\n                    </Button>\r\n                </div>\r\n\r\n                {/* Scrollable Content */}\r\n                <div className=\"flex-1 overflow-y-auto p-4 space-y-6 scrollbar-thin scrollbar-thumb-slate-300 dark:scrollbar-thumb-slate-700 scrollbar-track-transparent\">\r\n                    {/* For You Section */}\r\n                    <ForYouSection onViewChange={onViewChange} onClose={onClose} />\r\n\r\n                    {/* All Channels Section */}\r\n                    <div>\r\n                        <div className=\"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-3 px-2\">\r\n                            All Channels\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            {enrolledCourses.map((course) => {\r\n                                const isExpanded = expandedCourses.has(course.id);\r\n                                // Check if this course contains the active channel\r\n                                const isActive = course.channels?.some(ch => ch.id === activeChannelId) || false;\r\n\r\n                                return (\r\n                                    <div key={course.id} className=\"space-y-1\">\r\n                                        {/* Course Header */}\r\n                                        <div\r\n                                            className={cn(\r\n                                                \"flex items-center gap-2 px-2 py-2 rounded-lg cursor-pointer transition-all duration-200\",\r\n                                                isActive\r\n                                                    ? \"bg-linear-to-r from-emerald-500/15 to-blue-500/15 dark:from-emerald-500/10 dark:to-blue-500/10 shadow-sm\"\r\n                                                    : \"hover:bg-slate-100 dark:hover:bg-slate-800\"\r\n                                            )}\r\n                                        >\r\n                                            <button\r\n                                                onClick={() => toggleCourse(course.id)}\r\n                                                className=\"shrink-0 hover:bg-slate-200 dark:hover:bg-slate-700 rounded p-1 transition-colors\"\r\n                                            >\r\n                                                {isExpanded ? (\r\n                                                    <ChevronDown className=\"w-4 h-4 text-slate-600 dark:text-slate-400\" />\r\n                                                ) : (\r\n                                                    <ChevronRight className=\"w-4 h-4 text-slate-600 dark:text-slate-400\" />\r\n                                                )}\r\n                                            </button>\r\n                                            <div\r\n                                                onClick={() => handleCourseClick(course.id)}\r\n                                                className=\"flex items-center gap-3 flex-1 min-w-0\"\r\n                                            >\r\n                                                <div className=\"w-10 h-10 rounded-lg overflow-hidden shrink-0 border-2 border-white dark:border-slate-800 shadow-md\">\r\n                                                    <CourseThumbnail\r\n                                                        src={course.thumbnail_url}\r\n                                                        title={course.title}\r\n                                                        variant=\"card\"\r\n                                                    />\r\n                                                </div>\r\n                                                <span className={cn(\r\n                                                    \"text-sm font-semibold truncate\",\r\n                                                    isActive ? \"text-emerald-700 dark:text-emerald-400\" : \"text-slate-700 dark:text-slate-300\"\r\n                                                )}>\r\n                                                    {course.title}\r\n                                                </span>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        {/* Course Channels */}\r\n                                        {isExpanded && (\r\n                                            <div className=\"ml-8 mt-1 space-y-0.5\">\r\n                                                {course.channels.map((channel) => (\r\n                                                    <button\r\n                                                        key={channel.id}\r\n                                                        onClick={() => onSelectChannel(channel.id)}\r\n                                                        className={cn(\r\n                                                            \"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-all duration-200 group relative\",\r\n                                                            activeChannelId === channel.id\r\n                                                                ? \"bg-emerald-500/15 dark:bg-emerald-500/10 text-emerald-700 dark:text-emerald-400 font-semibold shadow-sm\"\r\n                                                                : \"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-slate-200\"\r\n                                                        )}\r\n                                                    >\r\n                                                        {activeChannelId === channel.id && (\r\n                                                            <div className=\"absolute left-0 top-1/2 -translate-y-1/2 w-1 h-5 bg-emerald-500 rounded-r-full\" />\r\n                                                        )}\r\n                                                        <span className={cn(\r\n                                                            \"shrink-0\",\r\n                                                            activeChannelId === channel.id\r\n                                                                ? \"text-emerald-600 dark:text-emerald-400\"\r\n                                                                : \"text-slate-500 dark:text-slate-500 group-hover:text-slate-700 dark:group-hover:text-slate-300\"\r\n                                                        )}>\r\n                                                            {getIcon(channel.type)}\r\n                                                        </span>\r\n                                                        <span className=\"truncate\">{channel.name}</span>\r\n                                                    </button>\r\n                                                ))}\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                );\r\n                            })}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\n// For You Section Component\r\nconst ForYouSection = ({\r\n    onViewChange,\r\n    onClose\r\n}: {\r\n    onViewChange?: (view: 'channels' | 'mentions' | 'bookmarks') => void;\r\n    onClose: () => void;\r\n}) => {\r\n    const { data: mentions = [] } = useMentions();\r\n    const { data: bookmarks = [] } = useBookmarkedMessages();\r\n\r\n    const handleNavigation = (view: 'mentions' | 'bookmarks') => {\r\n        if (onViewChange) {\r\n            onViewChange(view);\r\n            onClose();\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            <div className=\"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-3 px-2\">\r\n                For You\r\n            </div>\r\n            <div className=\"space-y-1\">\r\n                <button\r\n                    onClick={() => handleNavigation('mentions')}\r\n                    className=\"w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm transition-all duration-200 text-slate-700 dark:text-slate-300 hover:bg-linear-to-r hover:from-blue-50 hover:to-transparent dark:hover:from-blue-900/20 group\"\r\n                >\r\n                    <div className=\"w-8 h-8 rounded-lg bg-linear-to-br from-blue-100 to-blue-50 dark:from-blue-900/30 dark:to-blue-900/10 flex items-center justify-center group-hover:scale-110 transition-transform shadow-sm\">\r\n                        <AtSign className=\"w-4 h-4 text-blue-600 dark:text-blue-400\" />\r\n                    </div>\r\n                    <span className=\"font-semibold\">Mentions</span>\r\n                    {mentions.length > 0 && (\r\n                        <span className=\"ml-auto text-xs bg-linear-to-r from-blue-500 to-blue-600 text-white px-2 py-0.5 rounded-full font-bold shadow-sm\">\r\n                            {mentions.length}\r\n                        </span>\r\n                    )}\r\n                </button>\r\n                <button\r\n                    onClick={() => handleNavigation('bookmarks')}\r\n                    className=\"w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm transition-all duration-200 text-slate-700 dark:text-slate-300 hover:bg-linear-to-r hover:from-amber-50 hover:to-transparent dark:hover:from-amber-900/20 group\"\r\n                >\r\n                    <div className=\"w-8 h-8 rounded-lg bg-linear-to-br from-amber-100 to-amber-50 dark:from-amber-900/30 dark:to-amber-900/10 flex items-center justify-center group-hover:scale-110 transition-transform shadow-sm\">\r\n                        <Bookmark className=\"w-4 h-4 text-amber-600 dark:text-amber-400\" />\r\n                    </div>\r\n                    <span className=\"font-semibold\">Bookmarks</span>\r\n                    {bookmarks.length > 0 && (\r\n                        <span className=\"ml-auto text-xs bg-linear-to-r from-amber-500 to-amber-600 text-white px-2 py-0.5 rounded-full font-bold shadow-sm\">\r\n                            {bookmarks.length}\r\n                        </span>\r\n                    )}\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n"
        ],
        "names": [],
        "mappings": ";;;;;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;;;;;;;;;;AAeO,MAAM,iBAAiB,CAAC,EAC3B,QAAQ,EACR,eAAe,EACf,eAAe,EACf,QAAQ,EACR,eAAe,EACf,MAAM,EACN,OAAO,EACP,UAAU,KAAK,EACf,YAAY,EACZ,cAAc,EACI;;IAClB,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EAAc,IAAI,IAAI;QAAC;KAAS;IAEtF,MAAM,UAAU,CAAC;QACb,OAAQ;YACJ,KAAK;gBACD,qBAAO,6LAAC,0NAAO;oBAAC,WAAU;;;;;;YAC9B,KAAK;gBACD,qBAAO,6LAAC,mOAAU;oBAAC,WAAU;;;;;;YACjC;gBACI,qBAAO,6LAAC,6MAAI;oBAAC,WAAU;;;;;;QAC/B;IACJ;IAGA,MAAM,eAAe,CAAC;QAClB,MAAM,cAAc,IAAI,IAAI;QAC5B,IAAI,YAAY,GAAG,CAAC,KAAK;YACrB,YAAY,MAAM,CAAC;QACvB,OAAO;YACH,YAAY,GAAG,CAAC;QACpB;QACA,mBAAmB;IACvB;IAEA,+CAA+C;IAC/C,MAAM,oBAAoB,CAAC;QACvB,iBAAiB;QACjB,aAAa;IACjB;IAEA,wDAAwD;IACxD,IAAA,0KAAS;oCAAC;YACN,IAAI,iBAAiB;gBACjB,MAAM,gBAAgB,gBAAgB,IAAI;8DAAC,CAAA,SACvC,OAAO,QAAQ,EAAE;sEAAK,CAAA,KAAM,GAAG,EAAE,KAAK;;;gBAE1C,IAAI,iBAAiB,CAAC,gBAAgB,GAAG,CAAC,cAAc,EAAE,GAAG;oBACzD,aAAa,cAAc,EAAE;gBACjC;YACJ;QACJ;mCAAG;QAAC;QAAiB;KAAgB;IAGrC,qBACI;;YAEK,wBACG,6LAAC;gBACG,WAAU;gBACV,SAAS;;;;;;0BAKjB,6LAAC;gBACG,WAAW,IAAA,qHAAE,EACT,sLACA,0BAA0B;gBAC1B,sCACA,SAAS,kBAAkB;;kCAI/B,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAG,WAAU;;kDACV,6LAAC;wCAAI,WAAU;kDACX,cAAA,6LAAC,4OAAa;4CAAC,WAAU;;;;;;;;;;;oCACvB;;;;;;;0CAGV,6LAAC,wIAAM;gCACH,SAAQ;gCACR,MAAK;gCACL,WAAU;gCACV,SAAS;0CAET,cAAA,6LAAC,oMAAC;oCAAC,WAAU;;;;;;;;;;;;;;;;;kCAKrB,6LAAC;wBAAI,WAAU;;0CAEX,6LAAC;gCAAc,cAAc;gCAAc,SAAS;;;;;;0CAGpD,6LAAC;;kDACG,6LAAC;wCAAI,WAAU;kDAA0F;;;;;;kDAGzG,6LAAC;wCAAI,WAAU;kDACV,gBAAgB,GAAG,CAAC,CAAC;4CAClB,MAAM,aAAa,gBAAgB,GAAG,CAAC,OAAO,EAAE;4CAChD,mDAAmD;4CACnD,MAAM,WAAW,OAAO,QAAQ,EAAE,KAAK,CAAA,KAAM,GAAG,EAAE,KAAK,oBAAoB;4CAE3E,qBACI,6LAAC;gDAAoB,WAAU;;kEAE3B,6LAAC;wDACG,WAAW,IAAA,qHAAE,EACT,2FACA,WACM,6GACA;;0EAGV,6LAAC;gEACG,SAAS,IAAM,aAAa,OAAO,EAAE;gEACrC,WAAU;0EAET,2BACG,6LAAC,sOAAW;oEAAC,WAAU;;;;;6HAEvB,6LAAC,yOAAY;oEAAC,WAAU;;;;;;;;;;;0EAGhC,6LAAC;gEACG,SAAS,IAAM,kBAAkB,OAAO,EAAE;gEAC1C,WAAU;;kFAEV,6LAAC;wEAAI,WAAU;kFACX,cAAA,6LAAC,0JAAe;4EACZ,KAAK,OAAO,aAAa;4EACzB,OAAO,OAAO,KAAK;4EACnB,SAAQ;;;;;;;;;;;kFAGhB,6LAAC;wEAAK,WAAW,IAAA,qHAAE,EACf,kCACA,WAAW,2CAA2C;kFAErD,OAAO,KAAK;;;;;;;;;;;;;;;;;;oDAMxB,4BACG,6LAAC;wDAAI,WAAU;kEACV,OAAO,QAAQ,CAAC,GAAG,CAAC,CAAC,wBAClB,6LAAC;gEAEG,SAAS,IAAM,gBAAgB,QAAQ,EAAE;gEACzC,WAAW,IAAA,qHAAE,EACT,0GACA,oBAAoB,QAAQ,EAAE,GACxB,4GACA;;oEAGT,oBAAoB,QAAQ,EAAE,kBAC3B,6LAAC;wEAAI,WAAU;;;;;;kFAEnB,6LAAC;wEAAK,WAAW,IAAA,qHAAE,EACf,YACA,oBAAoB,QAAQ,EAAE,GACxB,2CACA;kFAEL,QAAQ,QAAQ,IAAI;;;;;;kFAEzB,6LAAC;wEAAK,WAAU;kFAAY,QAAQ,IAAI;;;;;;;+DApBnC,QAAQ,EAAE;;;;;;;;;;;+CA7CzB,OAAO,EAAE;;;;;wCAwE3B;;;;;;;;;;;;;;;;;;;;;;;;;;AAO5B;GA7La;;QAYM,kJAAS;;;KAZf;AA+Lb,4BAA4B;AAC5B,MAAM,gBAAgB,CAAC,EACnB,YAAY,EACZ,OAAO,EAIV;;IACG,MAAM,EAAE,MAAM,WAAW,EAAE,EAAE,GAAG,IAAA,oJAAW;IAC3C,MAAM,EAAE,MAAM,YAAY,EAAE,EAAE,GAAG,IAAA,8JAAqB;IAEtD,MAAM,mBAAmB,CAAC;QACtB,IAAI,cAAc;YACd,aAAa;YACb;QACJ;IACJ;IAEA,qBACI,6LAAC;;0BACG,6LAAC;gBAAI,WAAU;0BAA0F;;;;;;0BAGzG,6LAAC;gBAAI,WAAU;;kCACX,6LAAC;wBACG,SAAS,IAAM,iBAAiB;wBAChC,WAAU;;0CAEV,6LAAC;gCAAI,WAAU;0CACX,cAAA,6LAAC,uNAAM;oCAAC,WAAU;;;;;;;;;;;0CAEtB,6LAAC;gCAAK,WAAU;0CAAgB;;;;;;4BAC/B,SAAS,MAAM,GAAG,mBACf,6LAAC;gCAAK,WAAU;0CACX,SAAS,MAAM;;;;;;;;;;;;kCAI5B,6LAAC;wBACG,SAAS,IAAM,iBAAiB;wBAChC,WAAU;;0CAEV,6LAAC;gCAAI,WAAU;0CACX,cAAA,6LAAC,yNAAQ;oCAAC,WAAU;;;;;;;;;;;0CAExB,6LAAC;gCAAK,WAAU;0CAAgB;;;;;;4BAC/B,UAAU,MAAM,GAAG,mBAChB,6LAAC;gCAAK,WAAU;0CACX,UAAU,MAAM;;;;;;;;;;;;;;;;;;;;;;;;AAO7C;IAtDM;;QAO8B,oJAAW;QACV,8JAAqB;;;MARpD"
      }
    },
    {
      "offset": {
        "line": 5089,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/hooks/community/useMessageReactions.ts"
        ],
        "sourcesContent": [
          "import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\n\r\nexport function useMessageReactions(messageId: string) {\r\n    return useQuery({\r\n        queryKey: [\"message-reactions\", messageId],\r\n        queryFn: async () => {\r\n            const supabase = createClient();\r\n            const { data, error } = await supabase\r\n                .from(\"community_reactions\")\r\n                .select(\"*\")\r\n                .eq(\"message_id\", messageId);\r\n\r\n            if (error) throw error;\r\n            return data || [];\r\n        },\r\n    });\r\n}\r\n\r\nexport function useToggleMessageReaction() {\r\n    const queryClient = useQueryClient();\r\n    const supabase = createClient();\r\n\r\n    return useMutation({\r\n        mutationFn: async ({ messageId, emoji }: { messageId: string; emoji: string }) => {\r\n            const { data: { user } } = await supabase.auth.getUser();\r\n            if (!user) throw new Error(\"Not authenticated\");\r\n\r\n            // Check if reaction already exists\r\n            const { data: existing, error: checkError } = await supabase\r\n                .from(\"community_reactions\")\r\n                .select(\"id\")\r\n                .eq(\"message_id\", messageId)\r\n                .eq(\"user_id\", user.id)\r\n                .eq(\"emoji\", emoji)\r\n                .single();\r\n\r\n            if (checkError && checkError.code !== 'PGRST116') {\r\n                throw checkError;\r\n            }\r\n\r\n            if (existing) {\r\n                // Remove reaction\r\n                const { error } = await supabase\r\n                    .from(\"community_reactions\")\r\n                    .delete()\r\n                    .eq(\"id\", existing.id);\r\n\r\n                if (error) throw error;\r\n                return { action: \"removed\" };\r\n            } else {\r\n                // Add reaction\r\n                const { error } = await supabase\r\n                    .from(\"community_reactions\")\r\n                    .insert({\r\n                        message_id: messageId,\r\n                        user_id: user.id,\r\n                        emoji,\r\n                    });\r\n\r\n                if (error) throw error;\r\n                return { action: \"added\" };\r\n            }\r\n        },\r\n        onSuccess: (_, variables) => {\r\n            // Invalidate queries to refetch messages\r\n            queryClient.invalidateQueries({ queryKey: [\"community\", \"messages\"] });\r\n            queryClient.invalidateQueries({ queryKey: [\"message-reactions\", variables.messageId] });\r\n        },\r\n    });\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;;;AAAA;AAAA;AAAA;AACA;;;;AAEO,SAAS,oBAAoB,SAAiB;;IACjD,OAAO,IAAA,0LAAQ,EAAC;QACZ,UAAU;YAAC;YAAqB;SAAU;QAC1C,OAAO;4CAAE;gBACL,MAAM,WAAW,IAAA,4IAAY;gBAC7B,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SACzB,IAAI,CAAC,uBACL,MAAM,CAAC,KACP,EAAE,CAAC,cAAc;gBAEtB,IAAI,OAAO,MAAM;gBACjB,OAAO,QAAQ,EAAE;YACrB;;IACJ;AACJ;GAdgB;;QACL,0LAAQ;;;AAeZ,SAAS;;IACZ,MAAM,cAAc,IAAA,2MAAc;IAClC,MAAM,WAAW,IAAA,4IAAY;IAE7B,OAAO,IAAA,gMAAW,EAAC;QACf,UAAU;oDAAE,OAAO,EAAE,SAAS,EAAE,KAAK,EAAwC;gBACzE,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;gBACtD,IAAI,CAAC,MAAM,MAAM,IAAI,MAAM;gBAE3B,mCAAmC;gBACnC,MAAM,EAAE,MAAM,QAAQ,EAAE,OAAO,UAAU,EAAE,GAAG,MAAM,SAC/C,IAAI,CAAC,uBACL,MAAM,CAAC,MACP,EAAE,CAAC,cAAc,WACjB,EAAE,CAAC,WAAW,KAAK,EAAE,EACrB,EAAE,CAAC,SAAS,OACZ,MAAM;gBAEX,IAAI,cAAc,WAAW,IAAI,KAAK,YAAY;oBAC9C,MAAM;gBACV;gBAEA,IAAI,UAAU;oBACV,kBAAkB;oBAClB,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SACnB,IAAI,CAAC,uBACL,MAAM,GACN,EAAE,CAAC,MAAM,SAAS,EAAE;oBAEzB,IAAI,OAAO,MAAM;oBACjB,OAAO;wBAAE,QAAQ;oBAAU;gBAC/B,OAAO;oBACH,eAAe;oBACf,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SACnB,IAAI,CAAC,uBACL,MAAM,CAAC;wBACJ,YAAY;wBACZ,SAAS,KAAK,EAAE;wBAChB;oBACJ;oBAEJ,IAAI,OAAO,MAAM;oBACjB,OAAO;wBAAE,QAAQ;oBAAQ;gBAC7B;YACJ;;QACA,SAAS;oDAAE,CAAC,GAAG;gBACX,yCAAyC;gBACzC,YAAY,iBAAiB,CAAC;oBAAE,UAAU;wBAAC;wBAAa;qBAAW;gBAAC;gBACpE,YAAY,iBAAiB,CAAC;oBAAE,UAAU;wBAAC;wBAAqB,UAAU,SAAS;qBAAC;gBAAC;YACzF;;IACJ;AACJ;IAnDgB;;QACQ,2MAAc;QAG3B,gMAAW"
      }
    },
    {
      "offset": {
        "line": 5191,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/hooks/useUser.ts"
        ],
        "sourcesContent": [
          "import { createClient } from \"@/lib/supabase/client\";\r\nimport { User } from \"@supabase/supabase-js\";\r\nimport { useEffect, useState } from \"react\";\r\n\r\nexport function useUser() {\r\n    const [user, setUser] = useState<User | null>(null);\r\n    const [profile, setProfile] = useState<any | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const supabase = createClient();\r\n\r\n    useEffect(() => {\r\n        let mounted = true;\r\n\r\n        const getUser = async () => {\r\n            try {\r\n                // Get session from local storage first (faster)\r\n                const { data: { session } } = await supabase.auth.getSession();\r\n\r\n                if (mounted) {\r\n                    if (session?.user) {\r\n                        setUser(session.user);\r\n\r\n                        // Fetch profile in background to unblock UI\r\n                        fetchProfile(session.user.id);\r\n                    } else {\r\n                        // Fallback to getUser if no session (only if session is null)\r\n                        const { data: { user } } = await supabase.auth.getUser();\r\n                        if (mounted) setUser(user);\r\n                        if (user) fetchProfile(user.id);\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                // Silently fail - auth errors are handled by Supabase\r\n            } finally {\r\n                if (mounted) setLoading(false);\r\n            }\r\n        };\r\n\r\n        const fetchProfile = async (userId: string) => {\r\n            const { data: profile } = await supabase\r\n                .from('profiles')\r\n                .select('*')\r\n                .eq('id', userId)\r\n                .single();\r\n            if (mounted) setProfile(profile);\r\n        }\r\n\r\n        getUser();\r\n\r\n        const { data: { subscription } } = supabase.auth.onAuthStateChange(async (_event, session) => {\r\n            if (mounted) {\r\n                setUser(session?.user ?? null);\r\n                if (session?.user) {\r\n                    fetchProfile(session.user.id);\r\n                } else {\r\n                    setProfile(null);\r\n                }\r\n                setLoading(false);\r\n            }\r\n        });\r\n\r\n        return () => {\r\n            mounted = false;\r\n            subscription.unsubscribe();\r\n        };\r\n    }, []);\r\n\r\n    return { user, profile, loading };\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;AAAA;AAEA;;;;AAEO,SAAS;;IACZ,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAc;IAC9C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAa;IACnD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,WAAW,IAAA,4IAAY;IAE7B,IAAA,0KAAS;6BAAC;YACN,IAAI,UAAU;YAEd,MAAM;6CAAU;oBACZ,IAAI;wBACA,gDAAgD;wBAChD,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,UAAU;wBAE5D,IAAI,SAAS;4BACT,IAAI,SAAS,MAAM;gCACf,QAAQ,QAAQ,IAAI;gCAEpB,4CAA4C;gCAC5C,aAAa,QAAQ,IAAI,CAAC,EAAE;4BAChC,OAAO;gCACH,8DAA8D;gCAC9D,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;gCACtD,IAAI,SAAS,QAAQ;gCACrB,IAAI,MAAM,aAAa,KAAK,EAAE;4BAClC;wBACJ;oBACJ,EAAE,OAAO,OAAO;oBACZ,sDAAsD;oBAC1D,SAAU;wBACN,IAAI,SAAS,WAAW;oBAC5B;gBACJ;;YAEA,MAAM;kDAAe,OAAO;oBACxB,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,QACT,MAAM;oBACX,IAAI,SAAS,WAAW;gBAC5B;;YAEA;YAEA,MAAM,EAAE,MAAM,EAAE,YAAY,EAAE,EAAE,GAAG,SAAS,IAAI,CAAC,iBAAiB;qCAAC,OAAO,QAAQ;oBAC9E,IAAI,SAAS;wBACT,QAAQ,SAAS,QAAQ;wBACzB,IAAI,SAAS,MAAM;4BACf,aAAa,QAAQ,IAAI,CAAC,EAAE;wBAChC,OAAO;4BACH,WAAW;wBACf;wBACA,WAAW;oBACf;gBACJ;;YAEA;qCAAO;oBACH,UAAU;oBACV,aAAa,WAAW;gBAC5B;;QACJ;4BAAG,EAAE;IAEL,OAAO;QAAE;QAAM;QAAS;IAAQ;AACpC;GAhEgB"
      }
    },
    {
      "offset": {
        "line": 5275,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/ui/popover.tsx"
        ],
        "sourcesContent": [
          "'use client'\r\n\r\nimport * as React from 'react'\r\nimport * as PopoverPrimitive from '@radix-ui/react-popover'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Popover({\r\n  ...props\r\n}: React.ComponentProps<typeof PopoverPrimitive.Root>) {\r\n  return <PopoverPrimitive.Root data-slot=\"popover\" {...props} />\r\n}\r\n\r\nfunction PopoverTrigger({\r\n  ...props\r\n}: React.ComponentProps<typeof PopoverPrimitive.Trigger>) {\r\n  return <PopoverPrimitive.Trigger data-slot=\"popover-trigger\" {...props} />\r\n}\r\n\r\nfunction PopoverContent({\r\n  className,\r\n  align = 'center',\r\n  sideOffset = 4,\r\n  ...props\r\n}: React.ComponentProps<typeof PopoverPrimitive.Content>) {\r\n  return (\r\n    <PopoverPrimitive.Portal>\r\n      <PopoverPrimitive.Content\r\n        data-slot=\"popover-content\"\r\n        align={align}\r\n        sideOffset={sideOffset}\r\n        className={cn(\r\n          'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden',\r\n          className,\r\n        )}\r\n        {...props}\r\n      />\r\n    </PopoverPrimitive.Portal>\r\n  )\r\n}\r\n\r\nfunction PopoverAnchor({\r\n  ...props\r\n}: React.ComponentProps<typeof PopoverPrimitive.Anchor>) {\r\n  return <PopoverPrimitive.Anchor data-slot=\"popover-anchor\" {...props} />\r\n}\r\n\r\nexport { Popover, PopoverTrigger, PopoverContent, PopoverAnchor }\r\n"
        ],
        "names": [],
        "mappings": ";;;;;;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,QAAQ,EACf,GAAG,OACgD;IACnD,qBAAO,6LAAC,8KAAqB;QAAC,aAAU;QAAW,GAAG,KAAK;;;;;;AAC7D;KAJS;AAMT,SAAS,eAAe,EACtB,GAAG,OACmD;IACtD,qBAAO,6LAAC,iLAAwB;QAAC,aAAU;QAAmB,GAAG,KAAK;;;;;;AACxE;MAJS;AAMT,SAAS,eAAe,EACtB,SAAS,EACT,QAAQ,QAAQ,EAChB,aAAa,CAAC,EACd,GAAG,OACmD;IACtD,qBACE,6LAAC,gLAAuB;kBACtB,cAAA,6LAAC,iLAAwB;YACvB,aAAU;YACV,OAAO;YACP,YAAY;YACZ,WAAW,IAAA,qHAAE,EACX,keACA;YAED,GAAG,KAAK;;;;;;;;;;;AAIjB;MApBS;AAsBT,SAAS,cAAc,EACrB,GAAG,OACkD;IACrD,qBAAO,6LAAC,gLAAuB;QAAC,aAAU;QAAkB,GAAG,KAAK;;;;;;AACtE;MAJS"
      }
    },
    {
      "offset": {
        "line": 5358,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/community/MessageCard.tsx"
        ],
        "sourcesContent": [
          "import { CommunityMessage } from \"@/types/community\";\r\nimport { formatDistanceToNow } from \"date-fns\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Smile, Trash2, Bookmark, Pin, Megaphone, Plus } from \"lucide-react\";\r\nimport { useToggleReaction, useToggleBookmark } from \"@/hooks/community\";\r\nimport { useToggleMessageReaction } from \"@/hooks/community/useMessageReactions\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { useUser } from \"@/hooks/useUser\";\r\nimport { useToast } from \"@/hooks/use-toast\";\r\nimport { useState } from \"react\";\r\nimport {\r\n    Popover,\r\n    PopoverContent,\r\n    PopoverTrigger,\r\n} from \"@/components/ui/popover\";\r\n\r\ninterface MessageCardProps {\r\n    message: CommunityMessage;\r\n    isOwnMessage: boolean;\r\n    isPinned?: boolean;\r\n    onDelete?: () => void;\r\n    channelId?: string;\r\n}\r\n\r\n// Common emoji reactions\r\nconst EMOJI_REACTIONS = [\"üëç\", \"‚ù§Ô∏è\", \"üòÇ\", \"üòÆ\", \"üò¢\", \"üéâ\", \"üî•\", \"üëè\"];\r\n\r\nexport const MessageCard = ({ message, isOwnMessage, isPinned = false, onDelete, channelId }: MessageCardProps) => {\r\n    const { mutate: toggleReaction } = useToggleReaction();\r\n    const { mutate: toggleBookmark } = useToggleBookmark(channelId);\r\n    const { mutate: toggleMessageReaction } = useToggleMessageReaction();\r\n    const { user } = useUser();\r\n    const { toast } = useToast();\r\n    const [showEmojiPicker, setShowEmojiPicker] = useState(false);\r\n\r\n    const handleReaction = (emoji: string) => {\r\n        toggleMessageReaction({ messageId: message.id, emoji });\r\n        setShowEmojiPicker(false);\r\n    };\r\n\r\n    const handleBookmark = () => {\r\n        const isBookmarked = message.community_bookmarks?.some(b => b.user_id === user?.id) || false;\r\n        toggleBookmark(\r\n            { messageId: message.id, isBookmarked },\r\n            {\r\n                onSuccess: () => {\r\n                    toast({\r\n                        title: isBookmarked ? \"Bookmark removed\" : \"Bookmark added\",\r\n                        description: isBookmarked\r\n                            ? \"Message removed from your bookmarks\"\r\n                            : \"Message saved to your bookmarks\",\r\n                        duration: 3000,\r\n                    });\r\n                },\r\n            }\r\n        );\r\n    };\r\n\r\n    // Check if current user has bookmarked this message\r\n    const isBookmarked = message.community_bookmarks?.some(b => b.user_id === user?.id) || false;\r\n\r\n    // Group reactions by emoji\r\n    const reactionCounts = message.community_reactions?.reduce((acc, reaction) => {\r\n        acc[reaction.emoji] = (acc[reaction.emoji] || 0) + 1;\r\n        return acc;\r\n    }, {} as Record<string, number>);\r\n\r\n    const userReactions = new Set(\r\n        message.community_reactions?.filter(r => r.user_id === user?.id).map(r => r.emoji)\r\n    );\r\n\r\n    // Parse message content for mentions\r\n    const renderMessageContent = (content: string) => {\r\n        const mentionRegex = /@(\\w+)/g;\r\n        const parts = [];\r\n        let lastIndex = 0;\r\n        let match;\r\n\r\n        while ((match = mentionRegex.exec(content)) !== null) {\r\n            // Add text before mention\r\n            if (match.index > lastIndex) {\r\n                parts.push(content.substring(lastIndex, match.index));\r\n            }\r\n            // Add mention with styling\r\n            parts.push(\r\n                <span key={match.index} className=\"text-emerald-600 dark:text-emerald-400 font-semibold bg-emerald-100 dark:bg-emerald-900/30 px-1 rounded\">\r\n                    @{match[1]}\r\n                </span>\r\n            );\r\n            lastIndex = match.index + match[0].length;\r\n        }\r\n\r\n        // Add remaining text\r\n        if (lastIndex < content.length) {\r\n            parts.push(content.substring(lastIndex));\r\n        }\r\n\r\n        return parts.length > 0 ? parts : content;\r\n    };\r\n\r\n    return (\r\n        <div className={cn(\r\n            \"group relative px-4 md:px-6 py-3 hover:bg-slate-50/50 dark:hover:bg-slate-800/30 transition-colors\",\r\n            isPinned && \"bg-blue-50/50 dark:bg-blue-900/10 border-l-4 border-blue-500\"\r\n        )}>\r\n            {isPinned && (\r\n                <div className=\"absolute top-2 right-4 flex items-center gap-1 text-xs text-blue-600 dark:text-blue-400\">\r\n                    <Pin className=\"w-3 h-3\" />\r\n                    <span className=\"font-medium\">Pinned</span>\r\n                </div>\r\n            )}\r\n\r\n            <div className=\"flex gap-3\">\r\n                <Avatar className=\"h-10 w-10 shrink-0 border-2 border-white dark:border-slate-800 shadow-sm\">\r\n                    <AvatarImage src={message.profiles?.avatar_url || undefined} />\r\n                    <AvatarFallback className=\"bg-linear-to-br from-emerald-500 to-blue-600 text-white font-semibold\">\r\n                        {message.profiles?.full_name?.substring(0, 2).toUpperCase() || \"U\"}\r\n                    </AvatarFallback>\r\n                </Avatar>\r\n\r\n                <div className=\"flex-1 min-w-0\">\r\n                    <div className=\"flex items-baseline gap-2 mb-1\">\r\n                        <span className=\"font-semibold text-slate-900 dark:text-slate-100\">\r\n                            {message.profiles?.full_name || \"Unknown User\"}\r\n                        </span>\r\n                        {message.profiles?.role === \"admin\" && (\r\n                            <span className=\"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 text-xs font-medium\">\r\n                                <Megaphone className=\"w-3 h-3\" />\r\n                                Admin\r\n                            </span>\r\n                        )}\r\n                        <span className=\"text-xs text-slate-500 dark:text-slate-400\">\r\n                            {formatDistanceToNow(new Date(message.created_at), { addSuffix: true })}\r\n                        </span>\r\n                    </div>\r\n\r\n                    <div className=\"text-sm text-slate-700 dark:text-slate-300 leading-relaxed whitespace-pre-wrap break-words\">\r\n                        {renderMessageContent(message.content)}\r\n                    </div>\r\n\r\n                    {/* Reactions Display */}\r\n                    {reactionCounts && Object.keys(reactionCounts).length > 0 && (\r\n                        <div className=\"flex flex-wrap gap-1.5 mt-2\">\r\n                            {Object.entries(reactionCounts).map(([emoji, count]) => (\r\n                                <button\r\n                                    key={emoji}\r\n                                    onClick={() => handleReaction(emoji)}\r\n                                    className={cn(\r\n                                        \"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium transition-all hover:scale-105\",\r\n                                        userReactions.has(emoji)\r\n                                            ? \"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-300 ring-2 ring-emerald-500/50\"\r\n                                            : \"bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700\"\r\n                                    )}\r\n                                >\r\n                                    <span>{emoji}</span>\r\n                                    <span>{count}</span>\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Action Buttons */}\r\n                    <div className=\"flex items-center gap-1 mt-2 opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                        <Popover open={showEmojiPicker} onOpenChange={setShowEmojiPicker}>\r\n                            <PopoverTrigger asChild>\r\n                                <Button\r\n                                    variant=\"ghost\"\r\n                                    size=\"sm\"\r\n                                    className=\"h-7 px-2 text-xs text-slate-500 dark:text-slate-400 hover:text-emerald-600 dark:hover:text-emerald-400\"\r\n                                >\r\n                                    <Smile className=\"w-4 h-4 mr-1\" />\r\n                                    React\r\n                                </Button>\r\n                            </PopoverTrigger>\r\n                            <PopoverContent className=\"w-auto p-2\" align=\"start\">\r\n                                <div className=\"flex gap-1\">\r\n                                    {EMOJI_REACTIONS.map((emoji) => (\r\n                                        <button\r\n                                            key={emoji}\r\n                                            onClick={() => handleReaction(emoji)}\r\n                                            className=\"w-10 h-10 flex items-center justify-center rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors text-xl\"\r\n                                        >\r\n                                            {emoji}\r\n                                        </button>\r\n                                    ))}\r\n                                </div>\r\n                            </PopoverContent>\r\n                        </Popover>\r\n\r\n                        <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={handleBookmark}\r\n                            className={cn(\r\n                                \"h-7 px-2 text-xs\",\r\n                                isBookmarked\r\n                                    ? \"text-amber-600 dark:text-amber-400\"\r\n                                    : \"text-slate-500 dark:text-slate-400 hover:text-amber-600 dark:hover:text-amber-400\"\r\n                            )}\r\n                        >\r\n                            <Bookmark className={cn(\"w-4 h-4 mr-1\", isBookmarked && \"fill-current\")} />\r\n                            {isBookmarked ? \"Saved\" : \"Save\"}\r\n                        </Button>\r\n\r\n                        {isOwnMessage && onDelete && (\r\n                            <Button\r\n                                variant=\"ghost\"\r\n                                size=\"sm\"\r\n                                onClick={onDelete}\r\n                                className=\"h-7 px-2 text-xs text-slate-500 dark:text-slate-400 hover:text-red-600 dark:hover:text-red-400\"\r\n                            >\r\n                                <Trash2 className=\"w-4 h-4 mr-1\" />\r\n                                Delete\r\n                            </Button>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n"
        ],
        "names": [],
        "mappings": ";;;;;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AAcA,yBAAyB;AACzB,MAAM,kBAAkB;IAAC;IAAM;IAAM;IAAM;IAAM;IAAM;IAAM;IAAM;CAAK;AAEjE,MAAM,cAAc,CAAC,EAAE,OAAO,EAAE,YAAY,EAAE,WAAW,KAAK,EAAE,QAAQ,EAAE,SAAS,EAAoB;;IAC1G,MAAM,EAAE,QAAQ,cAAc,EAAE,GAAG,IAAA,wJAAiB;IACpD,MAAM,EAAE,QAAQ,cAAc,EAAE,GAAG,IAAA,0JAAiB,EAAC;IACrD,MAAM,EAAE,QAAQ,qBAAqB,EAAE,GAAG,IAAA,wKAAwB;IAClE,MAAM,EAAE,IAAI,EAAE,GAAG,IAAA,8HAAO;IACxB,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,oIAAQ;IAC1B,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EAAC;IAEvD,MAAM,iBAAiB,CAAC;QACpB,sBAAsB;YAAE,WAAW,QAAQ,EAAE;YAAE;QAAM;QACrD,mBAAmB;IACvB;IAEA,MAAM,iBAAiB;QACnB,MAAM,eAAe,QAAQ,mBAAmB,EAAE,KAAK,CAAA,IAAK,EAAE,OAAO,KAAK,MAAM,OAAO;QACvF,eACI;YAAE,WAAW,QAAQ,EAAE;YAAE;QAAa,GACtC;YACI,WAAW;gBACP,MAAM;oBACF,OAAO,eAAe,qBAAqB;oBAC3C,aAAa,eACP,wCACA;oBACN,UAAU;gBACd;YACJ;QACJ;IAER;IAEA,oDAAoD;IACpD,MAAM,eAAe,QAAQ,mBAAmB,EAAE,KAAK,CAAA,IAAK,EAAE,OAAO,KAAK,MAAM,OAAO;IAEvF,2BAA2B;IAC3B,MAAM,iBAAiB,QAAQ,mBAAmB,EAAE,OAAO,CAAC,KAAK;QAC7D,GAAG,CAAC,SAAS,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC,SAAS,KAAK,CAAC,IAAI,CAAC,IAAI;QACnD,OAAO;IACX,GAAG,CAAC;IAEJ,MAAM,gBAAgB,IAAI,IACtB,QAAQ,mBAAmB,EAAE,OAAO,CAAA,IAAK,EAAE,OAAO,KAAK,MAAM,IAAI,IAAI,CAAA,IAAK,EAAE,KAAK;IAGrF,qCAAqC;IACrC,MAAM,uBAAuB,CAAC;QAC1B,MAAM,eAAe;QACrB,MAAM,QAAQ,EAAE;QAChB,IAAI,YAAY;QAChB,IAAI;QAEJ,MAAO,CAAC,QAAQ,aAAa,IAAI,CAAC,QAAQ,MAAM,KAAM;YAClD,0BAA0B;YAC1B,IAAI,MAAM,KAAK,GAAG,WAAW;gBACzB,MAAM,IAAI,CAAC,QAAQ,SAAS,CAAC,WAAW,MAAM,KAAK;YACvD;YACA,2BAA2B;YAC3B,MAAM,IAAI,eACN,6LAAC;gBAAuB,WAAU;;oBAA0G;oBACtI,KAAK,CAAC,EAAE;;eADH,MAAM,KAAK;;;;;YAI1B,YAAY,MAAM,KAAK,GAAG,KAAK,CAAC,EAAE,CAAC,MAAM;QAC7C;QAEA,qBAAqB;QACrB,IAAI,YAAY,QAAQ,MAAM,EAAE;YAC5B,MAAM,IAAI,CAAC,QAAQ,SAAS,CAAC;QACjC;QAEA,OAAO,MAAM,MAAM,GAAG,IAAI,QAAQ;IACtC;IAEA,qBACI,6LAAC;QAAI,WAAW,IAAA,qHAAE,EACd,sGACA,YAAY;;YAEX,0BACG,6LAAC;gBAAI,WAAU;;kCACX,6LAAC,0MAAG;wBAAC,WAAU;;;;;;kCACf,6LAAC;wBAAK,WAAU;kCAAc;;;;;;;;;;;;0BAItC,6LAAC;gBAAI,WAAU;;kCACX,6LAAC,wIAAM;wBAAC,WAAU;;0CACd,6LAAC,6IAAW;gCAAC,KAAK,QAAQ,QAAQ,EAAE,cAAc;;;;;;0CAClD,6LAAC,gJAAc;gCAAC,WAAU;0CACrB,QAAQ,QAAQ,EAAE,WAAW,UAAU,GAAG,GAAG,iBAAiB;;;;;;;;;;;;kCAIvE,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAI,WAAU;;kDACX,6LAAC;wCAAK,WAAU;kDACX,QAAQ,QAAQ,EAAE,aAAa;;;;;;oCAEnC,QAAQ,QAAQ,EAAE,SAAS,yBACxB,6LAAC;wCAAK,WAAU;;0DACZ,6LAAC,4NAAS;gDAAC,WAAU;;;;;;4CAAY;;;;;;;kDAIzC,6LAAC;wCAAK,WAAU;kDACX,IAAA,4KAAmB,EAAC,IAAI,KAAK,QAAQ,UAAU,GAAG;4CAAE,WAAW;wCAAK;;;;;;;;;;;;0CAI7E,6LAAC;gCAAI,WAAU;0CACV,qBAAqB,QAAQ,OAAO;;;;;;4BAIxC,kBAAkB,OAAO,IAAI,CAAC,gBAAgB,MAAM,GAAG,mBACpD,6LAAC;gCAAI,WAAU;0CACV,OAAO,OAAO,CAAC,gBAAgB,GAAG,CAAC,CAAC,CAAC,OAAO,MAAM,iBAC/C,6LAAC;wCAEG,SAAS,IAAM,eAAe;wCAC9B,WAAW,IAAA,qHAAE,EACT,4GACA,cAAc,GAAG,CAAC,SACZ,4GACA;;0DAGV,6LAAC;0DAAM;;;;;;0DACP,6LAAC;0DAAM;;;;;;;uCAVF;;;;;;;;;;0CAiBrB,6LAAC;gCAAI,WAAU;;kDACX,6LAAC,0IAAO;wCAAC,MAAM;wCAAiB,cAAc;;0DAC1C,6LAAC,iJAAc;gDAAC,OAAO;0DACnB,cAAA,6LAAC,wIAAM;oDACH,SAAQ;oDACR,MAAK;oDACL,WAAU;;sEAEV,6LAAC,gNAAK;4DAAC,WAAU;;;;;;wDAAiB;;;;;;;;;;;;0DAI1C,6LAAC,iJAAc;gDAAC,WAAU;gDAAa,OAAM;0DACzC,cAAA,6LAAC;oDAAI,WAAU;8DACV,gBAAgB,GAAG,CAAC,CAAC,sBAClB,6LAAC;4DAEG,SAAS,IAAM,eAAe;4DAC9B,WAAU;sEAET;2DAJI;;;;;;;;;;;;;;;;;;;;;kDAWzB,6LAAC,wIAAM;wCACH,SAAQ;wCACR,MAAK;wCACL,SAAS;wCACT,WAAW,IAAA,qHAAE,EACT,oBACA,eACM,uCACA;;0DAGV,6LAAC,yNAAQ;gDAAC,WAAW,IAAA,qHAAE,EAAC,gBAAgB,gBAAgB;;;;;;4CACvD,eAAe,UAAU;;;;;;;oCAG7B,gBAAgB,0BACb,6LAAC,wIAAM;wCACH,SAAQ;wCACR,MAAK;wCACL,SAAS;wCACT,WAAU;;0DAEV,6LAAC,uNAAM;gDAAC,WAAU;;;;;;4CAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASnE;GAjMa;;QAC0B,wJAAiB;QACjB,0JAAiB;QACV,wKAAwB;QACjD,8HAAO;QACN,oIAAQ;;;KALjB"
      }
    },
    {
      "offset": {
        "line": 5760,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/community/MessageList.tsx"
        ],
        "sourcesContent": [
          "\r\nimport { useRef, useEffect } from \"react\";\r\nimport { useChannelMessages } from \"@/hooks/community\";\r\nimport { MessageCard } from \"./MessageCard\";\r\nimport { Loader2, Pin } from \"lucide-react\";\r\nimport { useUser } from \"@/hooks/useUser\";\r\n\r\ninterface MessageListProps {\r\n    channelId: string;\r\n}\r\n\r\nexport const MessageList = ({ channelId }: MessageListProps) => {\r\n    const { data, fetchNextPage, hasNextPage, isFetchingNextPage, isLoading } = useChannelMessages(channelId);\r\n    const { user } = useUser();\r\n\r\n    // All hooks must be called unconditionally at the top level\r\n    const bottomRef = useRef<HTMLDivElement>(null);\r\n    const topObserver = useRef<IntersectionObserver | null>(null);\r\n    const topSentinelRef = useRef<HTMLDivElement>(null);\r\n\r\n    // Auto-scroll to bottom on initial load\r\n    useEffect(() => {\r\n        if (!isLoading) {\r\n            bottomRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n        }\r\n    }, [isLoading, channelId]);\r\n\r\n    // Infinite scroll observer setup\r\n    useEffect(() => {\r\n        if (!hasNextPage || isFetchingNextPage || isLoading) return;\r\n\r\n        const observer = new IntersectionObserver((entries) => {\r\n            if (entries[0].isIntersecting) {\r\n                fetchNextPage();\r\n            }\r\n        }, { threshold: 0.5 });\r\n\r\n        if (topSentinelRef.current) {\r\n            observer.observe(topSentinelRef.current);\r\n        }\r\n\r\n        topObserver.current = observer;\r\n\r\n        return () => {\r\n            if (topObserver.current) observer.disconnect();\r\n        };\r\n    }, [hasNextPage, isFetchingNextPage, fetchNextPage, isLoading]);\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"flex-1 flex items-center justify-center bg-linear-to-br from-slate-50/50 to-slate-100/50 dark:from-slate-900/50 dark:to-slate-950/50\">\r\n                <div className=\"flex flex-col items-center gap-3\">\r\n                    <Loader2 className=\"w-10 h-10 animate-spin text-emerald-500\" />\r\n                    <p className=\"text-sm text-slate-600 dark:text-slate-400\">Loading messages...</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const allMessages = data?.pages.flatMap((page) => page) || [];\r\n    const pinnedMessages = allMessages.filter(m => m.is_pinned || m.is_announcement);\r\n    // For flex-col-reverse, we keep messages in default order (Latest First)\r\n    // and let CSS handle the visual stacking (Latest at Bottom)\r\n    const regularMessages = allMessages.filter(m => !m.is_pinned && !m.is_announcement);\r\n\r\n    return (\r\n        <div className=\"flex-1 flex flex-col min-h-0 bg-linear-to-br from-slate-50/50 to-slate-100/50 dark:from-slate-900/50 dark:to-slate-950/50\">\r\n            {/* Pinned/Announcement Messages - Fixed at top */}\r\n            {pinnedMessages.length > 0 && (\r\n                <div className=\"flex-none bg-linear-to-r from-blue-50 to-purple-50 dark:from-blue-950/30 dark:to-purple-950/30 border-b border-blue-200 dark:border-blue-900/50 backdrop-blur-sm shadow-sm z-10\">\r\n                    <div className=\"px-4 py-2 flex items-center gap-2 border-b border-blue-200/50 dark:border-blue-900/30\">\r\n                        <Pin className=\"w-4 h-4 text-blue-600 dark:text-blue-400\" />\r\n                        <span className=\"text-xs font-bold text-blue-900 dark:text-blue-100 uppercase tracking-wide\">\r\n                            Pinned Messages\r\n                        </span>\r\n                    </div>\r\n                    <div className=\"max-h-32 overflow-y-auto\">\r\n                        {pinnedMessages.map((message) => (\r\n                            <MessageCard\r\n                                key={message.id}\r\n                                message={message}\r\n                                isOwnMessage={message.user_id === user?.id}\r\n                                isPinned={true}\r\n                            />\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Scrollable Message Area using flex-col-reverse for proper bottom anchoring */}\r\n            <div className=\"flex-1 overflow-y-auto px-2 flex flex-col-reverse scrollbar-thin scrollbar-thumb-slate-300 dark:scrollbar-thumb-slate-700 scrollbar-track-transparent pb-24\">\r\n\r\n                {/* Spacer at bottom */}\r\n                <div ref={bottomRef} className=\"h-1 flex-shrink-0\" />\r\n\r\n                {regularMessages.length === 0 && pinnedMessages.length === 0 ? (\r\n                    <div className=\"flex-1 flex flex-col items-center justify-center text-center px-4 py-12\">\r\n                        <div className=\"w-16 h-16 rounded-full bg-linear-to-br from-emerald-100 to-blue-100 dark:from-emerald-900/30 dark:to-blue-900/30 flex items-center justify-center mb-4\">\r\n                            <span className=\"text-3xl\">üí¨</span>\r\n                        </div>\r\n                        <h3 className=\"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-2\">\r\n                            No messages yet\r\n                        </h3>\r\n                        <p className=\"text-sm text-slate-600 dark:text-slate-400 max-w-sm\">\r\n                            Be the first to start the conversation!\r\n                        </p>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"space-y-1 flex flex-col-reverse\">\r\n                        {regularMessages.map((message) => (\r\n                            <div key={message.id} className=\"mb-1\">\r\n                                <MessageCard\r\n                                    message={message}\r\n                                    isOwnMessage={message.user_id === user?.id}\r\n                                />\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n\r\n                {/* Sentinel at the \"Top\" (visually) which is the end of the DOM list in flex-col-reverse */}\r\n                <div ref={topSentinelRef} className=\"w-full py-4 flex justify-center flex-shrink-0\">\r\n                    {isFetchingNextPage && <Loader2 className=\"w-4 h-4 animate-spin text-slate-400\" />}\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n"
        ],
        "names": [],
        "mappings": "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"
      }
    },
    {
      "offset": {
        "line": 6035,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/ui/textarea.tsx"
        ],
        "sourcesContent": [
          "import * as React from 'react'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Textarea({ className, ...props }: React.ComponentProps<'textarea'>) {\r\n  return (\r\n    <textarea\r\n      data-slot=\"textarea\"\r\n      className={cn(\r\n        'border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Textarea }\r\n"
        ],
        "names": [],
        "mappings": ";;;;;AAEA;;;AAEA,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAyC;IACzE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,ucACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS"
      }
    },
    {
      "offset": {
        "line": 6065,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/hooks/community/useChannelUsers.ts"
        ],
        "sourcesContent": [
          "import { useQuery } from \"@tanstack/react-query\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\n\r\nexport function useChannelUsers(channelId: string | undefined) {\r\n    return useQuery({\r\n        queryKey: [\"channel-users\", channelId],\r\n        queryFn: async () => {\r\n            if (!channelId) return [];\r\n\r\n            const supabase = createClient();\r\n\r\n            // Get the channel to find its course\r\n            const { data: channel } = await supabase\r\n                .from(\"community_channels\")\r\n                .select(\"course_id\")\r\n                .eq(\"id\", channelId)\r\n                .single();\r\n\r\n            if (!channel) return [];\r\n\r\n            // Get all users enrolled in this course\r\n            const { data: enrollments } = await supabase\r\n                .from(\"enrollments\")\r\n                .select(`\r\n                    user_id,\r\n                    profiles:user_id (\r\n                        id,\r\n                        full_name,\r\n                        avatar_url\r\n                    )\r\n                `)\r\n                .eq(\"course_id\", channel.course_id);\r\n\r\n            if (!enrollments) return [];\r\n\r\n            // Format the data\r\n            return enrollments.map((enrollment: any) => ({\r\n                id: enrollment.profiles.id,\r\n                full_name: enrollment.profiles.full_name,\r\n                avatar_url: enrollment.profiles.avatar_url,\r\n            }));\r\n        },\r\n        enabled: !!channelId,\r\n    });\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;AAAA;AACA;;;;AAEO,SAAS,gBAAgB,SAA6B;;IACzD,OAAO,IAAA,0LAAQ,EAAC;QACZ,UAAU;YAAC;YAAiB;SAAU;QACtC,OAAO;wCAAE;gBACL,IAAI,CAAC,WAAW,OAAO,EAAE;gBAEzB,MAAM,WAAW,IAAA,4IAAY;gBAE7B,qCAAqC;gBACrC,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,sBACL,MAAM,CAAC,aACP,EAAE,CAAC,MAAM,WACT,MAAM;gBAEX,IAAI,CAAC,SAAS,OAAO,EAAE;gBAEvB,wCAAwC;gBACxC,MAAM,EAAE,MAAM,WAAW,EAAE,GAAG,MAAM,SAC/B,IAAI,CAAC,eACL,MAAM,CAAC,CAAC;;;;;;;gBAOT,CAAC,EACA,EAAE,CAAC,aAAa,QAAQ,SAAS;gBAEtC,IAAI,CAAC,aAAa,OAAO,EAAE;gBAE3B,kBAAkB;gBAClB,OAAO,YAAY,GAAG;gDAAC,CAAC,aAAoB,CAAC;4BACzC,IAAI,WAAW,QAAQ,CAAC,EAAE;4BAC1B,WAAW,WAAW,QAAQ,CAAC,SAAS;4BACxC,YAAY,WAAW,QAAQ,CAAC,UAAU;wBAC9C,CAAC;;YACL;;QACA,SAAS,CAAC,CAAC;IACf;AACJ;GAzCgB;;QACL,0LAAQ"
      }
    },
    {
      "offset": {
        "line": 6123,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/community/MessageInput.tsx"
        ],
        "sourcesContent": [
          "import { useState, useRef, useEffect } from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Send, Paperclip, Smile, Loader2 } from \"lucide-react\";\r\nimport { useSendMessage } from \"@/hooks/community\";\r\nimport { useChannelUsers } from \"@/hooks/community/useChannelUsers\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\n\r\ninterface MessageInputProps {\r\n    channelId: string;\r\n}\r\n\r\nexport const MessageInput = ({ channelId }: MessageInputProps) => {\r\n    const [content, setContent] = useState(\"\");\r\n    const [showMentions, setShowMentions] = useState(false);\r\n    const [mentionSearch, setMentionSearch] = useState(\"\");\r\n    const [mentionStartPos, setMentionStartPos] = useState(0);\r\n    const [selectedMentionIndex, setSelectedMentionIndex] = useState(0);\r\n    const textareaRef = useRef<HTMLTextAreaElement>(null);\r\n\r\n    const { mutate: sendMessage, isPending } = useSendMessage(channelId);\r\n    const { data: users = [] } = useChannelUsers(channelId);\r\n\r\n    // Filter users based on mention search\r\n    const filteredUsers = users.filter(user =>\r\n        user.full_name?.toLowerCase().includes(mentionSearch.toLowerCase())\r\n    );\r\n\r\n    // Detect @ mentions\r\n    useEffect(() => {\r\n        const cursorPos = textareaRef.current?.selectionStart || 0;\r\n        const textBeforeCursor = content.substring(0, cursorPos);\r\n        const lastAtSymbol = textBeforeCursor.lastIndexOf('@');\r\n\r\n        if (lastAtSymbol !== -1) {\r\n            const textAfterAt = textBeforeCursor.substring(lastAtSymbol + 1);\r\n            // Check if there's no space after @\r\n            if (!textAfterAt.includes(' ')) {\r\n                setMentionSearch(textAfterAt);\r\n                setMentionStartPos(lastAtSymbol);\r\n                setShowMentions(true);\r\n                setSelectedMentionIndex(0);\r\n                return;\r\n            }\r\n        }\r\n        setShowMentions(false);\r\n    }, [content]);\r\n\r\n    const insertMention = (userName: string) => {\r\n        const beforeMention = content.substring(0, mentionStartPos);\r\n        const afterCursor = content.substring(textareaRef.current?.selectionStart || 0);\r\n        const newContent = `${beforeMention}@${userName} ${afterCursor}`;\r\n        setContent(newContent);\r\n        setShowMentions(false);\r\n\r\n        // Focus back on textarea\r\n        setTimeout(() => {\r\n            textareaRef.current?.focus();\r\n            const newCursorPos = mentionStartPos + userName.length + 2;\r\n            textareaRef.current?.setSelectionRange(newCursorPos, newCursorPos);\r\n        }, 0);\r\n    };\r\n\r\n    const handleSubmit = (e?: React.FormEvent) => {\r\n        e?.preventDefault();\r\n        if (!content.trim() || isPending) return;\r\n\r\n        sendMessage(\r\n            { content },\r\n            {\r\n                onSuccess: () => setContent(\"\"),\r\n            }\r\n        );\r\n    };\r\n\r\n    const handleKeyDown = (e: React.KeyboardEvent) => {\r\n        if (showMentions && filteredUsers.length > 0) {\r\n            if (e.key === \"ArrowDown\") {\r\n                e.preventDefault();\r\n                setSelectedMentionIndex((prev) =>\r\n                    prev < filteredUsers.length - 1 ? prev + 1 : prev\r\n                );\r\n                return;\r\n            }\r\n            if (e.key === \"ArrowUp\") {\r\n                e.preventDefault();\r\n                setSelectedMentionIndex((prev) => (prev > 0 ? prev - 1 : 0));\r\n                return;\r\n            }\r\n            if (e.key === \"Enter\" || e.key === \"Tab\") {\r\n                e.preventDefault();\r\n                insertMention(filteredUsers[selectedMentionIndex].full_name);\r\n                return;\r\n            }\r\n            if (e.key === \"Escape\") {\r\n                setShowMentions(false);\r\n                return;\r\n            }\r\n        }\r\n\r\n        if (e.key === \"Enter\" && !e.shiftKey) {\r\n            e.preventDefault();\r\n            handleSubmit();\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"p-4 md:p-6 bg-white/80 dark:bg-slate-900/80 border-t border-slate-200/80 dark:border-slate-800/80 backdrop-blur-xl relative\">\r\n            {/* Mention Dropdown */}\r\n            {showMentions && filteredUsers.length > 0 && (\r\n                <div className=\"absolute bottom-full left-4 right-4 mb-2 bg-white dark:bg-slate-800 rounded-xl shadow-2xl border border-slate-200 dark:border-slate-700 max-h-64 overflow-y-auto z-50\">\r\n                    <div className=\"p-2 space-y-1\">\r\n                        {filteredUsers.map((user, index) => (\r\n                            <button\r\n                                key={user.id}\r\n                                onClick={() => insertMention(user.full_name)}\r\n                                className={cn(\r\n                                    \"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-left transition-colors\",\r\n                                    index === selectedMentionIndex\r\n                                        ? \"bg-emerald-100 dark:bg-emerald-900/30\"\r\n                                        : \"hover:bg-slate-100 dark:hover:bg-slate-700\"\r\n                                )}\r\n                            >\r\n                                <Avatar className=\"h-8 w-8\">\r\n                                    <AvatarImage src={user.avatar_url} />\r\n                                    <AvatarFallback className=\"bg-linear-to-br from-emerald-500 to-blue-600 text-white text-xs\">\r\n                                        {user.full_name?.substring(0, 2).toUpperCase()}\r\n                                    </AvatarFallback>\r\n                                </Avatar>\r\n                                <span className=\"text-sm font-medium\">{user.full_name}</span>\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            <div className=\"relative flex items-end gap-3 bg-slate-100/80 dark:bg-slate-800/80 p-3 rounded-2xl border-2 border-transparent focus-within:border-emerald-500/50 dark:focus-within:border-emerald-500/30 transition-all shadow-sm hover:shadow-md\">\r\n                <Button\r\n                    variant=\"ghost\"\r\n                    size=\"icon\"\r\n                    className=\"h-10 w-10 rounded-xl text-slate-500 dark:text-slate-400 hover:text-emerald-600 dark:hover:text-emerald-400 hover:bg-white/50 dark:hover:bg-slate-700/50 shrink-0\"\r\n                >\r\n                    <Paperclip className=\"w-5 h-5\" />\r\n                </Button>\r\n\r\n                <Textarea\r\n                    ref={textareaRef}\r\n                    value={content}\r\n                    onChange={(e) => setContent(e.target.value)}\r\n                    onKeyDown={handleKeyDown}\r\n                    placeholder=\"Type a message... (Use @ to mention someone)\"\r\n                    disabled={isPending}\r\n                    className=\"min-h-[48px] max-h-[180px] border-0 bg-transparent focus-visible:ring-0 resize-none py-3 px-2 text-sm placeholder:text-slate-400 dark:placeholder:text-slate-500 text-slate-900 dark:text-slate-100\"\r\n                    rows={1}\r\n                />\r\n\r\n                <div className=\"flex items-center gap-2 pb-1 shrink-0\">\r\n                    <Button\r\n                        variant=\"ghost\"\r\n                        size=\"icon\"\r\n                        className=\"h-10 w-10 rounded-xl text-slate-500 dark:text-slate-400 hover:text-emerald-600 dark:hover:text-emerald-400 hover:bg-white/50 dark:hover:bg-slate-700/50\"\r\n                    >\r\n                        <Smile className=\"w-5 h-5\" />\r\n                    </Button>\r\n                    <Button\r\n                        onClick={() => handleSubmit()}\r\n                        disabled={!content.trim() || isPending}\r\n                        size=\"icon\"\r\n                        className={cn(\r\n                            \"h-10 w-10 rounded-xl transition-all duration-200 shadow-md\",\r\n                            content.trim() && !isPending\r\n                                ? \"bg-linear-to-r from-emerald-600 to-blue-600 hover:from-emerald-700 hover:to-blue-700 text-white shadow-emerald-500/50 dark:shadow-emerald-500/30 hover:shadow-lg hover:scale-105\"\r\n                                : \"bg-slate-300 dark:bg-slate-700 text-slate-500 dark:text-slate-500 cursor-not-allowed opacity-60\"\r\n                        )}\r\n                    >\r\n                        {isPending ? (\r\n                            <Loader2 className=\"w-5 h-5 animate-spin\" />\r\n                        ) : (\r\n                            <Send className=\"w-5 h-5\" />\r\n                        )}\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n            <div className=\"text-[11px] text-slate-500 dark:text-slate-500 mt-2.5 text-center flex items-center justify-center gap-2\">\r\n                <span>Press</span>\r\n                <kbd className=\"font-mono px-2 py-0.5 bg-slate-200 dark:bg-slate-800 rounded border border-slate-300 dark:border-slate-700 text-[10px] font-semibold\">Enter</kbd>\r\n                <span>to send</span>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n"
        ],
        "names": [],
        "mappings": "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"
      }
    },
    {
      "offset": {
        "line": 6433,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/community/index.tsx"
        ],
        "sourcesContent": [
          "export * from \"./ChannelSidebar\";\r\nexport * from \"./MessageList\";\r\nexport * from \"./MessageInput\";\r\nexport * from \"./MessageCard\";\r\n"
        ],
        "names": [],
        "mappings": ";AAAA;AACA;AACA;AACA"
      }
    },
    {
      "offset": {
        "line": 6449,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/hooks/admin/useAdminCoursesWithChannels.ts"
        ],
        "sourcesContent": [
          "import { useQuery } from \"@tanstack/react-query\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\nimport { CommunityChannel } from \"@/types/community\";\r\n\r\nconst supabase = createClient();\r\n\r\nexport interface AdminCourseWithChannels {\r\n    id: string;\r\n    title: string;\r\n    thumbnail_url: string | null;\r\n    category: string | null;\r\n    community_enabled: boolean;\r\n    channels: CommunityChannel[];\r\n}\r\n\r\nexport const useAdminCoursesWithChannels = (userId: string | undefined) => {\r\n    return useQuery({\r\n        queryKey: [\"admin\", \"courses-with-channels\", userId],\r\n        queryFn: async () => {\r\n            if (!userId) return [];\r\n\r\n            const { data, error } = await supabase\r\n                .from(\"courses\")\r\n                .select(`\r\n                    id,\r\n                    title,\r\n                    thumbnail_url,\r\n                    category,\r\n                    community_enabled\r\n                `)\r\n                .eq(\"creator_id\", userId);\r\n\r\n            if (error) throw error;\r\n\r\n            // Fetch channels for each course\r\n            const coursesWithChannels = await Promise.all(\r\n                (data || []).map(async (course) => {\r\n                    const { data: channels } = await supabase\r\n                        .from(\"community_channels\")\r\n                        .select(\"*\")\r\n                        .eq(\"course_id\", course.id)\r\n                        .order(\"created_at\", { ascending: true });\r\n\r\n                    return {\r\n                        ...course,\r\n                        channels: channels || [],\r\n                    };\r\n                })\r\n            );\r\n\r\n            return coursesWithChannels as AdminCourseWithChannels[];\r\n        },\r\n        enabled: !!userId,\r\n    });\r\n};\r\n"
        ],
        "names": [],
        "mappings": ";;;;AAAA;AACA;;;;AAGA,MAAM,WAAW,IAAA,4IAAY;AAWtB,MAAM,8BAA8B,CAAC;;IACxC,OAAO,IAAA,0LAAQ,EAAC;QACZ,UAAU;YAAC;YAAS;YAAyB;SAAO;QACpD,OAAO;oDAAE;gBACL,IAAI,CAAC,QAAQ,OAAO,EAAE;gBAEtB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SACzB,IAAI,CAAC,WACL,MAAM,CAAC,CAAC;;;;;;gBAMT,CAAC,EACA,EAAE,CAAC,cAAc;gBAEtB,IAAI,OAAO,MAAM;gBAEjB,iCAAiC;gBACjC,MAAM,sBAAsB,MAAM,QAAQ,GAAG,CACzC,CAAC,QAAQ,EAAE,EAAE,GAAG;4DAAC,OAAO;wBACpB,MAAM,EAAE,MAAM,QAAQ,EAAE,GAAG,MAAM,SAC5B,IAAI,CAAC,sBACL,MAAM,CAAC,KACP,EAAE,CAAC,aAAa,OAAO,EAAE,EACzB,KAAK,CAAC,cAAc;4BAAE,WAAW;wBAAK;wBAE3C,OAAO;4BACH,GAAG,MAAM;4BACT,UAAU,YAAY,EAAE;wBAC5B;oBACJ;;gBAGJ,OAAO;YACX;;QACA,SAAS,CAAC,CAAC;IACf;AACJ;GAvCa;;QACF,0LAAQ"
      }
    },
    {
      "offset": {
        "line": 6508,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/ui/card.tsx"
        ],
        "sourcesContent": [
          "import * as React from 'react'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Card({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card\"\r\n      className={cn(\r\n        'bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardHeader({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-header\"\r\n      className={cn(\r\n        '@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardTitle({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-title\"\r\n      className={cn('leading-none font-semibold', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardDescription({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-description\"\r\n      className={cn('text-muted-foreground text-sm', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardAction({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-action\"\r\n      className={cn(\r\n        'col-start-2 row-span-2 row-start-1 self-start justify-self-end',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardContent({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-content\"\r\n      className={cn('px-6', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardFooter({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-footer\"\r\n      className={cn('flex items-center px-6 [.border-t]:pt-6', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {\r\n  Card,\r\n  CardHeader,\r\n  CardFooter,\r\n  CardTitle,\r\n  CardAction,\r\n  CardDescription,\r\n  CardContent,\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf;MARS"
      }
    },
    {
      "offset": {
        "line": 6628,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/ui/badge.tsx"
        ],
        "sourcesContent": [
          "import * as React from 'react'\r\nimport { Slot } from '@radix-ui/react-slot'\r\nimport { cva, type VariantProps } from 'class-variance-authority'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nconst badgeVariants = cva(\r\n  'inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden',\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default:\r\n          'border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90',\r\n        secondary:\r\n          'border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90',\r\n        destructive:\r\n          'border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\r\n        outline:\r\n          'text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground',\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: 'default',\r\n    },\r\n  },\r\n)\r\n\r\nfunction Badge({\r\n  className,\r\n  variant,\r\n  asChild = false,\r\n  ...props\r\n}: React.ComponentProps<'span'> &\r\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\r\n  const Comp = asChild ? Slot : 'span'\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"badge\"\r\n      className={cn(badgeVariants({ variant }), className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Badge, badgeVariants }\r\n"
        ],
        "names": [],
        "mappings": ";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,IAAA,0KAAG,EACvB,kZACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,UAAU,KAAK,EACf,GAAG,OAEuD;IAC1D,MAAM,OAAO,UAAU,2KAAI,GAAG;IAE9B,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf;KAhBS"
      }
    },
    {
      "offset": {
        "line": 6680,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/hooks/admin/useToggleCommunity.ts"
        ],
        "sourcesContent": [
          "import { useMutation, useQueryClient } from \"@tanstack/react-query\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\nimport { toast } from \"sonner\";\r\n\r\nconst supabase = createClient();\r\n\r\nexport const useToggleCommunity = () => {\r\n    const queryClient = useQueryClient();\r\n\r\n    return useMutation({\r\n        mutationFn: async ({ courseId, enabled }: { courseId: string; enabled: boolean }) => {\r\n            const { error } = await supabase\r\n                .from(\"courses\")\r\n                .update({ community_enabled: enabled })\r\n                .eq(\"id\", courseId);\r\n\r\n            if (error) throw error;\r\n        },\r\n        onSuccess: (_, { courseId, enabled }) => {\r\n            queryClient.invalidateQueries({ queryKey: [\"courses\"] });\r\n            queryClient.invalidateQueries({ queryKey: [\"course\", courseId] });\r\n            queryClient.invalidateQueries({ queryKey: [\"admin\", \"courses-with-channels\"] });\r\n            toast.success(enabled ? \"Community enabled!\" : \"Community disabled\");\r\n        },\r\n        onError: (error: any) => {\r\n            toast.error(error.message || \"Failed to toggle community\");\r\n            console.error(\"Toggle community error:\", error);\r\n        }\r\n    });\r\n};\r\n"
        ],
        "names": [],
        "mappings": ";;;;AAAA;AAAA;AACA;AACA;;;;;AAEA,MAAM,WAAW,IAAA,4IAAY;AAEtB,MAAM,qBAAqB;;IAC9B,MAAM,cAAc,IAAA,2MAAc;IAElC,OAAO,IAAA,gMAAW,EAAC;QACf,UAAU;8CAAE,OAAO,EAAE,QAAQ,EAAE,OAAO,EAA0C;gBAC5E,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SACnB,IAAI,CAAC,WACL,MAAM,CAAC;oBAAE,mBAAmB;gBAAQ,GACpC,EAAE,CAAC,MAAM;gBAEd,IAAI,OAAO,MAAM;YACrB;;QACA,SAAS;8CAAE,CAAC,GAAG,EAAE,QAAQ,EAAE,OAAO,EAAE;gBAChC,YAAY,iBAAiB,CAAC;oBAAE,UAAU;wBAAC;qBAAU;gBAAC;gBACtD,YAAY,iBAAiB,CAAC;oBAAE,UAAU;wBAAC;wBAAU;qBAAS;gBAAC;gBAC/D,YAAY,iBAAiB,CAAC;oBAAE,UAAU;wBAAC;wBAAS;qBAAwB;gBAAC;gBAC7E,oJAAK,CAAC,OAAO,CAAC,UAAU,uBAAuB;YACnD;;QACA,OAAO;8CAAE,CAAC;gBACN,oJAAK,CAAC,KAAK,CAAC,MAAM,OAAO,IAAI;gBAC7B,QAAQ,KAAK,CAAC,2BAA2B;YAC7C;;IACJ;AACJ;GAvBa;;QACW,2MAAc;QAE3B,gMAAW"
      }
    },
    {
      "offset": {
        "line": 6748,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/ui/switch.tsx"
        ],
        "sourcesContent": [
          "'use client'\r\n\r\nimport * as React from 'react'\r\nimport * as SwitchPrimitive from '@radix-ui/react-switch'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Switch({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof SwitchPrimitive.Root>) {\r\n  return (\r\n    <SwitchPrimitive.Root\r\n      data-slot=\"switch\"\r\n      className={cn(\r\n        'peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50',\r\n        className,\r\n      )}\r\n      {...props}\r\n    >\r\n      <SwitchPrimitive.Thumb\r\n        data-slot=\"switch-thumb\"\r\n        className={\r\n          'bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0'\r\n        }\r\n      />\r\n    </SwitchPrimitive.Root>\r\n  )\r\n}\r\n\r\nexport { Switch }\r\n"
        ],
        "names": [],
        "mappings": ";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,OAAO,EACd,SAAS,EACT,GAAG,OAC+C;IAClD,qBACE,6LAAC,6KAAoB;QACnB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,6WACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,8KAAqB;YACpB,aAAU;YACV,WACE;;;;;;;;;;;AAKV;KArBS"
      }
    },
    {
      "offset": {
        "line": 6789,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/ui/label.tsx"
        ],
        "sourcesContent": [
          "'use client'\r\n\r\nimport * as React from 'react'\r\nimport * as LabelPrimitive from '@radix-ui/react-label'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Label({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\r\n  return (\r\n    <LabelPrimitive.Root\r\n      data-slot=\"label\"\r\n      className={cn(\r\n        'flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Label }\r\n"
        ],
        "names": [],
        "mappings": ";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,MAAM,EACb,SAAS,EACT,GAAG,OAC8C;IACjD,qBACE,6LAAC,4KAAmB;QAClB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,uNACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS"
      }
    },
    {
      "offset": {
        "line": 6822,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/ui/input.tsx"
        ],
        "sourcesContent": [
          "import * as React from 'react'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Input({ className, type, ...props }: React.ComponentProps<'input'>) {\r\n  return (\r\n    <input\r\n      type={type}\r\n      data-slot=\"input\"\r\n      className={cn(\r\n        'file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\r\n        'focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]',\r\n        'aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Input }\r\n"
        ],
        "names": [],
        "mappings": ";;;;;AAEA;;;AAEA,SAAS,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAsC;IACzE,qBACE,6LAAC;QACC,MAAM;QACN,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,8bACA,iFACA,0GACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS"
      }
    },
    {
      "offset": {
        "line": 6853,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/ui/select.tsx"
        ],
        "sourcesContent": [
          "'use client'\r\n\r\nimport * as React from 'react'\r\nimport * as SelectPrimitive from '@radix-ui/react-select'\r\nimport { CheckIcon, ChevronDownIcon, ChevronUpIcon } from 'lucide-react'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Select({\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Root>) {\r\n  return <SelectPrimitive.Root data-slot=\"select\" {...props} />\r\n}\r\n\r\nfunction SelectGroup({\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Group>) {\r\n  return <SelectPrimitive.Group data-slot=\"select-group\" {...props} />\r\n}\r\n\r\nfunction SelectValue({\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Value>) {\r\n  return <SelectPrimitive.Value data-slot=\"select-value\" {...props} />\r\n}\r\n\r\nfunction SelectTrigger({\r\n  className,\r\n  size = 'default',\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Trigger> & {\r\n  size?: 'sm' | 'default'\r\n}) {\r\n  return (\r\n    <SelectPrimitive.Trigger\r\n      data-slot=\"select-trigger\"\r\n      data-size={size}\r\n      className={cn(\r\n        \"border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    >\r\n      {children}\r\n      <SelectPrimitive.Icon asChild>\r\n        <ChevronDownIcon className=\"size-4 opacity-50\" />\r\n      </SelectPrimitive.Icon>\r\n    </SelectPrimitive.Trigger>\r\n  )\r\n}\r\n\r\nfunction SelectContent({\r\n  className,\r\n  children,\r\n  position = 'popper',\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Content>) {\r\n  return (\r\n    <SelectPrimitive.Portal>\r\n      <SelectPrimitive.Content\r\n        data-slot=\"select-content\"\r\n        className={cn(\r\n          'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md',\r\n          position === 'popper' &&\r\n            'data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1',\r\n          className,\r\n        )}\r\n        position={position}\r\n        {...props}\r\n      >\r\n        <SelectScrollUpButton />\r\n        <SelectPrimitive.Viewport\r\n          className={cn(\r\n            'p-1',\r\n            position === 'popper' &&\r\n              'h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1',\r\n          )}\r\n        >\r\n          {children}\r\n        </SelectPrimitive.Viewport>\r\n        <SelectScrollDownButton />\r\n      </SelectPrimitive.Content>\r\n    </SelectPrimitive.Portal>\r\n  )\r\n}\r\n\r\nfunction SelectLabel({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Label>) {\r\n  return (\r\n    <SelectPrimitive.Label\r\n      data-slot=\"select-label\"\r\n      className={cn('text-muted-foreground px-2 py-1.5 text-xs', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SelectItem({\r\n  className,\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Item>) {\r\n  return (\r\n    <SelectPrimitive.Item\r\n      data-slot=\"select-item\"\r\n      className={cn(\r\n        \"focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    >\r\n      <span className=\"absolute right-2 flex size-3.5 items-center justify-center\">\r\n        <SelectPrimitive.ItemIndicator>\r\n          <CheckIcon className=\"size-4\" />\r\n        </SelectPrimitive.ItemIndicator>\r\n      </span>\r\n      <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\r\n    </SelectPrimitive.Item>\r\n  )\r\n}\r\n\r\nfunction SelectSeparator({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Separator>) {\r\n  return (\r\n    <SelectPrimitive.Separator\r\n      data-slot=\"select-separator\"\r\n      className={cn('bg-border pointer-events-none -mx-1 my-1 h-px', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SelectScrollUpButton({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.ScrollUpButton>) {\r\n  return (\r\n    <SelectPrimitive.ScrollUpButton\r\n      data-slot=\"select-scroll-up-button\"\r\n      className={cn(\r\n        'flex cursor-default items-center justify-center py-1',\r\n        className,\r\n      )}\r\n      {...props}\r\n    >\r\n      <ChevronUpIcon className=\"size-4\" />\r\n    </SelectPrimitive.ScrollUpButton>\r\n  )\r\n}\r\n\r\nfunction SelectScrollDownButton({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.ScrollDownButton>) {\r\n  return (\r\n    <SelectPrimitive.ScrollDownButton\r\n      data-slot=\"select-scroll-down-button\"\r\n      className={cn(\r\n        'flex cursor-default items-center justify-center py-1',\r\n        className,\r\n      )}\r\n      {...props}\r\n    >\r\n      <ChevronDownIcon className=\"size-4\" />\r\n    </SelectPrimitive.ScrollDownButton>\r\n  )\r\n}\r\n\r\nexport {\r\n  Select,\r\n  SelectContent,\r\n  SelectGroup,\r\n  SelectItem,\r\n  SelectLabel,\r\n  SelectScrollDownButton,\r\n  SelectScrollUpButton,\r\n  SelectSeparator,\r\n  SelectTrigger,\r\n  SelectValue,\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;;;;;;;;;;;;;;;;;;;;AAGA;AACA;AAAA;AAAA;AAEA;AANA;;;;;AAQA,SAAS,OAAO,EACd,GAAG,OAC+C;IAClD,qBAAO,6LAAC,6KAAoB;QAAC,aAAU;QAAU,GAAG,KAAK;;;;;;AAC3D;KAJS;AAMT,SAAS,YAAY,EACnB,GAAG,OACgD;IACnD,qBAAO,6LAAC,8KAAqB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;MAJS;AAMT,SAAS,YAAY,EACnB,GAAG,OACgD;IACnD,qBAAO,6LAAC,8KAAqB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;MAJS;AAMT,SAAS,cAAc,EACrB,SAAS,EACT,OAAO,SAAS,EAChB,QAAQ,EACR,GAAG,OAGJ;IACC,qBACE,6LAAC,gLAAuB;QACtB,aAAU;QACV,aAAW;QACX,WAAW,IAAA,qHAAE,EACX,gzBACA;QAED,GAAG,KAAK;;YAER;0BACD,6LAAC,6KAAoB;gBAAC,OAAO;0BAC3B,cAAA,6LAAC,8OAAe;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAInC;MAxBS;AA0BT,SAAS,cAAc,EACrB,SAAS,EACT,QAAQ,EACR,WAAW,QAAQ,EACnB,GAAG,OACkD;IACrD,qBACE,6LAAC,+KAAsB;kBACrB,cAAA,6LAAC,gLAAuB;YACtB,aAAU;YACV,WAAW,IAAA,qHAAE,EACX,ijBACA,aAAa,YACX,mIACF;YAEF,UAAU;YACT,GAAG,KAAK;;8BAET,6LAAC;;;;;8BACD,6LAAC,iLAAwB;oBACvB,WAAW,IAAA,qHAAE,EACX,OACA,aAAa,YACX;8BAGH;;;;;;8BAEH,6LAAC;;;;;;;;;;;;;;;;AAIT;MAjCS;AAmCT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6LAAC,8KAAqB;QACpB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,6CAA6C;QAC1D,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,WAAW,EAClB,SAAS,EACT,QAAQ,EACR,GAAG,OAC+C;IAClD,qBACE,6LAAC,6KAAoB;QACnB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,6aACA;QAED,GAAG,KAAK;;0BAET,6LAAC;gBAAK,WAAU;0BACd,cAAA,6LAAC,sLAA6B;8BAC5B,cAAA,6LAAC,wNAAS;wBAAC,WAAU;;;;;;;;;;;;;;;;0BAGzB,6LAAC,iLAAwB;0BAAE;;;;;;;;;;;;AAGjC;MAtBS;AAwBT,SAAS,gBAAgB,EACvB,SAAS,EACT,GAAG,OACoD;IACvD,qBACE,6LAAC,kLAAyB;QACxB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,iDAAiD;QAC9D,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,qBAAqB,EAC5B,SAAS,EACT,GAAG,OACyD;IAC5D,qBACE,6LAAC,uLAA8B;QAC7B,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,wDACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,wOAAa;YAAC,WAAU;;;;;;;;;;;AAG/B;MAhBS;AAkBT,SAAS,uBAAuB,EAC9B,SAAS,EACT,GAAG,OAC2D;IAC9D,qBACE,6LAAC,yLAAgC;QAC/B,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,wDACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,8OAAe;YAAC,WAAU;;;;;;;;;;;AAGjC;MAhBS"
      }
    },
    {
      "offset": {
        "line": 7110,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/hooks/admin/useCreateChannel.ts"
        ],
        "sourcesContent": [
          "import { useMutation, useQueryClient } from \"@tanstack/react-query\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\nimport { toast } from \"sonner\";\r\n\r\nconst supabase = createClient();\r\n\r\nexport const useCreateChannel = () => {\r\n    const queryClient = useQueryClient();\r\n\r\n    return useMutation({\r\n        mutationFn: async ({\r\n            courseId,\r\n            name,\r\n            type,\r\n            description\r\n        }: {\r\n            courseId: string;\r\n            name: string;\r\n            type: 'announcement' | 'discussion' | 'qa';\r\n            description: string;\r\n        }) => {\r\n            const { data, error } = await supabase\r\n                .from(\"community_channels\")\r\n                .insert({\r\n                    course_id: courseId,\r\n                    name: name.toLowerCase().replace(/\\s+/g, '-'),\r\n                    type,\r\n                    description,\r\n                    is_active: true\r\n                })\r\n                .select()\r\n                .single();\r\n\r\n            if (error) throw error;\r\n            return data;\r\n        },\r\n        onSuccess: () => {\r\n            queryClient.invalidateQueries({ queryKey: [\"community\", \"channels\"] });\r\n            queryClient.invalidateQueries({ queryKey: [\"admin\", \"courses-with-channels\"] });\r\n            toast.success(\"Channel created successfully!\");\r\n        },\r\n        onError: (error: any) => {\r\n            if (error.code === '23505') {\r\n                toast.error(\"A channel with this name already exists\");\r\n            } else {\r\n                toast.error(error.message || \"Failed to create channel\");\r\n            }\r\n            console.error(\"Create channel error:\", error);\r\n        }\r\n    });\r\n};\r\n"
        ],
        "names": [],
        "mappings": ";;;;AAAA;AAAA;AACA;AACA;;;;;AAEA,MAAM,WAAW,IAAA,4IAAY;AAEtB,MAAM,mBAAmB;;IAC5B,MAAM,cAAc,IAAA,2MAAc;IAElC,OAAO,IAAA,gMAAW,EAAC;QACf,UAAU;4CAAE,OAAO,EACf,QAAQ,EACR,IAAI,EACJ,IAAI,EACJ,WAAW,EAMd;gBACG,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SACzB,IAAI,CAAC,sBACL,MAAM,CAAC;oBACJ,WAAW;oBACX,MAAM,KAAK,WAAW,GAAG,OAAO,CAAC,QAAQ;oBACzC;oBACA;oBACA,WAAW;gBACf,GACC,MAAM,GACN,MAAM;gBAEX,IAAI,OAAO,MAAM;gBACjB,OAAO;YACX;;QACA,SAAS;4CAAE;gBACP,YAAY,iBAAiB,CAAC;oBAAE,UAAU;wBAAC;wBAAa;qBAAW;gBAAC;gBACpE,YAAY,iBAAiB,CAAC;oBAAE,UAAU;wBAAC;wBAAS;qBAAwB;gBAAC;gBAC7E,oJAAK,CAAC,OAAO,CAAC;YAClB;;QACA,OAAO;4CAAE,CAAC;gBACN,IAAI,MAAM,IAAI,KAAK,SAAS;oBACxB,oJAAK,CAAC,KAAK,CAAC;gBAChB,OAAO;oBACH,oJAAK,CAAC,KAAK,CAAC,MAAM,OAAO,IAAI;gBACjC;gBACA,QAAQ,KAAK,CAAC,yBAAyB;YAC3C;;IACJ;AACJ;GA5Ca;;QACW,2MAAc;QAE3B,gMAAW"
      }
    },
    {
      "offset": {
        "line": 7182,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/admin/AddChannelDialog.tsx"
        ],
        "sourcesContent": [
          "\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogHeader,\r\n    DialogTitle,\r\n} from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { useCreateChannel } from \"@/hooks/admin/useCreateChannel\";\r\nimport { Loader2 } from \"lucide-react\";\r\n\r\ninterface AddChannelDialogProps {\r\n    open: boolean;\r\n    onOpenChange: (open: boolean) => void;\r\n    courseId: string;\r\n}\r\n\r\nexport function AddChannelDialog({ open, onOpenChange, courseId }: AddChannelDialogProps) {\r\n    const [name, setName] = useState(\"\");\r\n    const [type, setType] = useState<\"announcement\" | \"discussion\" | \"qa\">(\"discussion\");\r\n    const [description, setDescription] = useState(\"\");\r\n\r\n    const { mutate: createChannel, isPending } = useCreateChannel();\r\n\r\n    const handleSubmit = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n\r\n        if (!name.trim()) {\r\n            return;\r\n        }\r\n\r\n        createChannel(\r\n            { courseId, name: name.trim(), type, description: description.trim() },\r\n            {\r\n                onSuccess: () => {\r\n                    setName(\"\");\r\n                    setType(\"discussion\");\r\n                    setDescription(\"\");\r\n                    onOpenChange(false);\r\n                }\r\n            }\r\n        );\r\n    };\r\n\r\n    const getTypeDescription = (type: string) => {\r\n        switch (type) {\r\n            case 'announcement':\r\n                return 'Only instructors can post. Students can read and react.';\r\n            case 'qa':\r\n                return 'Students can ask questions. Everyone can answer.';\r\n            case 'discussion':\r\n                return 'Open discussion for all students and instructors.';\r\n            default:\r\n                return '';\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={onOpenChange}>\r\n            <DialogContent className=\"sm:max-w-[500px]\">\r\n                <form onSubmit={handleSubmit}>\r\n                    <DialogHeader>\r\n                        <DialogTitle>Add New Channel</DialogTitle>\r\n                        <DialogDescription>\r\n                            Create a new channel for your course community. Choose a name and type.\r\n                        </DialogDescription>\r\n                    </DialogHeader>\r\n\r\n                    <div className=\"space-y-4 py-4\">\r\n                        {/* Channel Name */}\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"name\">Channel Name</Label>\r\n                            <Input\r\n                                id=\"name\"\r\n                                placeholder=\"e.g., homework-help\"\r\n                                value={name}\r\n                                onChange={(e) => setName(e.target.value)}\r\n                                disabled={isPending}\r\n                                required\r\n                            />\r\n                            <p className=\"text-xs text-muted-foreground\">\r\n                                Use lowercase letters, numbers, and hyphens only\r\n                            </p>\r\n                        </div>\r\n\r\n                        {/* Channel Type */}\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"type\">Channel Type</Label>\r\n                            <Select\r\n                                value={type}\r\n                                onValueChange={(value: any) => setType(value)}\r\n                                disabled={isPending}\r\n                            >\r\n                                <SelectTrigger id=\"type\">\r\n                                    <SelectValue />\r\n                                </SelectTrigger>\r\n                                <SelectContent>\r\n                                    <SelectItem value=\"discussion\">\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            <span>üí¨</span>\r\n                                            <span>Discussion</span>\r\n                                        </div>\r\n                                    </SelectItem>\r\n                                    <SelectItem value=\"qa\">\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            <span>‚ùì</span>\r\n                                            <span>Q&A</span>\r\n                                        </div>\r\n                                    </SelectItem>\r\n                                    <SelectItem value=\"announcement\">\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            <span>üì¢</span>\r\n                                            <span>Announcement</span>\r\n                                        </div>\r\n                                    </SelectItem>\r\n                                </SelectContent>\r\n                            </Select>\r\n                            <p className=\"text-xs text-muted-foreground\">\r\n                                {getTypeDescription(type)}\r\n                            </p>\r\n                        </div>\r\n\r\n                        {/* Description */}\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"description\">Description (Optional)</Label>\r\n                            <Textarea\r\n                                id=\"description\"\r\n                                placeholder=\"What is this channel for?\"\r\n                                value={description}\r\n                                onChange={(e) => setDescription(e.target.value)}\r\n                                disabled={isPending}\r\n                                rows={3}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <DialogFooter>\r\n                        <Button\r\n                            type=\"button\"\r\n                            variant=\"outline\"\r\n                            onClick={() => onOpenChange(false)}\r\n                            disabled={isPending}\r\n                        >\r\n                            Cancel\r\n                        </Button>\r\n                        <Button type=\"submit\" disabled={isPending || !name.trim()}>\r\n                            {isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\r\n                            Create Channel\r\n                        </Button>\r\n                    </DialogFooter>\r\n                </form>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n"
        ],
        "names": [],
        "mappings": "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"
      }
    },
    {
      "offset": {
        "line": 7565,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/hooks/admin/useAdminChannels.ts"
        ],
        "sourcesContent": [
          "import { createClient } from \"@/lib/supabase/client\";\r\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\r\nimport { toast } from \"sonner\";\r\nimport { CommunityChannel } from \"@/types/community\";\r\n\r\nexport const useUpdateChannel = () => {\r\n    const queryClient = useQueryClient();\r\n\r\n    return useMutation({\r\n        mutationFn: async ({ channelId, name, description, type }: { channelId: string; name: string; description?: string; type?: \"announcement\" | \"discussion\" | \"qa\" }) => {\r\n            const supabase = createClient();\r\n            const updates: any = { name };\r\n            if (description !== undefined) updates.description = description;\r\n            if (type !== undefined) updates.type = type;\r\n\r\n            const { data, error } = await supabase\r\n                .from(\"community_channels\")\r\n                .update(updates)\r\n                .eq(\"id\", channelId)\r\n                .select()\r\n                .single();\r\n\r\n            if (error) throw new Error(error.message);\r\n            return data;\r\n        },\r\n        onSuccess: () => {\r\n            toast.success(\"Channel updated successfully\");\r\n            queryClient.invalidateQueries({ queryKey: [\"admin\", \"courses-with-channels\"] });\r\n            queryClient.invalidateQueries({ queryKey: [\"channels\"] });\r\n        },\r\n        onError: (error: any) => {\r\n            toast.error(error.message || \"Failed to update channel\");\r\n        },\r\n    });\r\n};\r\n\r\nimport { AdminCourseWithChannels } from \"./useAdminCoursesWithChannels\";\r\n\r\nexport const useDeleteChannel = () => {\r\n    const queryClient = useQueryClient();\r\n\r\n    return useMutation({\r\n        mutationFn: async ({ channelId, courseId }: { channelId: string; courseId: string }) => {\r\n            const supabase = createClient();\r\n            console.log(\"Creating supabase client for delete...\");\r\n\r\n            // 1. Fetch all message IDs to clean up dependent tables\r\n            console.log(\"Fetching message IDs for channel:\", channelId);\r\n            const { data: messages, error: fetchError } = await supabase\r\n                .from(\"community_messages\")\r\n                .select(\"id\")\r\n                .eq(\"channel_id\", channelId);\r\n\r\n            if (fetchError) {\r\n                console.error(\"Error fetching messages:\", fetchError);\r\n            }\r\n\r\n            const messageIds = messages?.map(m => m.id) || [];\r\n            console.log(`Found ${messageIds.length} messages to clean up.`);\r\n\r\n            if (messageIds.length > 0) {\r\n                // 2. Delete Reactions\r\n                console.log(\"Deleting reactions...\");\r\n                const { error: reactionError } = await supabase\r\n                    .from(\"community_reactions\")\r\n                    .delete()\r\n                    .in(\"message_id\", messageIds);\r\n                if (reactionError) console.error(\"Error deleting reactions:\", reactionError);\r\n\r\n                // 3. Delete Bookmarks\r\n                console.log(\"Deleting bookmarks...\");\r\n                const { error: bookmarkError } = await supabase\r\n                    .from(\"community_bookmarks\")\r\n                    .delete()\r\n                    .in(\"message_id\", messageIds);\r\n                if (bookmarkError) console.error(\"Error deleting bookmarks:\", bookmarkError);\r\n            }\r\n\r\n            // 4. Delete Messages (Manual Cascade)\r\n            console.log(\"Deleting messages for channel:\", channelId);\r\n            const { error: msgError } = await supabase\r\n                .from(\"community_messages\")\r\n                .delete()\r\n                .eq(\"channel_id\", channelId);\r\n\r\n            if (msgError) {\r\n                console.error(\"Error deleting messages:\", msgError);\r\n            }\r\n\r\n            // 5. Delete Channel\r\n            console.log(\"Deleting channel:\", channelId);\r\n            const { error } = await supabase\r\n                .from(\"community_channels\")\r\n                .delete()\r\n                .eq(\"id\", channelId);\r\n\r\n            if (error) {\r\n                console.error(\"Error deleting channel:\", error);\r\n                throw new Error(error.message);\r\n            }\r\n\r\n            console.log(\"Channel deleted successfully\");\r\n            return { channelId, courseId };\r\n        },\r\n        onMutate: async ({ channelId, courseId }) => {\r\n            console.log(\"Optimistic update start\");\r\n            // Cancel any outgoing refetches\r\n            await queryClient.cancelQueries({ queryKey: [\"admin\", \"courses-with-channels\"] });\r\n\r\n            // Snapshot the previous value\r\n            const previousCourses = queryClient.getQueryData<AdminCourseWithChannels[]>([\"admin\", \"courses-with-channels\"]);\r\n\r\n            // Optimistically update to the new value\r\n            if (previousCourses) {\r\n                queryClient.setQueryData<AdminCourseWithChannels[]>([\"admin\", \"courses-with-channels\"], (old) => {\r\n                    if (!old) return [];\r\n                    return old.map(course => {\r\n                        if (course.id === courseId) {\r\n                            return {\r\n                                ...course,\r\n                                channels: course.channels.filter(ch => ch.id !== channelId)\r\n                            };\r\n                        }\r\n                        return course;\r\n                    });\r\n                });\r\n            }\r\n\r\n            // Return a context object with the snapshotted value\r\n            return { previousCourses };\r\n        },\r\n        onError: (err, newTodo, context: any) => {\r\n            if (context?.previousCourses) {\r\n                queryClient.setQueryData([\"admin\", \"courses-with-channels\"], context.previousCourses);\r\n            }\r\n            toast.error(err.message || \"Failed to delete channel\");\r\n        },\r\n        onSettled: () => {\r\n            queryClient.invalidateQueries({ queryKey: [\"admin\", \"courses-with-channels\"] });\r\n            queryClient.invalidateQueries({ queryKey: [\"channels\"] });\r\n        },\r\n        onSuccess: () => {\r\n            toast.success(\"Channel deleted\");\r\n        },\r\n    });\r\n};\r\n"
        ],
        "names": [],
        "mappings": "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"
      }
    },
    {
      "offset": {
        "line": 7764,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/admin/EditChannelDialog.tsx"
        ],
        "sourcesContent": [
          "\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogHeader,\r\n    DialogTitle,\r\n} from \"@/components/ui/dialog\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { useUpdateChannel } from \"@/hooks/admin/useAdminChannels\";\r\nimport { CommunityChannel } from \"@/types/community\";\r\nimport { Loader2 } from \"lucide-react\";\r\n\r\ninterface EditChannelDialogProps {\r\n    open: boolean;\r\n    onOpenChange: (open: boolean) => void;\r\n    channel: CommunityChannel | null;\r\n}\r\n\r\nexport function EditChannelDialog({\r\n    open,\r\n    onOpenChange,\r\n    channel,\r\n}: EditChannelDialogProps) {\r\n    const [name, setName] = useState(\"\");\r\n    const { mutate: updateChannel, isPending } = useUpdateChannel();\r\n\r\n    useEffect(() => {\r\n        if (channel) {\r\n            setName(channel.name);\r\n        }\r\n    }, [channel]);\r\n\r\n    const handleSubmit = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!channel || !name.trim()) return;\r\n\r\n        updateChannel(\r\n            { channelId: channel.id, name: name.trim() },\r\n            {\r\n                onSuccess: () => {\r\n                    onOpenChange(false);\r\n                },\r\n            }\r\n        );\r\n    };\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={onOpenChange}>\r\n            <DialogContent className=\"sm:max-w-[425px]\">\r\n                <DialogHeader>\r\n                    <DialogTitle>Edit Channel</DialogTitle>\r\n                    <DialogDescription>\r\n                        Update the channel name.\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n                <form onSubmit={handleSubmit}>\r\n                    <div className=\"grid gap-4 py-4\">\r\n                        <div className=\"grid gap-2\">\r\n                            <Label htmlFor=\"name\">Channel Name</Label>\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <span className=\"text-slate-500 font-bold\">#</span>\r\n                                <Input\r\n                                    id=\"name\"\r\n                                    value={name}\r\n                                    onChange={(e) => setName(e.target.value)}\r\n                                    placeholder=\"e.g. announcements\"\r\n                                    className=\"flex-1\"\r\n                                    disabled={isPending}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <DialogFooter>\r\n                        <Button\r\n                            type=\"button\"\r\n                            variant=\"outline\"\r\n                            onClick={() => onOpenChange(false)}\r\n                            disabled={isPending}\r\n                        >\r\n                            Cancel\r\n                        </Button>\r\n                        <Button type=\"submit\" disabled={isPending || !name.trim()}>\r\n                            {isPending && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\r\n                            Save Changes\r\n                        </Button>\r\n                    </DialogFooter>\r\n                </form>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;;AAEA;AACA;AACA;AAQA;AACA;AACA;AAEA;;;AAhBA;;;;;;;;AAwBO,SAAS,kBAAkB,EAC9B,IAAI,EACJ,YAAY,EACZ,OAAO,EACc;;IACrB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAC;IACjC,MAAM,EAAE,QAAQ,aAAa,EAAE,SAAS,EAAE,GAAG,IAAA,yJAAgB;IAE7D,IAAA,0KAAS;uCAAC;YACN,IAAI,SAAS;gBACT,QAAQ,QAAQ,IAAI;YACxB;QACJ;sCAAG;QAAC;KAAQ;IAEZ,MAAM,eAAe,CAAC;QAClB,EAAE,cAAc;QAChB,IAAI,CAAC,WAAW,CAAC,KAAK,IAAI,IAAI;QAE9B,cACI;YAAE,WAAW,QAAQ,EAAE;YAAE,MAAM,KAAK,IAAI;QAAG,GAC3C;YACI,WAAW;gBACP,aAAa;YACjB;QACJ;IAER;IAEA,qBACI,6LAAC,wIAAM;QAAC,MAAM;QAAM,cAAc;kBAC9B,cAAA,6LAAC,+IAAa;YAAC,WAAU;;8BACrB,6LAAC,8IAAY;;sCACT,6LAAC,6IAAW;sCAAC;;;;;;sCACb,6LAAC,mJAAiB;sCAAC;;;;;;;;;;;;8BAIvB,6LAAC;oBAAK,UAAU;;sCACZ,6LAAC;4BAAI,WAAU;sCACX,cAAA,6LAAC;gCAAI,WAAU;;kDACX,6LAAC,sIAAK;wCAAC,SAAQ;kDAAO;;;;;;kDACtB,6LAAC;wCAAI,WAAU;;0DACX,6LAAC;gDAAK,WAAU;0DAA2B;;;;;;0DAC3C,6LAAC,sIAAK;gDACF,IAAG;gDACH,OAAO;gDACP,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;gDACvC,aAAY;gDACZ,WAAU;gDACV,UAAU;;;;;;;;;;;;;;;;;;;;;;;sCAK1B,6LAAC,8IAAY;;8CACT,6LAAC,wIAAM;oCACH,MAAK;oCACL,SAAQ;oCACR,SAAS,IAAM,aAAa;oCAC5B,UAAU;8CACb;;;;;;8CAGD,6LAAC,wIAAM;oCAAC,MAAK;oCAAS,UAAU,aAAa,CAAC,KAAK,IAAI;;wCAClD,2BAAa,6LAAC,+NAAO;4CAAC,WAAU;;;;;;wCAA+B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQ5F;GAxEgB;;QAMiC,yJAAgB;;;KANjD"
      }
    },
    {
      "offset": {
        "line": 7965,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/ui/alert-dialog.tsx"
        ],
        "sourcesContent": [
          "'use client'\r\n\r\nimport * as React from 'react'\r\nimport * as AlertDialogPrimitive from '@radix-ui/react-alert-dialog'\r\n\r\nimport { cn } from '@/lib/utils'\r\nimport { buttonVariants } from '@/components/ui/button'\r\n\r\nfunction AlertDialog({\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Root>) {\r\n  return <AlertDialogPrimitive.Root data-slot=\"alert-dialog\" {...props} />\r\n}\r\n\r\nfunction AlertDialogTrigger({\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Trigger>) {\r\n  return (\r\n    <AlertDialogPrimitive.Trigger data-slot=\"alert-dialog-trigger\" {...props} />\r\n  )\r\n}\r\n\r\nfunction AlertDialogPortal({\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Portal>) {\r\n  return (\r\n    <AlertDialogPrimitive.Portal data-slot=\"alert-dialog-portal\" {...props} />\r\n  )\r\n}\r\n\r\nfunction AlertDialogOverlay({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Overlay>) {\r\n  return (\r\n    <AlertDialogPrimitive.Overlay\r\n      data-slot=\"alert-dialog-overlay\"\r\n      className={cn(\r\n        'data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AlertDialogContent({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Content>) {\r\n  return (\r\n    <AlertDialogPortal>\r\n      <AlertDialogOverlay />\r\n      <AlertDialogPrimitive.Content\r\n        data-slot=\"alert-dialog-content\"\r\n        className={cn(\r\n          'bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg',\r\n          className,\r\n        )}\r\n        {...props}\r\n      />\r\n    </AlertDialogPortal>\r\n  )\r\n}\r\n\r\nfunction AlertDialogHeader({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"alert-dialog-header\"\r\n      className={cn('flex flex-col gap-2 text-center sm:text-left', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AlertDialogFooter({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"alert-dialog-footer\"\r\n      className={cn(\r\n        'flex flex-col-reverse gap-2 sm:flex-row sm:justify-end',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AlertDialogTitle({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Title>) {\r\n  return (\r\n    <AlertDialogPrimitive.Title\r\n      data-slot=\"alert-dialog-title\"\r\n      className={cn('text-lg font-semibold', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AlertDialogDescription({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Description>) {\r\n  return (\r\n    <AlertDialogPrimitive.Description\r\n      data-slot=\"alert-dialog-description\"\r\n      className={cn('text-muted-foreground text-sm', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AlertDialogAction({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Action>) {\r\n  return (\r\n    <AlertDialogPrimitive.Action\r\n      className={cn(buttonVariants(), className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AlertDialogCancel({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Cancel>) {\r\n  return (\r\n    <AlertDialogPrimitive.Cancel\r\n      className={cn(buttonVariants({ variant: 'outline' }), className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {\r\n  AlertDialog,\r\n  AlertDialogPortal,\r\n  AlertDialogOverlay,\r\n  AlertDialogTrigger,\r\n  AlertDialogContent,\r\n  AlertDialogHeader,\r\n  AlertDialogFooter,\r\n  AlertDialogTitle,\r\n  AlertDialogDescription,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;AAGA;AAEA;AACA;AANA;;;;;AAQA,SAAS,YAAY,EACnB,GAAG,OACoD;IACvD,qBAAO,6LAAC,sLAAyB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AACtE;KAJS;AAMT,SAAS,mBAAmB,EAC1B,GAAG,OACuD;IAC1D,qBACE,6LAAC,yLAA4B;QAAC,aAAU;QAAwB,GAAG,KAAK;;;;;;AAE5E;MANS;AAQT,SAAS,kBAAkB,EACzB,GAAG,OACsD;IACzD,qBACE,6LAAC,wLAA2B;QAAC,aAAU;QAAuB,GAAG,KAAK;;;;;;AAE1E;MANS;AAQT,SAAS,mBAAmB,EAC1B,SAAS,EACT,GAAG,OACuD;IAC1D,qBACE,6LAAC,yLAA4B;QAC3B,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,0JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,mBAAmB,EAC1B,SAAS,EACT,GAAG,OACuD;IAC1D,qBACE,6LAAC;;0BACC,6LAAC;;;;;0BACD,6LAAC,yLAA4B;gBAC3B,aAAU;gBACV,WAAW,IAAA,qHAAE,EACX,+WACA;gBAED,GAAG,KAAK;;;;;;;;;;;;AAIjB;MAjBS;AAmBT,SAAS,kBAAkB,EACzB,SAAS,EACT,GAAG,OACyB;IAC5B,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,gDAAgD;QAC7D,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,kBAAkB,EACzB,SAAS,EACT,GAAG,OACyB;IAC5B,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,0DACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,iBAAiB,EACxB,SAAS,EACT,GAAG,OACqD;IACxD,qBACE,6LAAC,uLAA0B;QACzB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,yBAAyB;QACtC,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,uBAAuB,EAC9B,SAAS,EACT,GAAG,OAC2D;IAC9D,qBACE,6LAAC,6LAAgC;QAC/B,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,kBAAkB,EACzB,SAAS,EACT,GAAG,OACsD;IACzD,qBACE,6LAAC,wLAA2B;QAC1B,WAAW,IAAA,qHAAE,EAAC,IAAA,gJAAc,KAAI;QAC/B,GAAG,KAAK;;;;;;AAGf;MAVS;AAYT,SAAS,kBAAkB,EACzB,SAAS,EACT,GAAG,OACsD;IACzD,qBACE,6LAAC,wLAA2B;QAC1B,WAAW,IAAA,qHAAE,EAAC,IAAA,gJAAc,EAAC;YAAE,SAAS;QAAU,IAAI;QACrD,GAAG,KAAK;;;;;;AAGf;OAVS"
      }
    },
    {
      "offset": {
        "line": 8160,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/community/CommunitySettingsView.tsx"
        ],
        "sourcesContent": [
          "\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { Plus, MessageSquare, Edit, Trash, Loader2 } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { useToggleCommunity } from \"@/hooks/admin/useToggleCommunity\";\r\nimport { Switch } from \"@/components/ui/switch\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { toast } from \"sonner\";\r\nimport { AddChannelDialog } from \"@/components/admin/AddChannelDialog\";\r\nimport { EditChannelDialog } from \"@/components/admin/EditChannelDialog\";\r\nimport { CommunityChannel } from \"@/types/community\";\r\nimport { useDeleteChannel } from \"@/hooks/admin/useAdminChannels\";\r\nimport {\r\n    AlertDialog,\r\n    AlertDialogAction,\r\n    AlertDialogCancel,\r\n    AlertDialogContent,\r\n    AlertDialogDescription,\r\n    AlertDialogFooter,\r\n    AlertDialogHeader,\r\n    AlertDialogTitle,\r\n} from \"@/components/ui/alert-dialog\";\r\n\r\ninterface CommunitySettingsViewProps {\r\n    courseId: string;\r\n    courseTitle: string;\r\n    communityEnabled: boolean;\r\n    channels: CommunityChannel[];\r\n    onBack: () => void;\r\n}\r\n\r\nexport function CommunitySettingsView({\r\n    courseId,\r\n    courseTitle,\r\n    communityEnabled: initialEnabled,\r\n    channels,\r\n    onBack\r\n}: CommunitySettingsViewProps) {\r\n    const [enabled, setEnabled] = useState(initialEnabled);\r\n    const [isAddDialogOpen, setIsAddDialogOpen] = useState(false);\r\n    const [isEditDialogOpen, setIsEditDialogOpen] = useState(false);\r\n    const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);\r\n    const [selectedChannel, setSelectedChannel] = useState<CommunityChannel | null>(null);\r\n\r\n    const { mutate: toggleCommunity, isPending: isTogglePending } = useToggleCommunity();\r\n    const { mutate: deleteChannel, isPending: isDeletePending } = useDeleteChannel();\r\n\r\n    const handleToggle = (checked: boolean) => {\r\n        toggleCommunity(\r\n            { courseId, enabled: checked },\r\n            {\r\n                onSuccess: () => {\r\n                    setEnabled(checked);\r\n                    if (checked) {\r\n                        toast.success(\"Community enabled! Default channels have been created.\");\r\n                    } else {\r\n                        toast.success(\"Community disabled\");\r\n                    }\r\n                },\r\n                onError: () => {\r\n                    toast.error(\"Failed to toggle community\");\r\n                }\r\n            }\r\n        );\r\n    };\r\n\r\n    const confirmDelete = (channel: CommunityChannel) => {\r\n        setSelectedChannel(channel);\r\n        setIsDeleteDialogOpen(true);\r\n    };\r\n\r\n    const handleDelete = () => {\r\n        if (!selectedChannel) return;\r\n        deleteChannel({ channelId: selectedChannel.id, courseId }, {\r\n            onSuccess: () => {\r\n                setIsDeleteDialogOpen(false);\r\n                setSelectedChannel(null);\r\n            }\r\n        });\r\n    };\r\n\r\n    const openEdit = (channel: CommunityChannel) => {\r\n        setSelectedChannel(channel);\r\n        setIsEditDialogOpen(true);\r\n    };\r\n\r\n    const getChannelIcon = (type: string) => {\r\n        switch (type) {\r\n            case 'announcement':\r\n                return 'üì¢';\r\n            case 'qa':\r\n                return '‚ùì';\r\n            default:\r\n                return 'üí¨';\r\n        }\r\n    };\r\n\r\n    const getChannelColor = (type: string) => {\r\n        switch (type) {\r\n            case 'announcement':\r\n                return 'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400';\r\n            case 'qa':\r\n                return 'bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400';\r\n            default:\r\n                return 'bg-emerald-100 text-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-400';\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex-1 overflow-y-auto bg-slate-50 dark:bg-slate-900/50\">\r\n            <div className=\"max-w-3xl mx-auto p-6 space-y-6\">\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold text-slate-900 dark:text-slate-100\">\r\n                        Community Settings\r\n                    </h2>\r\n                    <p className=\"text-slate-600 dark:text-slate-400 mt-1\">\r\n                        Manage community settings for {courseTitle}\r\n                    </p>\r\n                </div>\r\n\r\n                {/* Enable/Disable Community */}\r\n                <Card>\r\n                    <CardHeader>\r\n                        <CardTitle className=\"flex items-center gap-2\">\r\n                            <MessageSquare className=\"w-5 h-5\" />\r\n                            Community Status\r\n                        </CardTitle>\r\n                        <CardDescription>\r\n                            Enable or disable community features for this course\r\n                        </CardDescription>\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <div className=\"space-y-0.5\">\r\n                                <Label htmlFor=\"community-toggle\" className=\"text-base\">\r\n                                    Community Features\r\n                                </Label>\r\n                                <p className=\"text-sm text-muted-foreground\">\r\n                                    Allow students to discuss and ask questions\r\n                                </p>\r\n                            </div>\r\n                            <Switch\r\n                                id=\"community-toggle\"\r\n                                checked={enabled}\r\n                                onCheckedChange={handleToggle}\r\n                                disabled={isTogglePending}\r\n                            />\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n\r\n                {/* Channels List */}\r\n                {enabled && (\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <div className=\"flex items-center justify-between\">\r\n                                <div>\r\n                                    <CardTitle>Channels</CardTitle>\r\n                                    <CardDescription>\r\n                                        Manage discussion channels for your course\r\n                                    </CardDescription>\r\n                                </div>\r\n                                <Button size=\"sm\" onClick={() => setIsAddDialogOpen(true)}>\r\n                                    <Plus className=\"h-4 w-4 mr-2\" />\r\n                                    Add Channel\r\n                                </Button>\r\n                            </div>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            <div className=\"space-y-3\">\r\n                                {channels.map((channel) => (\r\n                                    <div\r\n                                        key={channel.id}\r\n                                        className=\"flex items-center justify-between p-4 border border-slate-200 dark:border-slate-800 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-900/50 transition-colors\"\r\n                                    >\r\n                                        <div className=\"flex items-center gap-3\">\r\n                                            <span className=\"text-2xl\">{getChannelIcon(channel.type)}</span>\r\n                                            <div>\r\n                                                <div className=\"flex items-center gap-2\">\r\n                                                    <h4 className=\"font-semibold text-slate-900 dark:text-slate-100\">\r\n                                                        #{channel.name}\r\n                                                    </h4>\r\n                                                    <Badge className={getChannelColor(channel.type)}>\r\n                                                        {channel.type}\r\n                                                    </Badge>\r\n                                                </div>\r\n                                                <p className=\"text-sm text-slate-600 dark:text-slate-400\">\r\n                                                    {channel.description || \"No description\"}\r\n                                                </p>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            <Button\r\n                                                variant=\"ghost\"\r\n                                                size=\"sm\"\r\n                                                onClick={() => openEdit(channel)}\r\n                                            >\r\n                                                <Edit className=\"h-4 w-4\" />\r\n                                            </Button>\r\n                                            <Button\r\n                                                variant=\"ghost\"\r\n                                                size=\"sm\"\r\n                                                className=\"text-red-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20\"\r\n                                                onClick={() => confirmDelete(channel)}\r\n                                            >\r\n                                                <Trash className=\"h-4 w-4\" />\r\n                                            </Button>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </CardContent>\r\n                    </Card>\r\n                )}\r\n\r\n                {/* Info Card */}\r\n                <Card className=\"border-blue-200 dark:border-blue-900 bg-blue-50/50 dark:bg-blue-900/10\">\r\n                    <CardContent className=\"pt-6\">\r\n                        <div className=\"flex gap-3\">\r\n                            <div className=\"shrink-0\">\r\n                                <div className=\"w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center\">\r\n                                    <MessageSquare className=\"w-5 h-5 text-blue-600 dark:text-blue-400\" />\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"space-y-1\">\r\n                                <h4 className=\"font-semibold text-blue-900 dark:text-blue-100\">\r\n                                    About Community Features\r\n                                </h4>\r\n                                <p className=\"text-sm text-blue-800 dark:text-blue-200\">\r\n                                    When enabled, students can participate in discussions, ask questions, and interact with each other.\r\n                                    As an instructor, you can post announcements and moderate conversations.\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n\r\n                {/* Dialogs */}\r\n                <AddChannelDialog\r\n                    open={isAddDialogOpen}\r\n                    onOpenChange={setIsAddDialogOpen}\r\n                    courseId={courseId}\r\n                />\r\n\r\n                <EditChannelDialog\r\n                    open={isEditDialogOpen}\r\n                    onOpenChange={setIsEditDialogOpen}\r\n                    channel={selectedChannel}\r\n                />\r\n\r\n                <AlertDialog open={isDeleteDialogOpen} onOpenChange={setIsDeleteDialogOpen}>\r\n                    <AlertDialogContent>\r\n                        <AlertDialogHeader>\r\n                            <AlertDialogTitle>Delete Channel?</AlertDialogTitle>\r\n                            <AlertDialogDescription>\r\n                                Are you sure you want to delete <span className=\"font-bold\">#{selectedChannel?.name}</span>?\r\n                                This action cannot be undone and all messages in this channel will be permanently deleted.\r\n                            </AlertDialogDescription>\r\n                        </AlertDialogHeader>\r\n                        <AlertDialogFooter>\r\n                            <AlertDialogCancel disabled={isDeletePending}>Cancel</AlertDialogCancel>\r\n                            <AlertDialogAction\r\n                                onClick={(e) => {\r\n                                    e.preventDefault();\r\n                                    handleDelete();\r\n                                }}\r\n                                className=\"bg-red-600 hover:bg-red-700\"\r\n                                disabled={isDeletePending}\r\n                            >\r\n                                {isDeletePending ? (\r\n                                    <>\r\n                                        <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                        Deleting...\r\n                                    </>\r\n                                ) : (\r\n                                    \"Delete\"\r\n                                )}\r\n                            </AlertDialogAction>\r\n                        </AlertDialogFooter>\r\n                    </AlertDialogContent>\r\n                </AlertDialog>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"
        ],
        "names": [],
        "mappings": "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"
      }
    },
    {
      "offset": {
        "line": 8783,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/community/CommunityModal.tsx"
        ],
        "sourcesContent": [
          "\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { ChannelSidebar, MessageList, MessageInput } from \"@/components/community\";\r\nimport { useEnrolledCourses } from \"@/hooks/community/useEnrolledCourses\";\r\nimport { useAdminCoursesWithChannels } from \"@/hooks/admin/useAdminCoursesWithChannels\";\r\nimport { useMentions, useBookmarkedMessages } from \"@/hooks/community\";\r\nimport { MessageCard } from \"@/components/community/MessageCard\";\r\nimport { CommunitySettingsView } from \"@/components/community/CommunitySettingsView\";\r\nimport { Loader2, Menu, X, AtSign, Bookmark, Settings } from \"lucide-react\";\r\nimport { useUser } from \"@/hooks/useUser\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { useCommunityModal } from \"@/context/CommunityModalContext\";\r\n\r\ntype ViewType = 'channels' | 'mentions' | 'bookmarks' | 'settings';\r\n\r\nexport function CommunityModal() {\r\n    const { isOpen, closeCommunity, options } = useCommunityModal();\r\n    const { user, profile, loading: userLoading } = useUser();\r\n\r\n    const isAdmin = options?.isAdmin || false;\r\n\r\n    // Data fetching\r\n    const { data: studentCourses, isLoading: studentLoading } = useEnrolledCourses(user?.id);\r\n    const { data: adminCourses, isLoading: adminLoading } = useAdminCoursesWithChannels(user?.id);\r\n\r\n    const enrolledCourses = isAdmin ? adminCourses : studentCourses;\r\n    const coursesLoading = isAdmin ? adminLoading : studentLoading;\r\n\r\n    const { data: mentions = [], isLoading: mentionsLoading } = useMentions();\r\n    const { data: bookmarks = [], isLoading: bookmarksLoading } = useBookmarkedMessages();\r\n\r\n    const [activeView, setActiveView] = useState<ViewType>('channels');\r\n    const [activeChannelId, setActiveChannelId] = useState<string | null>(null);\r\n    const [selectedCourseId, setSelectedCourseId] = useState<string | null>(null);\r\n    const [isSidebarOpen, setIsSidebarOpen] = useState(false);\r\n\r\n    // Get all channels from all enrolled courses\r\n    const allChannels = enrolledCourses?.flatMap(course => course.channels || []) || [];\r\n    // Only show active channels in the sidebar\r\n    const visibleChannels = allChannels.filter(c => c.is_active);\r\n\r\n    const activeChannel = allChannels.find(c => c.id === activeChannelId);\r\n\r\n    // Get the course for the active channel or use the selected course\r\n    const activeCourse = enrolledCourses?.find(course =>\r\n        course.id === selectedCourseId || course.channels?.some(ch => ch.id === activeChannelId)\r\n    );\r\n\r\n    const canPost = activeChannel && (\r\n        profile?.role === 'admin' ||\r\n        profile?.role === 'instructor' ||\r\n        profile?.role === 'creator' ||\r\n        (activeChannel.type !== 'announcement')\r\n    );\r\n\r\n    // Initial setup when opening\r\n    // Initial setup when opening\r\n    useEffect(() => {\r\n        if (isOpen) {\r\n            // Priority: Options -> Existing Selected -> First Available\r\n            let targetCourseId = options?.courseId || selectedCourseId || enrolledCourses?.[0]?.id;\r\n\r\n            if (targetCourseId) {\r\n                setSelectedCourseId(targetCourseId);\r\n\r\n                // If the selected course has active channels, select the default one\r\n                // UNLESS we are simply navigating back to a course we were already on? \r\n                // Actually, if activeChannelId is already set and belongs to this course, keep it.\r\n                // Otherwise, find default.\r\n\r\n                const courseChannels = visibleChannels.filter(c => c.course_id === targetCourseId);\r\n                const currentChannelValid = activeChannelId && courseChannels.some(c => c.id === activeChannelId);\r\n\r\n                if (!currentChannelValid && courseChannels.length > 0) {\r\n                    const defaultChannel =\r\n                        courseChannels.find(c => c.type === 'announcement') ||\r\n                        courseChannels.find(c => c.type === 'discussion') ||\r\n                        courseChannels[0];\r\n                    setActiveChannelId(defaultChannel.id);\r\n                    setActiveView('channels');\r\n                } else if (!currentChannelValid) {\r\n                    // No channels for this course\r\n                    setActiveChannelId(null);\r\n                    setActiveView('channels');\r\n                }\r\n            }\r\n        }\r\n    }, [isOpen, options, visibleChannels, enrolledCourses]);\r\n\r\n    // Handle course selection from sidebar\r\n    const handleCourseSelect = (courseId: string) => {\r\n        setSelectedCourseId(courseId);\r\n        // Find default channel for this course\r\n        const courseChannels = visibleChannels.filter(c => c.course_id === courseId);\r\n        if (courseChannels.length > 0) {\r\n            const defaultChannel =\r\n                courseChannels.find(c => c.type === 'announcement') ||\r\n                courseChannels.find(c => c.type === 'discussion') ||\r\n                courseChannels[0];\r\n            setActiveChannelId(defaultChannel.id);\r\n        } else {\r\n            setActiveChannelId(null);\r\n        }\r\n        setActiveView('channels');\r\n    };\r\n\r\n    // Close sidebar when channel is selected on mobile\r\n    const handleChannelSelect = (channelId: string) => {\r\n        setActiveChannelId(channelId);\r\n        // Also ensure course is selected\r\n        const channel = visibleChannels.find(c => c.id === channelId);\r\n        if (channel) {\r\n            setSelectedCourseId(channel.course_id);\r\n        }\r\n        setActiveView('channels');\r\n        setIsSidebarOpen(false);\r\n    };\r\n\r\n    const handleViewChange = (view: ViewType) => {\r\n        setActiveView(view);\r\n        setIsSidebarOpen(false);\r\n    };\r\n\r\n    if (!isOpen) return null;\r\n\r\n    if (userLoading || coursesLoading) {\r\n        return (\r\n            <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm\">\r\n                <div className=\"text-center space-y-4\">\r\n                    <Loader2 className=\"w-12 h-12 animate-spin text-white mx-auto\" />\r\n                    <p className=\"text-white font-medium\">Loading community...</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (!enrolledCourses || enrolledCourses.length === 0) {\r\n        return (\r\n            <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm\">\r\n                <div className=\"bg-white dark:bg-slate-900 rounded-2xl p-8 max-w-md mx-4 shadow-2xl relative\">\r\n                    <Button\r\n                        variant=\"ghost\"\r\n                        size=\"icon\"\r\n                        className=\"absolute top-2 right-2 hover:bg-slate-100 dark:hover:bg-slate-800\"\r\n                        onClick={closeCommunity}\r\n                    >\r\n                        <X className=\"h-4 w-4\" />\r\n                    </Button>\r\n                    <div className=\"text-center space-y-4\">\r\n                        <div className=\"w-24 h-24 rounded-full bg-linear-to-br from-emerald-100 to-emerald-50 dark:from-emerald-900/30 dark:to-emerald-900/10 flex items-center justify-center mx-auto\">\r\n                            <span className=\"text-5xl\">üìö</span>\r\n                        </div>\r\n                        <h2 className=\"text-2xl font-bold\">No Community Channels</h2>\r\n                        <p className=\"text-muted-foreground\">\r\n                            No community channels are available yet.\r\n                        </p>\r\n                        <Button onClick={closeCommunity} className=\"w-full\">\r\n                            Close\r\n                        </Button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Render different views\r\n    const renderContent = () => {\r\n        if (activeView === 'settings' && activeCourse && isAdmin) {\r\n            return (\r\n                <div className=\"flex-1 flex flex-col min-w-0 bg-white dark:bg-slate-900\">\r\n                    <div className=\"h-16 border-b border-slate-200/80 dark:border-slate-800/80 flex items-center px-6 justify-between bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl shadow-sm\">\r\n                        <div className=\"flex items-center gap-4\">\r\n                            <Button variant=\"ghost\" size=\"icon\" className=\"md:hidden\" onClick={() => setIsSidebarOpen(true)}>\r\n                                <Menu className=\"h-5 w-5\" />\r\n                            </Button>\r\n                            <h3 className=\"font-bold text-lg\">Settings</h3>\r\n                        </div>\r\n                    </div>\r\n                    {/* Settings View gets all channels (including inactive) */}\r\n                    <CommunitySettingsView\r\n                        courseId={activeCourse.id}\r\n                        courseTitle={activeCourse.title}\r\n                        communityEnabled={activeCourse.community_enabled}\r\n                        channels={activeCourse.channels || []}\r\n                        onBack={() => setActiveView('channels')}\r\n                    />\r\n                </div>\r\n            );\r\n        }\r\n\r\n        if (activeView === 'mentions') {\r\n            return (\r\n                <div className=\"flex-1 flex flex-col overflow-hidden\">\r\n                    <div className=\"h-16 border-b border-slate-200/80 dark:border-slate-800/80 flex items-center px-6 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl shadow-sm\">\r\n                        <Button variant=\"ghost\" size=\"icon\" className=\"md:hidden mr-4\" onClick={() => setIsSidebarOpen(true)}>\r\n                            <Menu className=\"h-5 w-5\" />\r\n                        </Button>\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <div className=\"w-10 h-10 rounded-xl bg-linear-to-br from-blue-500 to-blue-600 flex items-center justify-center shadow-lg\">\r\n                                <AtSign className=\"w-5 h-5 text-white\" />\r\n                            </div>\r\n                            <div>\r\n                                <h3 className=\"font-bold text-lg\">Mentions</h3>\r\n                                {mentions.length > 0 && (\r\n                                    <p className=\"text-xs text-muted-foreground\">{mentions.length} {mentions.length === 1 ? 'mention' : 'mentions'}</p>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex-1 overflow-y-auto\">\r\n                        {mentionsLoading ? (\r\n                            <div className=\"flex items-center justify-center h-full\">\r\n                                <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\r\n                            </div>\r\n                        ) : mentions.length === 0 ? (\r\n                            <div className=\"flex flex-col items-center justify-center h-full text-center p-8\">\r\n                                <div className=\"w-24 h-24 rounded-full bg-linear-to-br from-blue-100 to-blue-50 dark:from-blue-900/30 dark:to-blue-900/10 flex items-center justify-center mb-4\">\r\n                                    <AtSign className=\"w-12 h-12 text-blue-500 dark:text-blue-400\" />\r\n                                </div>\r\n                                <h3 className=\"text-xl font-bold mb-2\">No Mentions Yet</h3>\r\n                                <p className=\"text-muted-foreground max-w-sm\">\r\n                                    When someone mentions you in a message, it will appear here.\r\n                                </p>\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"space-y-1\">\r\n                                {mentions.map((message: any) => (\r\n                                    <MessageCard\r\n                                        key={message.id}\r\n                                        message={message}\r\n                                        isOwnMessage={message.user_id === user?.id}\r\n                                        channelId={message.channel_id}\r\n                                    />\r\n                                ))}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        if (activeView === 'bookmarks') {\r\n            return (\r\n                <div className=\"flex-1 flex flex-col overflow-hidden\">\r\n                    <div className=\"h-16 border-b border-slate-200/80 dark:border-slate-800/80 flex items-center px-6 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl shadow-sm\">\r\n                        <Button variant=\"ghost\" size=\"icon\" className=\"md:hidden mr-4\" onClick={() => setIsSidebarOpen(true)}>\r\n                            <Menu className=\"h-5 w-5\" />\r\n                        </Button>\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <div className=\"w-10 h-10 rounded-xl bg-linear-to-br from-amber-500 to-amber-600 flex items-center justify-center shadow-lg\">\r\n                                <Bookmark className=\"w-5 h-5 text-white fill-white\" />\r\n                            </div>\r\n                            <div>\r\n                                <h3 className=\"font-bold text-lg\">Bookmarks</h3>\r\n                                {bookmarks.length > 0 && (\r\n                                    <p className=\"text-xs text-muted-foreground\">{bookmarks.length} {bookmarks.length === 1 ? 'bookmark' : 'bookmarks'}</p>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex-1 overflow-y-auto\">\r\n                        {bookmarksLoading ? (\r\n                            <div className=\"flex items-center justify-center h-full\">\r\n                                <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\r\n                            </div>\r\n                        ) : bookmarks.length === 0 ? (\r\n                            <div className=\"flex flex-col items-center justify-center h-full text-center p-8\">\r\n                                <div className=\"w-24 h-24 rounded-full bg-linear-to-br from-amber-100 to-amber-50 dark:from-amber-900/30 dark:to-amber-900/10 flex items-center justify-center mb-4\">\r\n                                    <Bookmark className=\"w-12 h-12 text-amber-500 dark:text-amber-400\" />\r\n                                </div>\r\n                                <h3 className=\"text-xl font-bold mb-2\">No Bookmarks Yet</h3>\r\n                                <p className=\"text-muted-foreground max-w-sm\">\r\n                                    Save important messages by clicking the bookmark icon.\r\n                                </p>\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"space-y-1\">\r\n                                {bookmarks.map((bookmark: any) => (\r\n                                    <MessageCard\r\n                                        key={bookmark.bookmarkId}\r\n                                        message={bookmark.message}\r\n                                        isOwnMessage={bookmark.message.user_id === user?.id}\r\n                                        channelId={bookmark.message.channel_id}\r\n                                    />\r\n                                ))}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className=\"flex-1 flex flex-col min-w-0 overflow-hidden\">\r\n                <div className=\"h-16 border-b border-slate-200/80 dark:border-slate-800/80 flex items-center px-6 justify-between bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl shadow-sm\">\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <Button variant=\"ghost\" size=\"icon\" className=\"md:hidden hover:bg-slate-100 dark:hover:bg-slate-800\" onClick={() => setIsSidebarOpen(true)}>\r\n                            <Menu className=\"h-5 w-5\" />\r\n                        </Button>\r\n\r\n                        <div className=\"h-6 w-px bg-slate-300 dark:bg-slate-700 hidden sm:block\" />\r\n\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <div className={cn(\r\n                                \"w-2 h-2 rounded-full\",\r\n                                activeChannel?.type === 'announcement' ? \"bg-blue-500\" :\r\n                                    activeChannel?.type === 'qa' ? \"bg-purple-500\" : \"bg-emerald-500\"\r\n                            )} />\r\n                            <div className=\"flex flex-col\">\r\n                                <h3 className=\"font-semibold text-slate-900 dark:text-slate-100\">\r\n                                    #{activeChannel?.name || 'Select a channel'}\r\n                                </h3>\r\n                                {activeCourse && (\r\n                                    <p className=\"text-xs text-slate-500 dark:text-slate-400\">\r\n                                        {activeCourse.title}\r\n                                    </p>\r\n                                )}\r\n                            </div>\r\n                            {activeChannel?.description && (\r\n                                <span className=\"text-sm text-slate-600 dark:text-slate-400 hidden lg:inline-block ml-2\">\r\n                                    ‚Äî {activeChannel.description}\r\n                                </span>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Admin Settings Button */}\r\n                    {isAdmin && activeCourse && (\r\n                        <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            className=\"gap-2 text-slate-500 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-100 mr-12\"\r\n                            onClick={() => setActiveView('settings')}\r\n                        >\r\n                            <Settings className=\"h-4 w-4\" />\r\n                            <span className=\"hidden sm:inline\">Settings</span>\r\n                        </Button>\r\n                    )}\r\n                </div>\r\n\r\n                {activeChannelId && (\r\n                    <>\r\n                        <MessageList channelId={activeChannelId} />\r\n                        {canPost ? (\r\n                            <MessageInput channelId={activeChannelId} />\r\n                        ) : (\r\n                            <div className=\"p-4 border-t border-slate-200 dark:border-slate-800 bg-amber-50/50 dark:bg-amber-900/10 text-center text-sm text-amber-800 dark:text-amber-200 backdrop-blur-sm\">\r\n                                <div className=\"flex items-center justify-center gap-2\">\r\n                                    <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                                        <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z\" clipRule=\"evenodd\" />\r\n                                    </svg>\r\n                                    <span>Only instructors can post in this announcement channel</span>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </>\r\n                )}\r\n            </div>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200\">\r\n            <div className=\"absolute inset-0 flex bg-linear-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 animate-in slide-in-from-bottom duration-300\">\r\n                <ChannelSidebar\r\n                    channels={visibleChannels}\r\n                    activeChannelId={activeChannelId}\r\n                    onSelectChannel={handleChannelSelect}\r\n                    courseId={selectedCourseId || enrolledCourses?.[0]?.id || ''}\r\n                    enrolledCourses={enrolledCourses || []}\r\n                    isOpen={isSidebarOpen}\r\n                    onClose={() => setIsSidebarOpen(false)}\r\n                    isAdmin={isAdmin}\r\n                    onViewChange={(view) => handleViewChange(view as ViewType)}\r\n                    onSelectCourse={handleCourseSelect}\r\n                />\r\n\r\n                {/* Close Button - Fixed Position */}\r\n                <Button\r\n                    variant=\"ghost\"\r\n                    size=\"icon\"\r\n                    className=\"fixed top-4 right-4 z-10 hover:bg-slate-100 dark:hover:bg-slate-800 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl shadow-lg\"\r\n                    onClick={closeCommunity}\r\n                >\r\n                    <X className=\"h-5 w-5\" />\r\n                </Button>\r\n\r\n                {renderContent()}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"
        ],
        "names": [],
        "mappings": "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"
      }
    },
    {
      "offset": {
        "line": 9687,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/app/admin/AdminClientLayout.tsx"
        ],
        "sourcesContent": [
          "\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\nimport { redirect } from \"next/navigation\";\r\nimport Sidebar from \"./components/layout/Sidebar\";\r\nimport Header from \"./components/layout/Header\";\r\nimport MobileNav from \"./components/layout/MobileNav\";\r\nimport { CommunityModalProvider } from \"@/context/CommunityModalContext\";\r\nimport { CommunityModal } from \"@/components/community/CommunityModal\";\r\n\r\nexport default function AdminClientLayout({\r\n  profile,\r\n  links,\r\n  children,\r\n}: {\r\n  profile: any;\r\n  links: any;\r\n  children: React.ReactNode;\r\n}) {\r\n  const [open, setOpen] = useState(true);\r\n  const [sidebarCollapsed, setSidebarCollapsed] = useState(false);\r\n  const [theme, setTheme] = useState(\"light\");\r\n\r\n\r\n\r\n  const chartData = [\r\n    { name: \"Mon\", users: 400, exams: 240 },\r\n    { name: \"Tue\", users: 300, exams: 139 },\r\n    { name: \"Wed\", users: 200, exams: 380 },\r\n    { name: \"Thu\", users: 278, exams: 390 },\r\n    { name: \"Fri\", users: 189, exams: 480 },\r\n    { name: \"Sat\", users: 239, exams: 380 },\r\n    { name: \"Sun\", users: 349, exams: 430 },\r\n  ];\r\n\r\n  useEffect(() => {\r\n    const saved = localStorage.getItem(\"m4c_theme\");\r\n    const prefersDark =\r\n      window.matchMedia &&\r\n      window.matchMedia(\"(prefers-color-scheme: dark)\").matches;\r\n    const initial = saved || (prefersDark ? \"dark\" : \"light\");\r\n    setTheme(initial);\r\n    applyTheme(initial);\r\n  }, []);\r\n\r\n  function applyTheme(t: string) {\r\n    const root = document.documentElement;\r\n    if (t === \"dark\") root.classList.add(\"dark\");\r\n    else root.classList.remove(\"dark\");\r\n  }\r\n\r\n  function toggleTheme() {\r\n    const next = theme === \"light\" ? \"dark\" : \"light\";\r\n    setTheme(next);\r\n    localStorage.setItem(\"m4c_theme\", next);\r\n    applyTheme(next);\r\n  }\r\n\r\n  const cardVariants = {\r\n    hidden: { opacity: 0, y: 20 },\r\n    visible: { opacity: 1, y: 0 },\r\n  };\r\n\r\n\r\n  const handleLogout = async () => {\r\n    const supabase = createClient();\r\n    await supabase.auth.signOut();\r\n    redirect(\"/auth/login\");\r\n  };\r\n\r\n  return (\r\n    <CommunityModalProvider>\r\n      <div className=\"min-h-screen bg-linear-to-br from-white via-sky-50 to-indigo-50 dark:from-slate-900 dark:via-slate-800 dark:to-black transition-colors duration-700\">\r\n        <Sidebar menuItems={links} sidebarCollapsed={sidebarCollapsed} setSidebarCollapsed={setSidebarCollapsed} profile={profile} />\r\n        {/* <Sidebar menuItems={links} /> */}\r\n        <Header theme={theme} toggleTheme={toggleTheme} sidebarCollapsed={sidebarCollapsed} profile={profile} setSidebarCollapsed={setSidebarCollapsed} />\r\n\r\n        <main\r\n          className={`flex-1 p-4 md:p-6 mt-16 pb-24 md:pb-8 transition-all duration-500 ${sidebarCollapsed ? \"md:ml-20\" : \"md:ml-64\"\r\n            }`}\r\n        >{children}\r\n        </main>\r\n\r\n        <MobileNav theme={theme} toggleTheme={toggleTheme} links={links} profile={profile} />\r\n      </div>\r\n      <CommunityModal />\r\n    </CommunityModalProvider>\r\n  );\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AATA;;;;;;;;;AAWe,SAAS,kBAAkB,EACxC,OAAO,EACP,KAAK,EACL,QAAQ,EAKT;;IACC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAC;IACjC,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAC;IACzD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IAInC,MAAM,YAAY;QAChB;YAAE,MAAM;YAAO,OAAO;YAAK,OAAO;QAAI;QACtC;YAAE,MAAM;YAAO,OAAO;YAAK,OAAO;QAAI;QACtC;YAAE,MAAM;YAAO,OAAO;YAAK,OAAO;QAAI;QACtC;YAAE,MAAM;YAAO,OAAO;YAAK,OAAO;QAAI;QACtC;YAAE,MAAM;YAAO,OAAO;YAAK,OAAO;QAAI;QACtC;YAAE,MAAM;YAAO,OAAO;YAAK,OAAO;QAAI;QACtC;YAAE,MAAM;YAAO,OAAO;YAAK,OAAO;QAAI;KACvC;IAED,IAAA,0KAAS;uCAAC;YACR,MAAM,QAAQ,aAAa,OAAO,CAAC;YACnC,MAAM,cACJ,OAAO,UAAU,IACjB,OAAO,UAAU,CAAC,gCAAgC,OAAO;YAC3D,MAAM,UAAU,SAAS,CAAC,cAAc,SAAS,OAAO;YACxD,SAAS;YACT,WAAW;QACb;sCAAG,EAAE;IAEL,SAAS,WAAW,CAAS;QAC3B,MAAM,OAAO,SAAS,eAAe;QACrC,IAAI,MAAM,QAAQ,KAAK,SAAS,CAAC,GAAG,CAAC;aAChC,KAAK,SAAS,CAAC,MAAM,CAAC;IAC7B;IAEA,SAAS;QACP,MAAM,OAAO,UAAU,UAAU,SAAS;QAC1C,SAAS;QACT,aAAa,OAAO,CAAC,aAAa;QAClC,WAAW;IACb;IAEA,MAAM,eAAe;QACnB,QAAQ;YAAE,SAAS;YAAG,GAAG;QAAG;QAC5B,SAAS;YAAE,SAAS;YAAG,GAAG;QAAE;IAC9B;IAGA,MAAM,eAAe;QACnB,MAAM,WAAW,IAAA,4IAAY;QAC7B,MAAM,SAAS,IAAI,CAAC,OAAO;QAC3B,IAAA,iJAAQ,EAAC;IACX;IAEA,qBACE,6LAAC,8JAAsB;;0BACrB,6LAAC;gBAAI,WAAU;;kCACb,6LAAC,8JAAO;wBAAC,WAAW;wBAAO,kBAAkB;wBAAkB,qBAAqB;wBAAqB,SAAS;;;;;;kCAElH,6LAAC,6JAAM;wBAAC,OAAO;wBAAO,aAAa;wBAAa,kBAAkB;wBAAkB,SAAS;wBAAS,qBAAqB;;;;;;kCAE3H,6LAAC;wBACC,WAAW,CAAC,kEAAkE,EAAE,mBAAmB,aAAa,YAC5G;kCACJ;;;;;;kCAGF,6LAAC,gKAAS;wBAAC,OAAO;wBAAO,aAAa;wBAAa,OAAO;wBAAO,SAAS;;;;;;;;;;;;0BAE5E,6LAAC,+JAAc;;;;;;;;;;;AAGrB;GA9EwB;KAAA"
      }
    },
    {
      "offset": {
        "line": 9861,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/hooks/student/useCurrentUser.ts"
        ],
        "sourcesContent": [
          "\"use client\";\r\n\r\nimport { useQuery } from \"@tanstack/react-query\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\n\r\ninterface UserProfile {\r\n    id: string;\r\n    email: string;\r\n    fullName: string;\r\n    role: string;\r\n    avatarUrl?: string | null;\r\n}\r\n\r\nexport function useCurrentUser() {\r\n    const supabase = createClient();\r\n\r\n    return useQuery({\r\n        queryKey: [\"current-user\"],\r\n        queryFn: async (): Promise<UserProfile | null> => {\r\n            const { data: { user } } = await supabase.auth.getUser();\r\n\r\n            if (!user) return null;\r\n\r\n            const { data: profile, error } = await supabase\r\n                .from(\"profiles\")\r\n                .select(\"id, email, full_name, role, avatar_url\")\r\n                .eq(\"id\", user.id)\r\n                .single();\r\n\r\n            if (error || !profile) {\r\n                // Production Standard: Do not fake the profile.\r\n                // If profile is missing, it likely means the DB Trigger hasn't finished yet.\r\n                // We throw an error to trigger the 'retry' mechanism below.\r\n                throw new Error(\"Profile not found in database yet.\");\r\n            }\r\n\r\n            return {\r\n                id: profile.id,\r\n                email: profile.email,\r\n                fullName: profile.full_name || \"Student\",\r\n                role: profile.role,\r\n                avatarUrl: profile.avatar_url,\r\n            };\r\n        },\r\n        // Production Policy: Retry 3 times with delay to wait for DB Trigger\r\n        retry: 3,\r\n        retryDelay: (attemptIndex) => Math.min(1000 * 2 ** attemptIndex, 3000), // 1s, 2s, 3s\r\n        staleTime: 1000 * 60 * 5, // 5 minutes\r\n    });\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;AAEA;AACA;;AAHA;;;AAaO,SAAS;;IACZ,MAAM,WAAW,IAAA,4IAAY;IAE7B,OAAO,IAAA,0LAAQ,EAAC;QACZ,UAAU;YAAC;SAAe;QAC1B,OAAO;uCAAE;gBACL,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;gBAEtD,IAAI,CAAC,MAAM,OAAO;gBAElB,MAAM,EAAE,MAAM,OAAO,EAAE,KAAK,EAAE,GAAG,MAAM,SAClC,IAAI,CAAC,YACL,MAAM,CAAC,0CACP,EAAE,CAAC,MAAM,KAAK,EAAE,EAChB,MAAM;gBAEX,IAAI,SAAS,CAAC,SAAS;oBACnB,gDAAgD;oBAChD,6EAA6E;oBAC7E,4DAA4D;oBAC5D,MAAM,IAAI,MAAM;gBACpB;gBAEA,OAAO;oBACH,IAAI,QAAQ,EAAE;oBACd,OAAO,QAAQ,KAAK;oBACpB,UAAU,QAAQ,SAAS,IAAI;oBAC/B,MAAM,QAAQ,IAAI;oBAClB,WAAW,QAAQ,UAAU;gBACjC;YACJ;;QACA,qEAAqE;QACrE,OAAO;QACP,UAAU;uCAAE,CAAC,eAAiB,KAAK,GAAG,CAAC,OAAO,KAAK,cAAc;;QACjE,WAAW,OAAO,KAAK;IAC3B;AACJ;GApCgB;;QAGL,0LAAQ"
      }
    },
    {
      "offset": {
        "line": 9918,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/components/StudentAppContainer.tsx"
        ],
        "sourcesContent": [
          "/**\r\n * HYBRID SPA PATTERN - Student App Container\r\n * \r\n * This component handles ALL student route navigation purely on the client.\r\n * - Uses React state for instant transitions (0ms)\r\n * - Updates URL with window.history.pushState (no server round-trip)\r\n * - Maintains browser history and shareable URLs\r\n * - Keeps layout mounted (no re-mounting)\r\n */\r\n\r\n'use client';\r\n\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport { usePathname } from 'next/navigation';\r\nimport dynamic from 'next/dynamic';\r\n\r\n// Dynamically import page components\r\nconst DashboardPage = dynamic(() => import('@/app/student/dashboard/page'), {\r\n    ssr: false,\r\n});\r\nconst ResultsPage = dynamic(() => import('@/app/student/results/page'), {\r\n    ssr: false,\r\n});\r\nconst AttemptPage = dynamic(() => import('@/app/student/results/attempt/[attemptId]/page'), {\r\n    ssr: false,\r\n});\r\nconst RewardsPage = dynamic(() => import('@/app/student/rewards/page'), {\r\n    ssr: false,\r\n});\r\nconst SettingsPage = dynamic(() => import('@/app/student/settings/page'), {\r\n    ssr: false,\r\n});\r\nconst MySeriesPage = dynamic(() => import('@/app/student/my-series/page'), {\r\n    ssr: false,\r\n});\r\nconst AllTestSeriesPage = dynamic(() => import('@/app/student/all-test-series/page'), {\r\n    ssr: false,\r\n});\r\nconst MyCoursesPage = dynamic(() => import('@/app/student/my-courses/page'), {\r\n    ssr: false,\r\n});\r\nconst AllCoursesPage = dynamic(() => import('@/app/student/all-courses/page'), {\r\n    ssr: false,\r\n});\r\n\r\ninterface StudentAppContainerProps {\r\n    initialRoute?: string;\r\n}\r\n\r\nexport function StudentAppContainer({ initialRoute }: StudentAppContainerProps) {\r\n    const pathname = usePathname();\r\n\r\n    // ‚ö° CLIENT-SIDE STATE: The source of truth for current route\r\n    const [currentRoute, setCurrentRoute] = useState<string>(\r\n        initialRoute || pathname || '/student/dashboard'\r\n    );\r\n\r\n    // ‚ö° INSTANT NAVIGATION: Update route without server round-trip\r\n    const navigateTo = useCallback((route: string) => {\r\n        // Update state (instant - 0ms)\r\n        setCurrentRoute(route);\r\n\r\n        // Update URL (no server request)\r\n        window.history.pushState({}, '', route);\r\n    }, []);\r\n\r\n    // Listen to browser back/forward buttons\r\n    useEffect(() => {\r\n        const handlePopState = () => {\r\n            const path = window.location.pathname;\r\n            setCurrentRoute(path);\r\n        };\r\n\r\n        window.addEventListener('popstate', handlePopState);\r\n        return () => window.removeEventListener('popstate', handlePopState);\r\n    }, []);\r\n\r\n    // Sync with pathname changes (for when Next.js router changes the URL)\r\n    useEffect(() => {\r\n        if (pathname && pathname !== currentRoute) {\r\n            setCurrentRoute(pathname);\r\n        }\r\n    }, [pathname]);\r\n\r\n    // Expose navigation function globally for SmartLink\r\n    useEffect(() => {\r\n        (window as any).__studentNavigate = navigateTo;\r\n    }, [navigateTo]);\r\n\r\n    // Render component based on current route\r\n    const renderPage = () => {\r\n        // Specific routes first\r\n        if (currentRoute.includes('/student/results/attempt/')) {\r\n            return <AttemptPage />;\r\n        }\r\n\r\n        if (currentRoute.startsWith('/student/results')) {\r\n            return <ResultsPage />;\r\n        }\r\n        if (currentRoute.startsWith('/student/rewards')) {\r\n            return <RewardsPage />;\r\n        }\r\n        if (currentRoute.startsWith('/student/settings')) {\r\n            return <SettingsPage />;\r\n        }\r\n        if (currentRoute.startsWith('/student/all-test-series')) {\r\n            return <AllTestSeriesPage />;\r\n        }\r\n        if (currentRoute.startsWith('/student/my-series')) {\r\n            return <MySeriesPage />;\r\n        }\r\n        if (currentRoute.startsWith('/student/my-courses')) {\r\n            return <MyCoursesPage />;\r\n        }\r\n        if (currentRoute.startsWith('/student/all-courses')) {\r\n            return <AllCoursesPage />;\r\n        }\r\n        // Default to dashboard\r\n        return <DashboardPage />;\r\n    };\r\n\r\n    return (\r\n        <div className=\"student-app-container\">\r\n            {renderPage()}\r\n        </div>\r\n    );\r\n}\r\n"
        ],
        "names": [],
        "mappings": "AAAA;;;;;;;;CAQC;;;;;AAID;AACA;AACA;;;;;;;;;;;;AAJA;;;;AAMA,qCAAqC;AACrC,MAAM,gBAAgB,IAAA,6KAAO,EAAC;;;;;;IAC1B,KAAK;;KADH;AAGN,MAAM,cAAc,IAAA,6KAAO,EAAC;;;;;;IACxB,KAAK;;MADH;AAGN,MAAM,cAAc,IAAA,6KAAO,EAAC;;;;;;IACxB,KAAK;;MADH;AAGN,MAAM,cAAc,IAAA,6KAAO,EAAC;;;;;;IACxB,KAAK;;MADH;AAGN,MAAM,eAAe,IAAA,6KAAO,EAAC;;;;;;IACzB,KAAK;;MADH;AAGN,MAAM,eAAe,IAAA,6KAAO,EAAC;;;;;;IACzB,KAAK;;MADH;AAGN,MAAM,oBAAoB,IAAA,6KAAO,EAAC;;;;;;IAC9B,KAAK;;MADH;AAGN,MAAM,gBAAgB,IAAA,6KAAO,EAAC;;;;;;IAC1B,KAAK;;MADH;AAGN,MAAM,iBAAiB,IAAA,6KAAO,EAAC;;;;;;IAC3B,KAAK;;MADH;AAQC,SAAS,oBAAoB,EAAE,YAAY,EAA4B;;IAC1E,MAAM,WAAW,IAAA,oJAAW;IAE5B,6DAA6D;IAC7D,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAC5C,gBAAgB,YAAY;IAGhC,+DAA+D;IAC/D,MAAM,aAAa,IAAA,4KAAW;uDAAC,CAAC;YAC5B,+BAA+B;YAC/B,gBAAgB;YAEhB,iCAAiC;YACjC,OAAO,OAAO,CAAC,SAAS,CAAC,CAAC,GAAG,IAAI;QACrC;sDAAG,EAAE;IAEL,yCAAyC;IACzC,IAAA,0KAAS;yCAAC;YACN,MAAM;gEAAiB;oBACnB,MAAM,OAAO,OAAO,QAAQ,CAAC,QAAQ;oBACrC,gBAAgB;gBACpB;;YAEA,OAAO,gBAAgB,CAAC,YAAY;YACpC;iDAAO,IAAM,OAAO,mBAAmB,CAAC,YAAY;;QACxD;wCAAG,EAAE;IAEL,uEAAuE;IACvE,IAAA,0KAAS;yCAAC;YACN,IAAI,YAAY,aAAa,cAAc;gBACvC,gBAAgB;YACpB;QACJ;wCAAG;QAAC;KAAS;IAEb,oDAAoD;IACpD,IAAA,0KAAS;yCAAC;YACL,OAAe,iBAAiB,GAAG;QACxC;wCAAG;QAAC;KAAW;IAEf,0CAA0C;IAC1C,MAAM,aAAa;QACf,wBAAwB;QACxB,IAAI,aAAa,QAAQ,CAAC,8BAA8B;YACpD,qBAAO,6LAAC;;;;;QACZ;QAEA,IAAI,aAAa,UAAU,CAAC,qBAAqB;YAC7C,qBAAO,6LAAC;;;;;QACZ;QACA,IAAI,aAAa,UAAU,CAAC,qBAAqB;YAC7C,qBAAO,6LAAC;;;;;QACZ;QACA,IAAI,aAAa,UAAU,CAAC,sBAAsB;YAC9C,qBAAO,6LAAC;;;;;QACZ;QACA,IAAI,aAAa,UAAU,CAAC,6BAA6B;YACrD,qBAAO,6LAAC;;;;;QACZ;QACA,IAAI,aAAa,UAAU,CAAC,uBAAuB;YAC/C,qBAAO,6LAAC;;;;;QACZ;QACA,IAAI,aAAa,UAAU,CAAC,wBAAwB;YAChD,qBAAO,6LAAC;;;;;QACZ;QACA,IAAI,aAAa,UAAU,CAAC,yBAAyB;YACjD,qBAAO,6LAAC;;;;;QACZ;QACA,uBAAuB;QACvB,qBAAO,6LAAC;;;;;IACZ;IAEA,qBACI,6LAAC;QAAI,WAAU;kBACV;;;;;;AAGb;GA7EgB;;QACK,oJAAW;;;MADhB"
      }
    },
    {
      "offset": {
        "line": 10177,
        "column": 0
      },
      "map": {
        "version": 3,
        "sources": [
          "file:///E:/PROJECT%202025%20-%20October/math4code-website/app/student/layout.tsx"
        ],
        "sourcesContent": [
          "\"use client\";\r\n\r\nimport React, { useEffect } from \"react\";\r\nimport { useRouter, usePathname } from \"next/navigation\";\r\nimport AdminClientLayout from \"../admin/AdminClientLayout\";\r\nimport { CommunityModalProvider } from \"@/context/CommunityModalContext\";\r\nimport { CommunityModal } from \"@/components/community/CommunityModal\";\r\nimport { useCurrentUser } from \"@/hooks/student/useCurrentUser\";\r\nimport { StudentAppContainer } from \"@/components/StudentAppContainer\";\r\n\r\nexport const runtime = 'edge';\r\n\r\nexport default function StudentLayout({ children }: { children: React.ReactNode }) {\r\n  const router = useRouter();\r\n  const pathname = usePathname();\r\n  const { data: profile, isLoading } = useCurrentUser();\r\n\r\n  useEffect(() => {\r\n    // Only redirect if we have definitively finished loading and there is no user,\r\n    // or if the user is not a student.\r\n    if (!isLoading) {\r\n      if (!profile) {\r\n        router.replace(\"/auth/login\");\r\n      } else if (profile.role !== \"student\") {\r\n        router.replace(\"/admin/dashboard\");\r\n      }\r\n    }\r\n  }, [profile, isLoading, router]);\r\n\r\n  const links = [\r\n    { icon: \"home\", label: \"Dashboard\", href: \"/student/dashboard\" },\r\n    { icon: \"bookopen\", label: \"My Courses\", href: \"/student/my-courses\" },\r\n    { icon: \"layers\", label: \"All Courses\", href: \"/student/all-courses\" },\r\n    { icon: \"trendingup\", label: \"My Series\", href: \"/student/my-series\" },\r\n    { icon: \"layers\", label: \"All Series\", href: \"/student/all-test-series\" },\r\n    { icon: \"messagesquare\", label: \"Community\", href: \"#\", onClick: \"openCommunity\" },\r\n    {\r\n      icon: \"award\",\r\n      label: \"Result\",\r\n      href: \"/student/results\",\r\n      prefetch: async () => {\r\n        // Prefetch results data on hover\r\n        const supabase = (await import('@/lib/supabase/client')).createClient();\r\n        const { data: { user } } = await supabase.auth.getUser();\r\n        if (!user) return null;\r\n\r\n        const { data } = await supabase\r\n          .from(\"results\")\r\n          .select(\"*, exam_attempts(exam_id, exams(title))\")\r\n          .eq(\"exam_attempts.student_id\", user.id)\r\n          .order(\"created_at\", { ascending: false });\r\n\r\n        return data;\r\n      }\r\n    },\r\n    { icon: \"gift\", label: \"Rewards\", href: \"/student/rewards\" },\r\n    { icon: \"settings\", label: \"Settings\", href: \"/student/settings\" },\r\n  ];\r\n\r\n  // If loading and NO data (initial fetch), show loading.\r\n  // If we have cached data, we skip this and render immediately.\r\n  if (isLoading && !profile) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-screen text-gray-600\">\r\n        {/* Optional: Add a spinner here if desired, but text is fine */}\r\n        Checking access...\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // If not loading but no profile (will redirect in effect), allow render or return null to prevent flash\r\n  if (!profile) return null;\r\n\r\n  // Adapt the profile object for AdminClientLayout if necessary\r\n  const layoutProfile = {\r\n    id: profile.id,\r\n    full_name: profile.fullName,\r\n    email: profile.email,\r\n    role: profile.role,\r\n    avatar_url: profile.avatarUrl || null,\r\n  };\r\n\r\n  // Check if we're on a payment route - if so, render children directly\r\n  const isPaymentRoute = pathname?.startsWith('/student/payment');\r\n\r\n  return (\r\n    <CommunityModalProvider>\r\n      {isPaymentRoute ? (\r\n        // For payment routes, render children directly without the SPA container\r\n        <>{children}</>\r\n      ) : (\r\n        // For other routes, use the SPA container\r\n        <AdminClientLayout profile={layoutProfile} links={links}>\r\n          <StudentAppContainer initialRoute={pathname} />\r\n        </AdminClientLayout>\r\n      )}\r\n      <CommunityModal />\r\n    </CommunityModalProvider>\r\n  );\r\n}\r\n"
        ],
        "names": [],
        "mappings": ";;;;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AARA;;;;;;;;AAUO,MAAM,UAAU;AAER,SAAS,cAAc,EAAE,QAAQ,EAAiC;;IAC/E,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,WAAW,IAAA,oJAAW;IAC5B,MAAM,EAAE,MAAM,OAAO,EAAE,SAAS,EAAE,GAAG,IAAA,uJAAc;IAEnD,IAAA,0KAAS;mCAAC;YACR,+EAA+E;YAC/E,mCAAmC;YACnC,IAAI,CAAC,WAAW;gBACd,IAAI,CAAC,SAAS;oBACZ,OAAO,OAAO,CAAC;gBACjB,OAAO,IAAI,QAAQ,IAAI,KAAK,WAAW;oBACrC,OAAO,OAAO,CAAC;gBACjB;YACF;QACF;kCAAG;QAAC;QAAS;QAAW;KAAO;IAE/B,MAAM,QAAQ;QACZ;YAAE,MAAM;YAAQ,OAAO;YAAa,MAAM;QAAqB;QAC/D;YAAE,MAAM;YAAY,OAAO;YAAc,MAAM;QAAsB;QACrE;YAAE,MAAM;YAAU,OAAO;YAAe,MAAM;QAAuB;QACrE;YAAE,MAAM;YAAc,OAAO;YAAa,MAAM;QAAqB;QACrE;YAAE,MAAM;YAAU,OAAO;YAAc,MAAM;QAA2B;QACxE;YAAE,MAAM;YAAiB,OAAO;YAAa,MAAM;YAAK,SAAS;QAAgB;QACjF;YACE,MAAM;YACN,OAAO;YACP,MAAM;YACN,UAAU;gBACR,iCAAiC;gBACjC,MAAM,WAAW,CAAC,yGAAqC,EAAE,YAAY;gBACrE,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;gBACtD,IAAI,CAAC,MAAM,OAAO;gBAElB,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,SACpB,IAAI,CAAC,WACL,MAAM,CAAC,2CACP,EAAE,CAAC,4BAA4B,KAAK,EAAE,EACtC,KAAK,CAAC,cAAc;oBAAE,WAAW;gBAAM;gBAE1C,OAAO;YACT;QACF;QACA;YAAE,MAAM;YAAQ,OAAO;YAAW,MAAM;QAAmB;QAC3D;YAAE,MAAM;YAAY,OAAO;YAAY,MAAM;QAAoB;KAClE;IAED,wDAAwD;IACxD,+DAA+D;IAC/D,IAAI,aAAa,CAAC,SAAS;QACzB,qBACE,6LAAC;YAAI,WAAU;sBACoD;;;;;;IAIvE;IAEA,wGAAwG;IACxG,IAAI,CAAC,SAAS,OAAO;IAErB,8DAA8D;IAC9D,MAAM,gBAAgB;QACpB,IAAI,QAAQ,EAAE;QACd,WAAW,QAAQ,QAAQ;QAC3B,OAAO,QAAQ,KAAK;QACpB,MAAM,QAAQ,IAAI;QAClB,YAAY,QAAQ,SAAS,IAAI;IACnC;IAEA,sEAAsE;IACtE,MAAM,iBAAiB,UAAU,WAAW;IAE5C,qBACE,6LAAC,8JAAsB;;YACpB,iBACC,yEAAyE;0BACzE;0BAAG;gCAEH,0CAA0C;0BAC1C,6LAAC,gJAAiB;gBAAC,SAAS;gBAAe,OAAO;0BAChD,cAAA,6LAAC,4JAAmB;oBAAC,cAAc;;;;;;;;;;;0BAGvC,6LAAC,+JAAc;;;;;;;;;;;AAGrB;GAvFwB;;QACP,kJAAS;QACP,oJAAW;QACS,uJAAc;;;KAH7B"
      }
    }
  ]
}